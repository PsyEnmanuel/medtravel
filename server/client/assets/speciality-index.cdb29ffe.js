import{l as q,m as A,r as P,n as j,a3 as T,$ as M,t as r,G as f,y as i,H as v,v as k,F as d,E as $,z as l,x as n,Q as D,B as y,aS as Q,U as E,V as F,K as I,R as G,aW as H,D as U,az as J,q as K,k as O,w as X,A as R,J as Y,aC as B,C as Z,I as ee,M as W,L}from"./index.49e59f77.js";const te={class:"flex justify-between items-start gap-2 py-2"},se={key:0,class:"mb-2"},le=i("p",{class:"text-2xl text-info"},"Editar Especialidad",-1),ae={class:"font-bold text-brand"},ie=i("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),oe={key:1},ne=i("p",{class:"text-2xl text-info"},[U("Agregar "),i("b",{class:"font-bold text-brand"},"Diagn\xF3sis")],-1),de=i("p",null,"Los campos requeridos tienen un (*)",-1),re=[ne,de],ue=i("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),ce=i("div",{class:"bg-default p-1 mb-2 rounded-md text-center font-bold"},"Listado de sub especialidades",-1),pe={class:"flex flex-nowrap justify-between items-center gap-2 card p-1 mb-2"},N={__name:"SpecialityWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(x){const w=q("$api");q("$cats");const p=q("$local"),t=A(),h=P(),b=x,C=()=>({sub:[]}),s=j({item:C(),local:"WriteSpeciality",sub_speciality:null,roles:[]}),_=T(()=>({width:b.width,padding:b.isDrawer&&"6px 8px"}));async function S(){b.isEdit?s.item=await w.get(`speciality/${b.id}`):p.get(s.local)}function o(){s.item=C(),p.remove(s.local),h.value.resetValidation()}function a(){if(console.log(11,s.sub_speciality),!s.sub_speciality){t.notify({type:"warning",message:"Campo especialidad no puede estar vacio"});return}if(s.item.sub.findIndex(u=>u.description===s.sub_speciality)===-1){s.item.sub.push({description:s.sub_speciality}),s.sub_speciality=null;return}t.notify({type:"warning",message:"Especialidad ya esta agregado"})}function e(c){const u=s.item.sub.findIndex(V=>V.description===c.description);u!==-1&&s.item.sub.splice(u,1)}async function m(){if(s.item.insurance_id){const c=s.insurances.findIndex(u=>u.id===s.item.insurance_id);s.item.insurance=s.insurances[c].description}b.isEdit?await w.put(`speciality/${b.id}`,{...s.item})&&t.notify({type:"success",message:"Especialidad Editado"}):await w.post("speciality",{...s.item})&&(t.notify({type:"success",message:"Especialidad Agregado"}),o())}return M(()=>{S()}),(c,u)=>{var V;return r(),f("div",{style:I(_.value)},[i("div",te,[x.isEdit?(r(),f("div",se,[le,i("b",ae,v(s.item.description),1),ie])):(r(),f("div",oe,re)),x.isDrawer?(r(),k(d,{key:2,flat:"",class:"button",label:"cerrar",onClick:u[0]||(u[0]=g=>c.$emit("close"))})):$("",!0)]),ue,l(H,{class:G((V=x.isDrawer)!=null?V:"pb-64"),ref_key:"writeForm",ref:h,onSubmit:m,onReset:o},{default:n(()=>[l(D,{class:"my-2",dense:"",outlined:"",modelValue:s.item.description,"onUpdate:modelValue":u[1]||(u[1]=g=>s.item.description=g),label:c.$t("speciality")+"*",rules:[y(Q)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),l(D,{class:"mb-2",dense:"",outlined:"",modelValue:s.sub_speciality,"onUpdate:modelValue":u[2]||(u[2]=g=>s.sub_speciality=g),label:"Agregar sub especialidad"},{append:n(()=>[l(d,{type:"button",class:"button w-full bg-default text-font",size:"sm",flat:"",label:"agregar",onClick:a})]),_:1},8,["modelValue"]),ce,(r(!0),f(E,null,F(s.item.sub,g=>(r(),f("div",{key:g},[i("div",pe,[l(D,{class:"w-full border-none",dense:"",outlined:"",modelValue:g.description,"onUpdate:modelValue":z=>g.description=z,label:c.$t("sub_speciality"),rules:[y(Q)],"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","label","rules"]),l(d,{class:"button-icon bg-primary text-white rounded-full mx-2",size:"xs",flat:"",icon:"fa-solid fa-xmark",onClick:z=>e(g)},null,8,["onClick"])])]))),128)),x.isDrawer?(r(),f("div",{key:0,class:"fixed bottom-0 right-[10px] py-2 bg-white",style:I(_.value)},[b.isEdit?(r(),k(d,{key:0,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"Guardar cambios",type:"submit"})):(r(),k(d,{key:1,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"agregar",type:"submit"}))],4)):$("",!0)]),_:1},8,["class"])],4)}}},me={class:"flex justify-between md:flex-nowrap"},fe={class:"flex flex-nowrap w-full gap-2 mb-1"},be={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},ge={class:"full-width row flex-center text-primary q-gutter-sm"},ye={class:"flex gap-2"},we={class:"list-inside"},ve={bordered:"",flat:"",class:"card pb-2 relative flex flex-nowrap"},xe={class:"absolute right-3 top-2"},_e={class:"pl-3 pr-8 w-full pt-2 flex flex-col overflow-hidden"},ke={class:"text-uppercase line-clamp-1 font-semibold"},$e={class:"flex justify-end gap-2 -mr-5 mt-1"},Ce={__name:"speciality-index",setup(x){const{t:w}=J(),p=P(),t=j({dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:description",pagination:{sortBy:"description",descending:!1,page:1,rowsPerPage:20},url:"speciality",query:{groupBy:["t_speciality.id"],where:{c_status:4}},columns:[{name:"action",required:!0,label:"",align:"left",field:w("id"),classes:"w-[100px]"},{name:"description",required:!0,label:w("name"),align:"left",field:"description",sortable:!0},{name:"sub",required:!0,label:w("sub_specialities"),align:"left",field:"sub",sortable:!0}],rows:[]}),{onRequest:h,getSelectedString:b,onDeleteRows:C,addMore:s,itemsRange:_}=K(t,p),S=O();return X(()=>S.table.t_speciality,o=>{p.value.requestServerInteraction(),p.value.clearSelection()},{deep:!0}),(o,a)=>(r(),f(E,null,[i("div",me,[i("div",fe,[l(D,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:t.search,"onUpdate:modelValue":a[0]||(a[0]=e=>t.search=e),placeholder:o.$t("search")},{append:n(()=>[l(R,{name:"search"})]),_:1},8,["modelValue","placeholder"]),o.$me.unixroles&1?(r(),k(d,{key:0,flat:"",class:"button h-full",icon:"add",label:o.$isDesktop&&o.$t("add"),onClick:a[1]||(a[1]=e=>t.dialogCreate=!0)},null,8,["label"])):$("",!0),t.selected.length&&o.$me.unixroles&1?(r(),k(d,{key:1,flat:"",class:"button h-full bg-primary text-white","icon-right":"sym_o_remove",label:o.$isDesktop?"Remover":"","no-caps":"",onClick:y(C)},null,8,["label","onClick"])):$("",!0)]),o.$isDesktop?(r(),f("div",be,[l(d,{class:"bg-transparent",flat:"","no-caps":""},{default:n(()=>[U(v(y(_).start)+" - "+v(y(_).end)+" de "+v(t.pagination.rowsNumber),1)]),_:1}),l(d,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:a[2]||(a[2]=e=>p.value.firstPage())}),l(d,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:a[3]||(a[3]=e=>p.value.prevPage())}),l(d,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:a[4]||(a[4]=e=>p.value.nextPage())}),l(d,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:a[5]||(a[5]=e=>p.value.lastPage())})])):$("",!0)]),l(ee,{grid:!o.$isDesktop,"visible-columns":t.visibleColumns,"hide-pagination":"",rows:t.rows,columns:t.columns,"row-key":"id",ref_key:"tableRef",ref:p,onRequest:y(h),flat:"",selection:"multiple",pagination:t.pagination,"onUpdate:pagination":a[6]||(a[6]=e=>t.pagination=e),selected:t.selected,"onUpdate:selected":a[7]||(a[7]=e=>t.selected=e),"selected-rows-label":y(b),loading:t.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},Y({"no-data":n(({icon:e,message:m,filter:c})=>[i("div",ge,[i("span",null,v(m),1),l(R,{size:"2em",name:c?"filter_b_and_w":e},null,8,["name"])])]),"body-cell-action":n(e=>[l(B,{props:e},{default:n(()=>[i("div",ye,[l(d,{flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:m=>{t.selectedId=e.row.id,t.dialogWrite=!0}},null,8,["onClick"])])]),_:2},1032,["props"])]),"body-cell-sub":n(e=>[l(B,{props:e},{default:n(()=>[i("ul",we,[(r(!0),f(E,null,F(e.row.sub,m=>(r(),f("li",{key:m},v(m.description),1))),128))])]),_:2},1032,["props"])]),item:n(e=>[i("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:I(e.selected?"transform: scale(0.95);":"")},[i("div",ve,[i("div",xe,[l(Z,{dense:"",modelValue:e.selected,"onUpdate:modelValue":m=>e.selected=m,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),i("div",_e,[i("span",ke,v(e.row.description),1),i("div",$e,[l(d,{flat:"",class:"button-press bg-primary text-white rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:m=>{t.selectedId=e.row.id,t.dialogWrite=!0}},null,8,["onClick"])])])])],4)]),_:2},[o.$isDesktop?void 0:{name:"bottom",fn:n(()=>[l(d,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:y(s)},{default:n(()=>[U("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","visible-columns","rows","columns","onRequest","pagination","selected","selected-rows-label","loading"]),l(L,{class:"q-pa-none",modelValue:t.dialogWrite,"onUpdate:modelValue":a[9]||(a[9]=e=>t.dialogWrite=e),position:o.$isDesktop?"right":"standard","full-height":"","full-width":o.$isDesktop,maximized:"","transition-duration":100},{default:n(()=>[l(W,null,{default:n(()=>[l(N,{onClose:a[8]||(a[8]=e=>t.dialogWrite=!1),isDrawer:"",id:t.selectedId,isEdit:"",width:o.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),l(L,{modelValue:t.dialogCreate,"onUpdate:modelValue":a[11]||(a[11]=e=>t.dialogCreate=e),position:o.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:n(()=>[l(W,null,{default:n(()=>[l(N,{onClose:a[10]||(a[10]=e=>t.dialogCreate=!1),isDrawer:"",width:o.$isDesktop?"400px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"])],64))}};export{Ce as default};
