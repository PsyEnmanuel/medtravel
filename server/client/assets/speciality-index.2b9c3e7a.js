import{l as S,m as T,r as P,n as j,a3 as M,w as F,$ as G,t as r,G as b,y as a,H as v,v as k,F as d,E as $,z as l,x as n,Q as D,B as y,aS as Q,U as q,V as A,K as I,R as H,aW as J,D as U,az as K,q as O,k as X,A as R,J as Y,aC as B,C as Z,I as ee,M as W,L}from"./index.e9245a9e.js";const te={class:"flex justify-between items-start gap-2 py-2"},se={key:0,class:"mb-2"},le=a("p",{class:"text-2xl text-info"},"Editar Especialidad",-1),ie={class:"font-bold text-brand"},ae=a("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),oe={key:1},ne=a("p",{class:"text-2xl text-info"},[U("Agregar "),a("b",{class:"font-bold text-brand"},"Diagn\xF3sis")],-1),de=a("p",null,"Los campos requeridos tienen un (*)",-1),re=[ne,de],ue=a("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),ce=a("div",{class:"bg-default p-1 mb-2 rounded-md text-center font-bold"},"Listado de sub especialidades",-1),pe={class:"flex flex-nowrap justify-between items-center gap-2 card p-1 mb-2"},N={__name:"SpecialityWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(x){const w=S("$api");S("$cats");const p=S("$local"),t=T(),h=P(),m=x,C=()=>({sub:[]}),s=j({item:C(),local:"WriteSpeciality",sub_speciality:null,roles:[]}),_=M(()=>({width:m.width,padding:m.isDrawer&&"6px 8px"}));F(()=>s.item,u=>{m.isEdit||p.set(s.local,u)},{deep:!0});async function E(){m.isEdit?s.item=await w.get(`speciality/${m.id}`):p.get(s.local)}function o(){s.item=C(),p.remove(s.local),h.value.resetValidation()}function i(){if(console.log(11,s.sub_speciality),!s.sub_speciality){t.notify({type:"warning",message:"Campo especialidad no puede estar vacio"});return}if(s.item.sub.findIndex(c=>c.description===s.sub_speciality)===-1){s.item.sub.push({description:s.sub_speciality}),s.sub_speciality=null;return}t.notify({type:"warning",message:"Especialidad ya esta agregado"})}function e(u){const c=s.item.sub.findIndex(V=>V.description===u.description);c!==-1&&s.item.sub.splice(c,1)}async function f(){if(s.item.insurance_id){const u=s.insurances.findIndex(c=>c.id===s.item.insurance_id);s.item.insurance=s.insurances[u].description}m.isEdit?await w.put(`speciality/${m.id}`,{...s.item})&&t.notify({type:"success",message:"Especialidad Editado"}):await w.post("speciality",{...s.item})&&(t.notify({type:"success",message:"Especialidad Agregado"}),o())}return G(()=>{E()}),(u,c)=>{var V;return r(),b("div",{style:I(_.value)},[a("div",te,[x.isEdit?(r(),b("div",se,[le,a("b",ie,v(s.item.description),1),ae])):(r(),b("div",oe,re)),x.isDrawer?(r(),k(d,{key:2,flat:"",class:"button",label:"cerrar",onClick:c[0]||(c[0]=g=>u.$emit("close"))})):$("",!0)]),ue,l(J,{class:H((V=x.isDrawer)!=null?V:"pb-64"),ref_key:"writeForm",ref:h,onSubmit:f,onReset:o},{default:n(()=>[l(D,{class:"my-2",dense:"",outlined:"",modelValue:s.item.description,"onUpdate:modelValue":c[1]||(c[1]=g=>s.item.description=g),label:u.$t("speciality")+"*",rules:[y(Q)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),l(D,{class:"mb-2",dense:"",outlined:"",modelValue:s.sub_speciality,"onUpdate:modelValue":c[2]||(c[2]=g=>s.sub_speciality=g),label:"Agregar sub especialidad"},{append:n(()=>[l(d,{type:"button",class:"button w-full bg-default text-font",size:"sm",flat:"",label:"agregar",onClick:i})]),_:1},8,["modelValue"]),ce,(r(!0),b(q,null,A(s.item.sub,g=>(r(),b("div",{key:g},[a("div",pe,[l(D,{class:"w-full border-none",dense:"",outlined:"",modelValue:g.description,"onUpdate:modelValue":z=>g.description=z,label:u.$t("sub_speciality"),rules:[y(Q)],"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","label","rules"]),l(d,{class:"button-icon bg-primary text-white rounded-full mx-2",size:"xs",flat:"",icon:"fa-solid fa-xmark",onClick:z=>e(g)},null,8,["onClick"])])]))),128)),x.isDrawer?(r(),b("div",{key:0,class:"fixed bottom-0 right-[10px] py-2 bg-white",style:I(_.value)},[m.isEdit?(r(),k(d,{key:0,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"Guardar cambios",type:"submit"})):(r(),k(d,{key:1,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"agregar",type:"submit"}))],4)):$("",!0)]),_:1},8,["class"])],4)}}},me={class:"flex justify-between md:flex-nowrap"},fe={class:"flex flex-nowrap w-full gap-2 mb-1"},be={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},ge={class:"full-width row flex-center text-primary q-gutter-sm"},ye={class:"flex gap-2"},we={class:"list-inside"},ve={bordered:"",flat:"",class:"card pb-2 relative flex flex-nowrap"},xe={class:"absolute right-3 top-2"},_e={class:"pl-3 pr-8 w-full pt-2 flex flex-col overflow-hidden"},ke={class:"text-uppercase line-clamp-1 font-semibold"},$e={class:"flex justify-end gap-2 -mr-5 mt-1"},Ce={__name:"speciality-index",setup(x){const{t:w}=K(),p=P(),t=j({dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:description",pagination:{sortBy:"description",descending:!1,page:1,rowsPerPage:20},url:"speciality",query:{groupBy:["t_speciality.id"],where:{c_status:4}},columns:[{name:"action",required:!0,label:"",align:"left",field:w("id"),classes:"w-[100px]"},{name:"description",required:!0,label:w("name"),align:"left",field:"description",sortable:!0},{name:"sub",required:!0,label:w("sub_specialities"),align:"left",field:"sub",sortable:!0}],rows:[]}),{onRequest:h,getSelectedString:m,onDeleteRows:C,addMore:s,itemsRange:_}=O(t,p),E=X();return F(()=>E.table.t_speciality,o=>{p.value.requestServerInteraction(),p.value.clearSelection()},{deep:!0}),(o,i)=>(r(),b(q,null,[a("div",me,[a("div",fe,[l(D,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:t.search,"onUpdate:modelValue":i[0]||(i[0]=e=>t.search=e),placeholder:o.$t("search")},{append:n(()=>[l(R,{name:"search"})]),_:1},8,["modelValue","placeholder"]),o.$me.unixroles&1?(r(),k(d,{key:0,flat:"",class:"button h-full",icon:"add",label:o.$isDesktop&&o.$t("add"),onClick:i[1]||(i[1]=e=>t.dialogCreate=!0)},null,8,["label"])):$("",!0),t.selected.length&&o.$me.unixroles&1?(r(),k(d,{key:1,flat:"",class:"button h-full bg-primary text-white","icon-right":"sym_o_remove",label:o.$isDesktop?"Remover":"","no-caps":"",onClick:y(C)},null,8,["label","onClick"])):$("",!0)]),o.$isDesktop?(r(),b("div",be,[l(d,{class:"bg-transparent",flat:"","no-caps":""},{default:n(()=>[U(v(y(_).start)+" - "+v(y(_).end)+" de "+v(t.pagination.rowsNumber),1)]),_:1}),l(d,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:i[2]||(i[2]=e=>p.value.firstPage())}),l(d,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:i[3]||(i[3]=e=>p.value.prevPage())}),l(d,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:i[4]||(i[4]=e=>p.value.nextPage())}),l(d,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:i[5]||(i[5]=e=>p.value.lastPage())})])):$("",!0)]),l(ee,{grid:!o.$isDesktop,"visible-columns":t.visibleColumns,"hide-pagination":"",rows:t.rows,columns:t.columns,"row-key":"id",ref_key:"tableRef",ref:p,onRequest:y(h),flat:"",selection:"multiple",pagination:t.pagination,"onUpdate:pagination":i[6]||(i[6]=e=>t.pagination=e),selected:t.selected,"onUpdate:selected":i[7]||(i[7]=e=>t.selected=e),"selected-rows-label":y(m),loading:t.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},Y({"no-data":n(({icon:e,message:f,filter:u})=>[a("div",ge,[a("span",null,v(f),1),l(R,{size:"2em",name:u?"filter_b_and_w":e},null,8,["name"])])]),"body-cell-action":n(e=>[l(B,{props:e},{default:n(()=>[a("div",ye,[l(d,{flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:f=>{t.selectedId=e.row.id,t.dialogWrite=!0}},null,8,["onClick"])])]),_:2},1032,["props"])]),"body-cell-sub":n(e=>[l(B,{props:e},{default:n(()=>[a("ul",we,[(r(!0),b(q,null,A(e.row.sub,f=>(r(),b("li",{key:f},v(f.description),1))),128))])]),_:2},1032,["props"])]),item:n(e=>[a("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:I(e.selected?"transform: scale(0.95);":"")},[a("div",ve,[a("div",xe,[l(Z,{dense:"",modelValue:e.selected,"onUpdate:modelValue":f=>e.selected=f,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),a("div",_e,[a("span",ke,v(e.row.description),1),a("div",$e,[l(d,{flat:"",class:"button-press bg-primary text-white rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:f=>{t.selectedId=e.row.id,t.dialogWrite=!0}},null,8,["onClick"])])])])],4)]),_:2},[o.$isDesktop?void 0:{name:"bottom",fn:n(()=>[l(d,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:y(s)},{default:n(()=>[U("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","visible-columns","rows","columns","onRequest","pagination","selected","selected-rows-label","loading"]),l(L,{class:"q-pa-none",modelValue:t.dialogWrite,"onUpdate:modelValue":i[9]||(i[9]=e=>t.dialogWrite=e),position:o.$isDesktop?"right":"standard","full-height":"","full-width":o.$isDesktop,maximized:"","transition-duration":100},{default:n(()=>[l(W,null,{default:n(()=>[l(N,{onClose:i[8]||(i[8]=e=>t.dialogWrite=!1),isDrawer:"",id:t.selectedId,isEdit:"",width:o.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),l(L,{modelValue:t.dialogCreate,"onUpdate:modelValue":i[11]||(i[11]=e=>t.dialogCreate=e),position:o.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:n(()=>[l(W,null,{default:n(()=>[l(N,{onClose:i[10]||(i[10]=e=>t.dialogCreate=!1),isDrawer:"",width:o.$isDesktop?"400px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"])],64))}};export{Ce as default};
