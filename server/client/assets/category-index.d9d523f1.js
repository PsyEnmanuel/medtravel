import{l as U,m as P,r as B,n as A,a3 as T,$ as G,t as c,G as _,y as o,H as k,v as w,F as m,E as $,z as s,x as r,Q as h,B as y,aS as Q,C as M,K as S,R as K,aW as O,D as q,k as H,w as E,bA as W,A as z,U as J,V as X,br as Y,bs as N,bB as Z,bC as ee,q as te,J as se,aC as j,T as le,I as ae,M as R,L}from"./index.73cc0385.js";const oe={class:"flex justify-between items-start gap-2 py-2"},ie={key:0,class:"mb-2"},ne=o("p",{class:"text-2xl text-info"},"Editar Categor\xEDa",-1),re={class:"font-bold text-brand"},de=o("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),ue={key:1},ce=o("p",{class:"text-2xl text-info"},[q("Agregar "),o("b",{class:"font-bold text-brand"},"Categor\xEDa")],-1),me=o("p",null,"Los campos requeridos tienen un (*)",-1),pe=[ce,me],fe=o("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),F={__name:"CategoryWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(x){const g=U("$api"),p=U("$local"),l=P(),C=B(),f=x,V=()=>({filterable:0,root:0}),t=A({item:V(),local:"CategoryWrite",categories:[]});function v(){t.item=V(),p.remove(t.local),C.value.resetValidation()}async function D(){if(t.item.parent_id){const[e]=t.categories.filter(u=>u.id===t.item.parent_id);t.item.parent_description=e.description}f.isEdit?await g.put(`Category/${f.id}`,{...t.item})&&l.notify({type:"success",message:"Categor\xEDa Editada"}):await g.post("category",{...t.item})&&(l.notify({type:"success",message:"Categor\xEDa Agregada"}),v())}async function i(){f.isEdit?t.item=await g.get(`category/${f.id}`):p.get(t.local);let{items:e}=await g.get("category",{params:{where:{level:0,c_status:[4]}}});t.categories=e}const a=T(()=>({width:f.width,"padding-right":f.isDrawer&&"8px","padding-left":f.isDrawer&&"8px"}));return G(()=>{i()}),(e,u)=>{var n;return c(),_("div",{style:S(a.value),class:"pb-32"},[o("div",oe,[x.isEdit?(c(),_("div",ie,[ne,o("b",re,k(t.item.description),1),de])):(c(),_("div",ue,pe)),x.isDrawer?(c(),w(m,{key:2,flat:"",class:"button",label:"cerrar",onClick:u[0]||(u[0]=d=>e.$emit("close"))})):$("",!0)]),fe,s(O,{class:K((n=x.isDrawer)!=null?n:"pb-64"),ref_key:"writeForm",ref:C,onSubmit:D,onReset:v},{default:r(()=>[s(h,{class:"mb-2",dense:"",outlined:"",modelValue:t.item.description,"onUpdate:modelValue":u[1]||(u[1]=d=>t.item.description=d),label:e.$t("description"),rules:[y(Q)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),e.$me.unixroles&1?(c(),w(h,{key:0,class:"mb-2",dense:"",outlined:"",modelValue:t.item.ref,"onUpdate:modelValue":u[2]||(u[2]=d=>t.item.ref=d),label:e.$t("reference"),rules:[y(Q)],"hide-bottom-space":""},null,8,["modelValue","label","rules"])):$("",!0),e.$me.unixroles&1?(c(),w(h,{key:1,dense:"",outlined:"",modelValue:t.item.color,"onUpdate:modelValue":u[3]||(u[3]=d=>t.item.color=d),label:e.$t("color"),"hide-bottom-space":""},null,8,["modelValue","label"])):$("",!0),e.$me.unixroles&1?(c(),w(M,{key:2,size:"xs",modelValue:t.item.root,"onUpdate:modelValue":u[4]||(u[4]=d=>t.item.root=d),label:"Root","true-value":1,"false-value":0},null,8,["modelValue"])):$("",!0),o("div",{class:"fixed bottom-0 right-0 py-2 bg-white",style:S(a.value)},[f.isEdit?(c(),w(m,{key:0,class:"button-press w-full text-lg rounded-md bg-btn-drawer-green",flat:"",label:"Guardar cambios",type:"submit"})):(c(),w(m,{key:1,class:"button-press w-full text-lg rounded-md bg-btn-drawer-sky",flat:"",label:"agregar",type:"submit"}))],4)]),_:1},8,["class"])],4)}}},ge={class:"flex justify-between items-start gap-2 py-2"},be={class:"mb-2"},ye=o("p",{class:"text-2xl text-info"},"Listado Categor\xEDa",-1),we={class:"font-bold text-brand"},$e=o("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),ve={class:"mt-2"},ke={class:"flex justify-end"},xe={__name:"CategoryList",props:{id:Number,width:String,isDrawer:Boolean},setup(x){const g=P(),p=U("$api"),l=H(),C=B(),f=x,V=()=>({description:null,parent_id:f.id}),t=A({category:{},items:[],staticItems:[],item:V(),total:0,selected:{},search:"",query:{order:{description:"ASC"},where:{c_status:4,parent_id:f.id}}});E(()=>l.t_category,()=>{v()}),E(()=>t.search,n=>{if(!n){t.items=W(t.staticItems);return}t.items=t.staticItems.filter(d=>d.description.includes(n))});async function v(){try{t.category=await p.get(`category/${f.id}`);const n=await p.get("category",{params:{...t.query}});t.staticItems=W(n.items),t.items=n.items,t.total=n.total}catch(n){console.log(n)}}function D(){t.item=V(),C.value.resetValidation()}async function i(){try{await p.post("category",t.item)&&g.notify({type:"success",message:"Categor\xEDa Agregada"}),v(),D()}catch(n){console.log(n)}}async function a(n){try{const d=await p.delete(`category/${n.id}`,n);v(),d&&g.notify({type:"success",message:"Categor\xEDa removida"})}catch(d){console.log(d)}}async function e(n){try{await p.put(`category/${n.id}`,n)&&g.notify({type:"success",message:"Categor\xEDa editada"})}catch(d){console.log(d)}}const u=T(()=>({width:f.width,"padding-right":f.isDrawer&&"8px","padding-left":f.isDrawer&&"8px"}));return G(()=>{v()}),(n,d)=>(c(),_("div",{style:S(u.value),class:"pb-32"},[o("div",ge,[o("div",be,[ye,o("b",we,k(t.category.description),1),$e]),x.isDrawer?(c(),w(m,{key:0,flat:"",class:"button",label:"cerrar",onClick:d[0]||(d[0]=b=>n.$emit("close"))})):$("",!0)]),s(O,{ref_key:"writeForm",ref:C,onSubmit:i,onReset:D},{default:r(()=>[o("div",ve,[s(h,{class:"mb-2",dense:"",outlined:"",modelValue:t.item.description,"onUpdate:modelValue":d[1]||(d[1]=b=>t.item.description=b),label:n.$t("description"),"hide-bottom-space":"",rules:[y(Q)]},null,8,["modelValue","label","rules"]),s(m,{flat:"",class:"button-press w-full bg-default text-primary text-sm font-bold tracking-normal mb-2",type:"submit"},{default:r(()=>[q(" CREAR CATEGOR\xCDA ")]),_:1})])]),_:1},512),s(h,{class:"mb-2",dense:"",outlined:"",modelValue:t.search,"onUpdate:modelValue":d[2]||(d[2]=b=>t.search=b),label:n.$t("search"),"hide-bottom-space":""},{append:r(()=>[s(z,{name:"search"})]),_:1},8,["modelValue","label"]),(c(!0),_(J,null,X(t.items,b=>(c(),_("div",{key:b.id},[(c(),w(ee,{key:b.id,class:"mb-2",separator:""},{default:r(()=>[s(Y,{class:"p-0",dense:"",center:""},{default:r(()=>[s(N,{class:"relative"},{default:r(()=>[s(h,{dense:"",outlined:"",modelValue:b.description,"onUpdate:modelValue":I=>b.description=I,label:n.$t("description"),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","label"]),t.category.color?(c(),w(h,{key:0,dense:"",outlined:"",modelValue:b.color,"onUpdate:modelValue":I=>b.color=I,label:n.$t("color"),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","label"])):$("",!0),s(Z,{class:"absolute top-1 right-2",caption:""},{default:r(()=>[q(k(b.id),1)]),_:2},1024)]),_:2},1024),s(N,{side:""},{default:r(()=>[o("div",ke,[s(m,{class:"bg-default text-primary mr-2","text-color":"font",size:"12px",flat:"",round:"",icon:"sym_o_edit_note",onClick:I=>e(b)},null,8,["onClick"]),s(m,{class:"bg-default text-primary","text-color":"font",size:"12px",flat:"",round:"",icon:"sym_o_remove",onClick:I=>a(b)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))]))),128))],4))}},he={class:"flex justify-between md:flex-nowrap"},_e={class:"flex flex-nowrap w-full gap-2 mb-1"},Ce={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},Ve={class:"full-width row flex-center text-primary q-gutter-sm"},De=["src"],Ie={class:"flex gap-2"},qe={bordered:"",flat:"",class:"card pb-2 relative flex flex-nowrap"},Ue={class:"absolute right-3 top-2"},Se={class:"pl-3 pr-8 w-full pt-2 flex flex-col overflow-hidden"},Re={class:"text-uppercase line-clamp-1 font-semibold"},Le={class:"text-uppercase line-clamp-1 text-xxs"},Qe={class:"flex justify-end gap-2 -mr-5 mt-1"},ze={__name:"category-index",setup(x){const g=U("$me"),p=B(),l=A({visibleColumns:g.unixroles&1?["action","description","ref","created"]:["action","description","created"],dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:description,ref",pagination:{sortBy:"description",descending:!1,page:1,rowsPerPage:20},url:"category",query:{groupBy:["t_category.id"],where:{c_status:4,level:0,"ne:root":g.unixroles&1?null:1}},columns:[{name:"action",required:!0,label:"",align:"left",field:i=>i.id,format:i=>`${i}`,classes:"w-[190px]"},{name:"description",required:!0,label:"Nombre",align:"left",field:i=>i.description,sortable:!0},{name:"ref",label:"Ref",align:"left",field:i=>i.ref,sortable:!0},{name:"created",required:!0,label:"Creado",align:"left",field:"created_format",sortable:!0}],rows:[]}),{onRequest:C,getSelectedString:f,onDeleteRows:V,addMore:t,itemsRange:v}=te(l,p),D=H();return E(()=>D.table.t_category,i=>{p.value.requestServerInteraction(),p.value.clearSelection()},{deep:!0}),(i,a)=>(c(),_(J,null,[o("div",he,[o("div",_e,[s(h,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:l.search,"onUpdate:modelValue":a[0]||(a[0]=e=>l.search=e),placeholder:i.$t("search")},{append:r(()=>[s(z,{name:"search"})]),_:1},8,["modelValue","placeholder"]),y(g).unixroles&1?(c(),w(m,{key:0,flat:"",class:"button h-full",icon:"add",label:i.$isDesktop&&i.$t("add"),onClick:a[1]||(a[1]=e=>l.dialogCreate=!0)},null,8,["label"])):$("",!0),l.selected.length&&y(g).unixroles&1?(c(),w(m,{key:1,flat:"",class:"button h-full bg-primary text-white","icon-right":"sym_o_remove",label:i.$isDesktop?"Remover":"","no-caps":"",onClick:y(V)},null,8,["label","onClick"])):$("",!0)]),i.$isDesktop?(c(),_("div",Ce,[s(m,{class:"bg-transparent",flat:"","no-caps":""},{default:r(()=>[q(k(y(v).start)+" - "+k(y(v).end)+" de "+k(l.pagination.rowsNumber),1)]),_:1}),s(m,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:a[2]||(a[2]=e=>p.value.firstPage())}),s(m,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:a[3]||(a[3]=e=>p.value.prevPage())}),s(m,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:a[4]||(a[4]=e=>p.value.nextPage())}),s(m,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:a[5]||(a[5]=e=>p.value.lastPage())})])):$("",!0)]),s(ae,{grid:!i.$isDesktop,"visible-columns":l.visibleColumns,"hide-pagination":"",rows:l.rows,columns:l.columns,"row-key":"id",ref_key:"tableRef",ref:p,onRequest:y(C),flat:"",selection:"multiple",pagination:l.pagination,"onUpdate:pagination":a[6]||(a[6]=e=>l.pagination=e),selected:l.selected,"onUpdate:selected":a[7]||(a[7]=e=>l.selected=e),"selected-rows-label":y(f),loading:l.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},se({"no-data":r(({icon:e,message:u,filter:n})=>[o("div",Ve,[o("span",null,k(u),1),s(z,{size:"2em",name:n?"filter_b_and_w":e},null,8,["name"])])]),"body-cell-avatar":r(e=>[s(j,{props:e},{default:r(()=>[s(le,{rounded:"",size:"42px"},{default:r(()=>[o("img",{src:i.$imageInsuredPlaceholder(e.value)},null,8,De)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-action":r(e=>[s(j,{props:e},{default:r(()=>[o("div",Ie,[y(g).unixroles&1?(c(),w(m,{key:0,flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:u=>{l.selectedId=e.row.id,l.dialogWrite=!0}},null,8,["onClick"])):$("",!0),s(m,{flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"listado","no-caps":"",onClick:u=>{l.selectedId=e.row.id,l.dialogList=!0}},null,8,["onClick"])])]),_:2},1032,["props"])]),item:r(e=>[o("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:S(e.selected?"transform: scale(0.95);":"")},[o("div",qe,[o("div",Ue,[s(M,{dense:"",modelValue:e.selected,"onUpdate:modelValue":u=>e.selected=u,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),o("div",Se,[o("span",Re,k(e.row.description),1),o("span",Le,k(e.row.ref),1),o("div",Qe,[y(g).unixroles&1?(c(),w(m,{key:0,flat:"",class:"button bg-default text-primary rounded-md",label:"Editar","no-caps":"",onClick:u=>{l.selectedId=e.row.id,l.dialogWrite=!0}},null,8,["onClick"])):$("",!0),s(m,{flat:"",class:"button bg-default text-primary rounded-md",label:"listado","no-caps":"",onClick:u=>{l.selectedId=e.row.id,l.dialogList=!0}},null,8,["onClick"])])])])],4)]),_:2},[i.$isDesktop?void 0:{name:"bottom",fn:r(()=>[s(m,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:y(t)},{default:r(()=>[q("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","visible-columns","rows","columns","onRequest","pagination","selected","selected-rows-label","loading"]),s(L,{class:"q-pa-none",modelValue:l.dialogWrite,"onUpdate:modelValue":a[9]||(a[9]=e=>l.dialogWrite=e),position:i.$isDesktop?"right":"standard","full-height":"","full-width":i.$isDesktop,maximized:"","transition-duration":100},{default:r(()=>[s(R,null,{default:r(()=>[s(F,{onClose:a[8]||(a[8]=e=>l.dialogWrite=!1),isDrawer:"",id:l.selectedId,isEdit:"",width:i.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),s(L,{modelValue:l.dialogList,"onUpdate:modelValue":a[11]||(a[11]=e=>l.dialogList=e),position:i.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:r(()=>[s(R,null,{default:r(()=>[s(xe,{onClose:a[10]||(a[10]=e=>l.dialogList=!1),isDrawer:"",id:l.selectedId,width:i.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position"]),s(L,{modelValue:l.dialogCreate,"onUpdate:modelValue":a[13]||(a[13]=e=>l.dialogCreate=e),position:i.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:r(()=>[s(R,null,{default:r(()=>[s(F,{onClose:a[12]||(a[12]=e=>l.dialogCreate=!1),isDrawer:"",width:i.$isDesktop?"400px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"])],64))}};export{ze as default};
