import{l as m,m as g,n as w,w as f,$ as v,t as r,G as c,y as d,z as s,x as o,U as _,V as y,v as V,bu as k,F as x,bv as Q,aK as T,aC as u,D as $,H as h,C as B,I as C}from"./index.e9245a9e.js";const I={class:"flex flex-nowrap"},U={class:"w-[200px] mt-1 mr-2"},N={class:"w-full"},D={__name:"privilege-index",setup(P){const n=m("$api"),b=g(),a=w({role:{},table:{},tab:"",tabId:1,privilege:[],columns:[{name:"table",label:"Tabla",field:"table",align:"center",classes:"w-[300px]"},{name:"create",label:"Crear",field:"create",align:"center"}],rows:[],pagination:{sortBy:"",descending:!1,page:1,rowsPerPage:100}});f(()=>a.tab,async t=>{const[l]=a.role.items.filter(e=>e.label===t);a.tabId=l.value,a.privilege=await n.get(`privilege/table/${a.tabId}`),a.rows=a.privilege.items});async function p(t,l,e){n.post("privilege",[{c_related_table:e.row.table,c_who:a.tabId,c_action:"create",c_group:"role"}]),b.notify({type:"success",message:"Privilegio actualizado"})}return v(async()=>{const t=await n.get("/permission/tables");a.table=t.tables_unixperms,a.role=await n.get("role"),a.tab="ROOT"}),(t,l)=>(r(),c("div",I,[d("div",U,[s(Q,{modelValue:a.tab,"onUpdate:modelValue":l[0]||(l[0]=e=>a.tab=e),dense:"",stretch:"","indicator-color":"transparent",align:"left","mobile-arrows":!1,vertical:"","active-color":"primary","active-class":"active-tab"},{default:o(()=>[(r(!0),c(_,null,y(a.role.items,e=>(r(),V(k,{key:e.id,name:e.label,"content-class":"p-0 w-full",class:"w-full p-0 mb-2"},{default:o(()=>[s(x,{flat:"",class:"button-tab text-font w-full","no-caps":"",label:e.label},null,8,["label"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),d("div",N,[s(C,{pagination:a.pagination,"onUpdate:pagination":l[1]||(l[1]=e=>a.pagination=e),flat:"",rows:a.rows,columns:a.columns,"row-key":"name",separator:"vertical"},{body:o(e=>[s(T,{props:e},{default:o(()=>[s(u,{key:"table",props:e},{default:o(()=>[$(h(t.$t(e.row.table)),1)]),_:2},1032,["props"]),s(u,{key:"create",props:e},{default:o(()=>[s(B,{modelValue:e.row.create,"onUpdate:modelValue":[i=>e.row.create=i,i=>p(t.key,t.value,e)]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["pagination","rows","columns"])])]))}};export{D as default};
