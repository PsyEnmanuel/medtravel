import{az as fe,m as oe,r as H,l as te,n as ne,a3 as R,w as pe,$ as de,t as u,G as D,z as l,x as c,aK as be,U as W,V as re,v as b,aC as ye,Q as x,A as ve,b2 as ge,b3 as xe,ao as $e,b4 as Ie,am as Ue,b5 as C,B as d,b6 as De,b7 as Ce,b8 as A,y as o,F as O,b9 as T,ba as q,D as U,H as h,bb as we,I as ke,bc as V,bd as M,ah as Ee,be as Re,bf as Ae,E as ee,W as z,a7 as Pe,ac as Se,bg as ue,aS as L,_ as Te,aT as ce,ar as se,aF as me,ap as qe,a5 as _e,bh as Oe,aW as Qe,M as Be,ab as Me,L as Ge,K as Ne,bi as ze,a4 as Fe}from"./index.09b51acc.js";const Ye={class:"w-full"},Ke={key:4,class:"flex flex-nowrap w-auto"},We={class:"flex flex-col ml-1"},je={__name:"ConciliationItems",props:{items:Array,isEdit:Boolean},emits:["setItems"],setup(j,{emit:w}){const{t:m}=fe();oe();const F=H(),P=te("$api"),Y=j,$=w,I=ne({timeout:null,timeoutRow:null,columns:[{name:"date",label:"Fecha",field:"date",align:"left",classes:"min-w-[150px]"},{name:"provider",label:"Proveedor",field:"provider",align:"left",classes:"min-w-[250px]"},{name:"user_description",label:"Prestador de Servicios",field:"user_description",align:"left",classes:"min-w-[150px]"},{name:"item_description",label:"CPT",field:"item_description",align:"left",classes:"min-w-[250px]"},{name:"billed_amount",label:m("MONTO FACTURADO"),field:"billed_amount",align:"left",classes:"min-w-[100px]"},{name:"discount",label:m("DESCUENTO DE AJUSTE"),field:"discount",align:"left",classes:"min-w-[100px]"},{name:"coverage",label:m("MONTO A PROCESAR"),field:"coverage",align:"left",classes:"min-w-[100px]"},{name:"deductible",label:m("DEDUCIBLE / COPAGO"),field:"deductible",align:"left",classes:"min-w-[100px]"},{name:"covered",label:m("CUBIERTO"),field:"covered",align:"left",classes:"min-w-[100px]"},{name:"insurance_payment",label:m("PAGO DE ASEGURADA"),field:"insurance_payment",align:"left",classes:"min-w-[100px]"},{name:"insurance_responsability",label:m("RESP. ASEGURADA"),field:"insurance_responsability",align:"left",classes:"min-w-[100px]"},{name:"insurance_claim",label:m("insurance_claim"),field:"insurance_claim",align:"left",classes:"min-w-[100px]"},{name:"note",label:m("NOTA"),field:"note",align:"left",classes:"min-w-[100px]"}],rows:[]}),G=R(()=>I.rows.filter(i=>i.c_status&4));pe(()=>I.rows,i=>{clearTimeout(I.timeout),I.timeout=setTimeout(()=>{$("setItems",I.rows)},300)},{deep:!0});const e=H([]),E=i=>{e.value[i]&&e.value[i].hide()};function B(i){i.quantity?i.quantity=parseInt(i.quantity)+1:i.quantity=1}function N(i){parseInt(i.quantity)>1&&(i.quantity=parseInt(i.quantity)-1)}function v(i){const f=V(i.billed_amount||0),n=V(i.discount||0);i.coverage=M(f-n)}function Q(i){const f=V(i.coverage||0),n=V(i.deductible||0);f&&n&&(i.covered=f-n)}async function _(i,f){try{const n=await P.get(`provider/${i}`);f.provider_id=String(n.id),f.provider_description=n.description}catch(n){console.log(n)}}function k(i){try{i.provider_id=null,i.provider_description=null}catch(f){console.log(f)}}async function y(i,f){try{const n=await P.get(`doctor/${i}`);f.doctor_id=n.id,f.doctor_description=n.description,setItinerary()}catch(n){console.log(n)}}function J(i){try{i.doctor_id=null,i.doctor_description=null,setItinerary()}catch(f){console.log(f)}}function X(i){const f=V(i.insurance_payment||0),n=V(i.deductible||0);i.insurance_responsability=f-n}async function ae(i,f){try{const n=await P.get(`CPT/${i}`);f.item_description=n.description,f.item_id=n.id,f.item_code=n.code}catch(n){console.log(n)}}async function ie(i){try{if(Y.isEdit){i.c_status=1;return}i.user_id=null,i.user_description=null,i.item_id=null,i.item_description=null,i.item_code=null,i.billed_amount=null,i.discount=null,i.coverage=null,i.deductible=null,i.covered=null,i.insurance_payment=null,i.insurance_responsability=null,i.insurance_claim=null,i.note=null}catch(f){console.log(f)}}const K=()=>({c_status:4,user_id:null,user_description:null,item_description:null,quantity:1,reset:0,billed_amount:null,coverage:null,deductible:null,covered:null,insurance_payment:null,insurance_responsability:null,insurance_claim:null,note:null});function le(){I.rows.push(K())}return de(()=>{I.rows=Y.items.concat(Array.from({length:5},()=>K()))}),(i,f)=>(u(),D("div",Ye,[l(ke,{"hide-pagination":"","rows-per-page-options":[0],rows:G.value,columns:I.columns,"row-key":"id",ref_key:"tableRef",ref:F,onRequest:i.onRequest,flat:"",loading:I.loading,"wrap-cells":!0},{body:c(n=>[l(be,{props:n},{default:c(()=>[(u(!0),D(W,null,re(n.cols,g=>(u(),b(ye,{class:"text-xxs",key:g.name,props:n},{default:c(()=>[g.name==="date"?(u(),b(x,{key:0,dense:"",outlined:"",modelValue:n.row.book_date,"onUpdate:modelValue":s=>n.row.book_date=s,mask:"##-##-####",label:i.$t("date"),rules:[i.requiredInput],"hide-bottom-space":""},{append:c(()=>[l(ve,{name:"event",class:"cursor-pointer"},{default:c(()=>[l(ge,{ref_for:!0,ref:"popupRefs"},{default:c(()=>[l(xe,{flat:"",modelValue:n.row.book_date,"onUpdate:modelValue":[s=>n.row.book_date=s,s=>E(n.rowIndex)],"no-unset":"","years-in-month-view":"",minimal:"",mask:"DD-MM-YYYY"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):g.name==="provider"?(u(),b($e,{key:1,onSetProvider:s=>_(s,n.row),onClearProvider:s=>k(n.row),"model-value":n.row.provider_description,id:n.row.provider_id},null,8,["onSetProvider","onClearProvider","model-value","id"])):g.name==="user_description"?(u(),b(Ie,{key:2,onSetDoctor:s=>y(s,n.row),onClearDoctor:s=>J(n.row),"model-value":n.row.doctor_description,id:n.row.doctor_id},null,8,["onSetDoctor","onClearDoctor","model-value","id"])):g.name==="item_description"?(u(),b(Ue,{key:3,onSetProcedure:s=>ae(s,n.row),onClearInsured:s=>ie(n.row),"model-value":n.row.item_description,id:n.row.item_id},null,8,["onSetProcedure","onClearInsured","model-value","id"])):g.name==="quantity"?(u(),D("div",Ke,[C(l(x,{modelValue:n.row.quantity,"onUpdate:modelValue":s=>n.row.quantity=s,dense:"",outlined:"",class:"w-[50px]","data-maska":d(De),"data-maska-tokens":d(Ce)},null,8,["modelValue","onUpdate:modelValue","data-maska","data-maska-tokens"]),[[d(A)]]),o("div",We,[l(O,{flat:"",class:"button bg-primary-light px-2 py-0.5 h-fit mb-0.5",size:"xs",icon:"add",onClick:s=>B(n.row)},null,8,["onClick"]),l(O,{flat:"",class:"button bg-danger-light px-2 py-0.5 h-fit",size:"xs",rounded:"",icon:"remove",onClick:s=>N(n.row)},null,8,["onClick"])])])):g.name==="billed_amount"?C((u(),b(x,{key:5,readonly:!n.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:n.row.billed_amount,"onUpdate:modelValue":[s=>n.row.billed_amount=s,s=>v(n.row)],"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="discount"?C((u(),b(x,{key:6,readonly:!n.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:n.row.discount,"onUpdate:modelValue":[s=>n.row.discount=s,s=>v(n.row)],"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="coverage"?C((u(),b(x,{key:7,readonly:!n.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:n.row.coverage,"onUpdate:modelValue":[s=>n.row.coverage=s,s=>Q(n.row)],"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="deductible"?C((u(),b(x,{key:8,readonly:!n.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:n.row.deductible,"onUpdate:modelValue":[s=>n.row.deductible=s,s=>{Q(n.row),X(n.row)}],"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="covered"?C((u(),b(x,{key:9,readonly:!n.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:n.row.covered,"onUpdate:modelValue":s=>n.row.covered=s,"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="insurance_payment"?C((u(),b(x,{key:10,readonly:!n.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:n.row.insurance_payment,"onUpdate:modelValue":[s=>n.row.insurance_payment=s,s=>X(n.row)],"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="insurance_responsability"?C((u(),b(x,{key:11,readonly:"","input-class":"text-right",dense:"",outlined:"",modelValue:n.row.insurance_responsability,"onUpdate:modelValue":s=>n.row.insurance_responsability=s,"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):g.name==="insurance_claim"?(u(),b(x,{key:12,readonly:!n.row.item_id,dense:"",outlined:"",modelValue:n.row.insurance_claim,"onUpdate:modelValue":s=>n.row.insurance_claim=s,"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue"])):g.name==="note"?(u(),b(x,{key:13,readonly:!n.row.item_id,dense:"",outlined:"",modelValue:n.row.note,"onUpdate:modelValue":s=>n.row.note=s,"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue"])):(u(),D(W,{key:14},[U(h(g.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":c(({icon:n,message:g,filter:s})=>[l(we,{icon:n,message:g,filter:s},null,8,["icon","message","filter"])]),bottom:c(()=>[l(O,{flat:"",class:"button bg-primary-light w-full mt-2","no-caps":"",onClick:le},{default:c(()=>[U("Agregar m\xE1s lineas")]),_:1})]),_:1},8,["rows","columns","onRequest","loading"])]))}},Le={class:"w-full"},He=o("div",{class:"subtitle text-xs text-center"},"Pagos",-1),Je={__name:"ConciliationPayment",props:{items:Array,isEdit:Boolean},emits:["setItems"],setup(j,{emit:w}){const{t:m}=fe();oe();const F=H();te("$api");const P=j,Y=w,$=ne({timeout:null,timeoutRow:null,columns:[{name:"date",label:"Fecha",field:"date",align:"left",classes:"min-w-[150px]"},{name:"description",label:m("DESC."),field:"description",align:"left",classes:"min-w-[100px]"},{name:"note",label:m("NOTA"),field:"note",align:"left",classes:"min-w-[100px]"},{name:"insurance_payment",label:m("PAGO DE ASEGURADA"),field:"insurance_payment",align:"left",classes:"min-w-[100px]"},{name:"insurance_responsability",label:m("RESP. ASEGURADA"),field:"insurance_responsability",align:"left",classes:"min-w-[100px]"}],rows:[]}),I=R(()=>$.rows.filter(v=>v.c_status&4));pe(()=>$.rows,v=>{clearTimeout($.timeout),$.timeout=setTimeout(()=>{Y("setItems",$.rows)},300)},{deep:!0});const G=H([]),e=v=>{G.value[v]&&G.value[v].hide()};function E(v){const Q=V(v.insurance_payment||0),_=V(v.deductible||0);v.insurance_responsability=Q-_}const B=()=>({book_date:Ee(new Date,"dd-MM-yyyy"),c_status:4,quantity:1,reset:0,insurance_payment:null,insurance_responsability:null,note:null});function N(){$.rows.push(B())}return de(()=>{$.rows=P.items.concat(Array.from({length:2},()=>B()))}),(v,Q)=>(u(),D("div",Le,[He,l(ke,{"hide-pagination":"","rows-per-page-options":[0],rows:I.value,columns:$.columns,"row-key":"id",ref_key:"tableRef",ref:F,onRequest:v.onRequest,flat:"",loading:$.loading,"wrap-cells":!0},{body:c(_=>[l(be,{props:_},{default:c(()=>[(u(!0),D(W,null,re(_.cols,k=>(u(),b(ye,{class:"text-xxs",key:k.name,props:_},{default:c(()=>[k.name==="date"?(u(),b(x,{key:0,dense:"",outlined:"",modelValue:_.row.book_date,"onUpdate:modelValue":y=>_.row.book_date=y,mask:"##-##-####",label:v.$t("date"),rules:[v.requiredInput],"hide-bottom-space":""},{append:c(()=>[l(ve,{name:"event",class:"cursor-pointer"},{default:c(()=>[l(ge,{ref_for:!0,ref:"popupRefs"},{default:c(()=>[l(xe,{flat:"",modelValue:_.row.book_date,"onUpdate:modelValue":[y=>_.row.book_date=y,y=>e(_.rowIndex)],"no-unset":"","years-in-month-view":"",minimal:"",mask:"DD-MM-YYYY"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):k.name==="description"?(u(),b(x,{key:1,dense:"",outlined:"",modelValue:_.row.description,"onUpdate:modelValue":y=>_.row.description=y,"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue"])):k.name==="note"?(u(),b(x,{key:2,dense:"",outlined:"",modelValue:_.row.note,"onUpdate:modelValue":y=>_.row.note=y,"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue"])):k.name==="insurance_payment"?C((u(),b(x,{key:3,"input-class":"text-right",dense:"",outlined:"",modelValue:_.row.insurance_payment,"onUpdate:modelValue":[y=>_.row.insurance_payment=y,y=>E(_.row)],"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):k.name==="insurance_responsability"?C((u(),b(x,{key:4,"input-class":"text-right",dense:"",outlined:"",modelValue:_.row.insurance_responsability,"onUpdate:modelValue":y=>_.row.insurance_responsability=y,"data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(q)]]):(u(),D(W,{key:5},[U(h(k.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":c(({icon:_,message:k,filter:y})=>[l(we,{icon:_,message:k,filter:y},null,8,["icon","message","filter"])]),bottom:c(()=>[l(O,{flat:"",class:"button bg-primary-light w-full mt-2","no-caps":"",onClick:N},{default:c(()=>[U("Agregar m\xE1s lineas")]),_:1})]),_:1},8,["rows","columns","onRequest","loading"])]))}},Xe={class:"flex md:flex-nowrap justify-between mb-2"},Ze={class:"w-[300px] min-w-[300px]"},et={key:0,class:"flex flex-col"},tt={class:"text-xs"},nt={class:"flex items-center"},at={class:"text-xs"},it=o("span",null,"\xA0-\xA0",-1),lt={class:"text-xs"},st=o("span",null,"\xA0-\xA0",-1),ot={class:"text-xs"},dt={class:"grid lg:grid-cols-4 grid-cols-2 gap-2 w-[600px]"},rt={class:"flex flex-nowrap w-full"},ut={class:"flex flex-col w-full"},ct={class:"text-font text-right text-md"},mt={class:"flex flex-col"},_t={class:"text-font text-right text-md"},ft={class:"flex flex-col"},pt={class:"text-font text-right text-md"},bt={class:"flex flex-col"},yt={class:"text-font text-right text-md"},vt={class:"flex flex-col"},gt={class:"text-font text-right text-md"},xt={class:"flex flex-col"},wt={class:"text-font text-right text-md"},kt={class:"flex flex-col"},ht={class:"text-font text-right text-md"},Vt={class:"flex flex-nowrap w-full"},$t={class:"grid grid-cols-6 gap-2"},It={class:"col-span-5 flex md:flex-nowrap gap-2"},Ut={class:"w-full"},Dt={key:0,class:"mt-2"},Ct={class:"flex flex-col gap-1 mb-1"},Et=o("div",{class:"subtitle text-xs text-center"},"Moneda",-1),Rt=o("div",{class:"subtitle text-xs text-center"},"\xC1rea",-1),At={class:"flex flex-col gap-1"},Pt=o("div",{class:"subtitle text-center text-xs"},"Diagn\xF3sticos",-1),St={class:"w-full flex flex-col justify-between border card shadow-none px-3 py-1"},Tt={class:"text-xs uppercase line-clamp-1"},qt={class:"text-xs uppercase line-clamp-1"},Ot={class:"fixed bottom-0 right-0 py-2 bg-white w-full"},Qt={class:"flex flex-nowrap gap-2 px-2 mt-1"},Nt={__name:"conciliation-write",props:{id:Number,eventId:String,width:String,isDrawer:Boolean},setup(j){const w=j,m=te("$api"),F=te("$cats"),P=oe(),Y=Re(),$=H(),I=ne({currency:F.value.currency,policy_branch:F.value.policy_branch}),G=()=>({diagnosis:[],$book_state_id:50,$currency_id:14,book_date:ze(new Date)}),e=ne({payments:[],submitting:!1,loading:!0,event:{},items:[],item:G()}),E=R(()=>Boolean(w.id)),B=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.coverage)||0),t),0);return M(a)}),N=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.discount)||0),t),0);return M(a)}),v=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.billed_amount)||0),t),0);return M(a)}),Q=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.deductible)||0),t),0);return M(a)}),_=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.covered)||0),t),0);return M(a)}),k=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.insurance_payment)||0),t),0);return M(a)}),y=R(()=>{const a=e.items.reduce((t,r)=>(r.c_status&1||(t+=V(r.insurance_responsability)||0),t),0);return M(a)});async function J(a){try{if(!a)return;const t=await m.get(`insured/${a}`);if(!w.isEdit&&t.policies){const r=t.policies[0];K(r)}e.item.insured_id=t.id,e.item.insured_description=t.fullname}catch(t){console.log(t)}}function X(){e.item.insured_id=null,e.item.insured=null,le()}async function ae(a){try{if(!a)return;const t=await m.get(`insured/${a}`);e.item.titular_id=t.id,e.item.titular_description=t.fullname}catch(t){console.log(t)}}function ie(){e.item.titular_id=null,e.item.titular=null}async function K(a){e.item.insured_id||(e.item.insured_id=a.insured_id,e.item.insured_description=a.insured_description),e.item.insurance_id=a.insurance_id,e.item.insurance_description=a.insurance,e.item.titular_id=a.titular_id,e.item.titular_description=a.titular_description,e.item.insured_code=a.insured_code,e.item.deductible=a.deductible,e.item.policy_id=a.id,e.item.policy_number=a.policy_number,e.item.policy_branch=a.policy_branch,e.item.$policy_branch_id=a.$policy_branch_id}async function le(){e.item.insurance_id=null,e.item.insurance_description=null,e.item.titular_id=null,e.item.titular_description=null,e.item.insured_code=null,e.item.policy_id=null,e.item.policy_number=null,e.item.deductible=null}async function i(a){try{const t=await m.get(`ICD10/${a}`);if(e.item.diagnosis.findIndex(S=>S.id===a)!==-1){P.notify({type:"warning",message:"Diagn\xF3stico ya esta agregado"});return}e.item.diagnosis.push({id:t.id,code:t.code,description:t.description}),e.item.diagnosis_description=null,e.item.diagnosis_id=null}catch(t){console.log(t)}}function f(){try{e.item.diagnosis_id=null,e.item.diagnosis_description=null}catch(a){console.log(a)}}function n(a){try{const t=e.item.diagnosis.findIndex(r=>r.id===a);e.item.diagnosis.splice(t,1)}catch(t){console.log(t)}}function g(){e.item=G(),setTimeout(()=>{$.value.resetValidation()}),Z()}async function s(){e.submitting=!0;const a=await m.get(`conciliation/pdf/${w.id}`);console.log(11,a),Fe(a,`${e.item.code}-${e.item.insurance_description}`.toUpperCase()),e.submitting=!1}async function he(){try{if(E.value){const a=e.items.filter(r=>r.item_id);if(!a.length){P.notify({type:"success",message:"Es requerido que la reconcilici\xF3n tenga por lo menos 1 CPT"});return}const t=await m.put(`conciliation/${w.id}`,{book:{...e.item,billed_amount_total:v.value,coverage_total:B.value,discount_total:N.value,deductible_total:Q.value,covered_total:_.value,insurance_payment_total:k.value,insurance_responsability_total:y.value},book_items:a,book_payments:e.payments});t&&(P.notify({type:"success",message:`Reconciliaci\xF3n Editada ${t.code}`}),location.reload(),Z())}else{const a=await m.post("conciliation",{book:{...e.item,billed_amount_total:v.value,coverage_total:B.value,discount_total:N.value,deductible_total:Q.value,covered_total:_.value,insurance_payment_total:k.value,insurance_responsability_total:y.value},book_items:e.items.filter(t=>t.c_status===4&&t.item_id),book_payments:e.payments.filter(t=>t.c_status===4)});w.eventId&&m.put(`event/general/${w.eventId}`,{book_code:a.code}),a&&(P.notify({type:"success",message:`Reconciliaci\xF3n agregada ${a.code}`}),await m.get(`conciliation/pdf/${a.code}`),g(),Y.push("/"),Z())}}catch(a){console.log(a)}}async function Z(){try{if(E.value){const{item:a,items:t,payments:r}=await m.get(`conciliation/${w.id}`);e.item=a,e.items=t,e.payments=r,e.item.event_id&&(e.event=await m.get(`event/${e.item.event_id}`)),e.loading=!1;return}if(w.eventId){e.event=await m.get(`event/${w.eventId}`),e.policy=await m.get(`policy/insured/${e.event.policy_id}`),e.item.event_id=e.event.id,K(e.policy),e.item.diagnosis=e.event.diagnosis,e.itineraries=await m.get("itinerary",{params:{where:{c_status:4,event_id:w.eventId},returnItems:!0}});for(let a=0;a<e.itineraries.length;a++){const t=e.itineraries[a];for(let r=0;r<t.mprocedure.length;r++){const S=t.mprocedure[r];e.items.push({c_status:4,book_date:t.attendance_date,item_id:S.id,item_description:S.description,provider_id:t.provider_id,provider_description:t.provider_description,quantity:1,reset:0,billed_amount:null,coverage:null,deductible:null,covered:null,insurance_payment:null,insurance_responsability:null,insurance_claim:null,note:null})}}await J(e.event.insured_id),e.item.user_id=e.event.user_id,e.item.user_description=e.event.user_description}e.loading=!1}catch(a){console.log(a)}}de(()=>{Z()});const Ve=R(()=>({width:w.width,"padding-right":w.isDrawer&&"8px","padding-left":w.isDrawer&&"8px"}));return(a,t)=>{const r=Ae("loading");return e.loading?ee("",!0):(u(),D("div",{key:0,style:Ne(Ve.value),class:"relative pb-32 px-4"},[l(Qe,{ref_key:"mainForm",ref:$,onSubmit:he},{default:c(()=>{var S;return[o("div",Xe,[o("div",Ze,[(S=e.event)!=null&&S.id?(u(),D("div",et,[o("span",tt,h(e.event.contact_description),1),o("div",nt,[o("span",at,"#"+h(e.event.code),1),it,o("span",lt,h(e.event.event_type),1),st,o("span",ot,h(e.event.event_state),1)]),l(O,{flat:"",class:"button bg-btn-green rounded-md w-full",label:"Abrir Coordinaci\xF3n","no-caps":"",onClick:t[0]||(t[0]=p=>{e.dialogWriteEvent=!0})})])):ee("",!0)]),o("div",dt,[o("div",rt,[o("div",ut,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("Total Reconciliaci\xF3n")]),_:1}),o("span",ct,h(a.$currency(v.value)),1)])]),o("div",mt,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("Descuento de Ajuste")]),_:1}),o("span",_t,h(a.$currency(N.value)),1)]),o("div",ft,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("Monto a Procesar")]),_:1}),o("span",pt,h(a.$currency(B.value)),1)]),o("div",bt,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("DEDUCIBLE / COPAGO")]),_:1}),o("span",yt,h(a.$currency(Q.value)),1)]),o("div",vt,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("CUBIERTO")]),_:1}),o("span",gt,h(a.$currency(_.value)),1)]),o("div",xt,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("PAGO DE ASEGURADA")]),_:1}),o("span",wt,h(a.$currency(k.value)),1)]),o("div",kt,[l(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[U("RESP. ASEGURADA")]),_:1}),o("span",ht,h(a.$currency(y.value)),1)]),o("div",Vt,[E.value?C((u(),b(O,{key:0,flat:"",class:"button-press bg-btn-red rounded-md w-full",label:"Imprimir","no-caps":"",onClick:s},null,512)),[[r,e.submitting]]):ee("",!0)])])]),o("div",$t,[o("div",It,[o("div",Ut,[l(je,{items:e.items,isEdit:E.value,onSetItems:t[1]||(t[1]=p=>e.items=p)},null,8,["items","isEdit"]),l(Je,{class:"pt-2",items:e.payments,isEdit:E.value,onSetItems:t[2]||(t[2]=p=>e.payments=p)},null,8,["items","isEdit"]),E.value?(u(),D("div",Dt,[l(Pe,{ref_id:e.item.id,table:"t_book",file_type:"GENERAL"},null,8,["ref_id"]),l(Se,{refId:e.item.id,refKey:"t_book"},null,8,["refId"])])):ee("",!0)])]),o("div",Ct,[l(ue,{ref:"mainInput",onSetInsured:J,onSetPolicy:K,onClearInsured:X,"model-value":e.item.insured_description,id:e.item.insured_id,rules:[d(L)]},null,8,["model-value","id","rules"]),l(ue,{readonly:"",ref:"mainInput",onSetInsured:ae,onClearInsured:ie,"model-value":e.item.titular_description,id:e.item.titular_id,label:"Titular",rules:[d(L)]},null,8,["model-value","id","rules"]),l(Te,{onSetInsurance:t[3]||(t[3]=p=>a.setInsurance(p,a.row)),onClearInsurance:t[4]||(t[4]=p=>a.clearInsurance(a.row)),"model-value":e.item.insurance_description,rules:[d(L)],"hide-bottom-space":""},null,8,["model-value","rules"]),l(x,{readonly:"",dense:"",outlined:"",modelValue:e.item.policy_number,"onUpdate:modelValue":t[5]||(t[5]=p=>e.item.policy_number=p),label:a.$t("policy_number"),onKeydown:t[6]||(t[6]=ce(se(()=>{},["prevent"]),["enter"])),rules:[d(L)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),l(x,{readonly:"",dense:"",outlined:"",modelValue:e.item.insured_code,"onUpdate:modelValue":[t[7]||(t[7]=p=>e.item.insured_code=p),a.findInsuredCode],label:a.$t("insured_code"),onKeydown:t[8]||(t[8]=ce(se(()=>{},["prevent"]),["enter"])),"hide-bottom-space":""},null,8,["modelValue","label","onUpdate:modelValue"]),C(l(x,{"input-class":"text-right",dense:"",outlined:"",modelValue:e.item.deductible,"onUpdate:modelValue":t[9]||(t[9]=p=>e.item.deductible=p),label:"Deducible","data-maska":"0.99","data-maska-tokens":d(T),"hide-bottom-space":"",rules:[d(L)]},null,8,["modelValue","data-maska-tokens","rules"]),[[d(A),void 0,d(q)]]),o("div",null,[Et,l(me,{class:"flex gap-1 text-xs",size:"sm",modelValue:e.item.$currency_id,"onUpdate:modelValue":t[10]||(t[10]=p=>e.item.$currency_id=p),"toggle-color":"secondary","toggle-text-color":"text-font",options:I.currency},null,8,["modelValue","options"])]),o("div",null,[Rt,l(me,{class:"flex gap-1 text-xs",size:"sm",modelValue:e.item.$policy_branch_id,"onUpdate:modelValue":t[11]||(t[11]=p=>e.item.$policy_branch_id=p),"toggle-color":"secondary","toggle-text-color":"text-font",options:I.policy_branch},null,8,["modelValue","options"])]),o("div",At,[Pt,l(qe,{onSetDiagnosis:i,onClearInsured:f,"model-value":e.item.diagnosis_description},null,8,["model-value"]),(u(!0),D(W,null,re(e.item.diagnosis,(p,Bt)=>(u(),D("div",{class:"flex flex-nowrap gap-1",key:p.id},[o("div",St,[o("div",Tt,h(p.description),1),o("div",qt,h(p.code),1)]),l(O,{diabled:"",flat:"",class:"button-icon bg-primary text-white text-[10px] h-[40px]",icon:"fa-solid fa-xmark",onClick:Mt=>n(p.id)},{default:c(()=>[l(_e,{class:"bg-default text-black text-xs"},{default:c(()=>[U("Remover diagn\xF3stico")]),_:1})]),_:2},1032,["onClick"])]))),128))])])]),o("div",Ot,[l(Oe,{item:e.item,isEdit:E.value},null,8,["item","isEdit"]),o("div",Qt,[w.isEdit?(u(),D(W,{key:0},[l(O,{class:"button-icon bg-primary text-white py-0",icon:"fa-solid fa-xmark",rounded:"",onClick:t[12]||(t[12]=se(p=>a.onDelete(e.item.id),["stop"])),size:"sm"},{default:c(()=>[l(_e,{class:"bg-default text-black",size:"xs"},{default:c(()=>[U("Remover")]),_:1})]),_:1}),l(O,{class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"guardar cambios",type:"submit"})],64)):(u(),b(O,{key:1,class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"guardar cambios",type:"submit"}))])])]}),_:1},512),l(Ge,{modelValue:e.dialogWriteEvent,"onUpdate:modelValue":t[14]||(t[14]=S=>e.dialogWriteEvent=S),position:a.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:c(()=>[l(Be,null,{default:c(()=>[l(Me,{onClose:t[13]||(t[13]=S=>e.dialogWriteEvent=!1),isDrawer:"",id:e.event.id,isEdit:"",width:(a.$isDesktop,"100%")},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position"])],4))}}};export{Nt as default};
