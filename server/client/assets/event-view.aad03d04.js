import{r as Q,l as C,n as S,$ as L,k as N,w as I,t as d,G as c,U as V,V as F,v,a0 as A,y as t,H as f,z as a,B as M,a1 as z,F as P,x as l,D as T,E as p,a2 as B,a3 as G,K,M as k,a4 as y,a5 as O,L as E,a6 as q,m as H,a7 as W,R as J,A as X,a8 as Y,a9 as g,aa as Z,ab as ee,ac as te,ad as ae,S as ie}from"./index.afe9c2e8.js";import{_ as oe}from"./ChartPoll.7707c2e9.js";import se from"./itinerary-index.7a346bd0.js";const le={class:"grid lg:grid-cols-2 gap-4"},re={__name:"poll-event",props:{id:Number},setup($){const _=Q(),x=$,e=C("$api"),i=S({average:{},stats:{}});async function h(){const{list:b,average:u}=await e(`poll/stats/event_id/${x.id}`);console.log(i.stats),i.stats=b,i.average=u}L(()=>{h()});const w=N();return I(()=>w.table.t_poll,b=>{_.value.requestServerInteraction(),_.value.clearSelection()},{deep:!0}),(b,u)=>(d(),c("div",le,[(d(!0),c(V,null,F(i.stats,(m,n)=>(d(),c("div",{key:n,class:"card mb-2"},[(d(),v(oe,{key:`poll-${m.description}`,data:m.answers,name:`poll-${m.description}`,title:m.description,subtitle:""},null,8,["data","name","title"]))]))),128))]))}},de={class:"flex justify-between items-end"},ne={class:"flex flex-col"},ce=t("span",{class:"text-lg font-bold text-primary"},"GU\xCDA M\xC9DICA",-1),ue={class:"text-xs text-font"},fe={class:"flex"},pe={key:0,class:"flex flex-col gap-1 mt-1"},me=t("div",{class:"bg-default p-1 rounded-md text-center font-bold text-xs"},"Pendientes",-1),_e={key:0,class:"flex flex-nowrap gap-1 border-b border-default"},be={class:"w-full flex flex-col"},ve={class:"text-xs uppercase pr-4 line-clamp-1"},ge=["innerHTML"],xe={key:0},he=t("hr",null,null,-1),we={class:"card border my-4 rounded-xl overflow-hidden"},ye={key:0},Oe={class:"mt-2 flex justify-center"},Pe={class:"flex items-center gap-3"},$e=["disabled"],Re={class:"text-sm font-medium text-gray-700"},ke=["disabled"],Ee={class:"mb-2 flex justify-center"},Ve={class:"flex items-center gap-3"},De=["disabled"],Ce={class:"text-sm font-medium text-gray-700"},Ie=["disabled"],Ae={class:"border border-dashed w-full"},Te={class:"border border-dashed w-full"},Se={class:"border border-dashed w-full"},Le={class:"border border-dashed w-full"},Ne={class:"border border-dashed w-full"},Fe={__name:"EventMedicalGuide",props:{id:Number,width:String},setup($){const _=$,x=C("$api"),e=S({pendingList:{hasCarnets:{show:!1,text:"Agregar cardnet de asegurado (Foto)",detail:"Se refiere a el tipo de archivo <b>CARN\xC9</b> de los asegurados",color:"black",btnText:"Subir CARN\xC9",fun(){e.uploadCARNEDrawer=!0}},hasProviderLogo:{show:!1,text:"Agregar Foto de Perfil de proveedor (Foto)",detail:"Se refiere a el tipo de archivo <b>PERFIL</b> de el proveedor",color:"black",btnText:"Subir Logo de Proveedor",fun(){e.uploadPROVIDERLOGOrawer=!0}},hasProviderFile:{show:!1,text:"Agregar Foto de centro de proveedor (TIPO CENTRO)",detail:"Se refiere a la foto de <b>CENTRO</b> del proveedor presente en la coordinaci\xF3n",color:"black",btnText:"Subir FOTO CENTRO PROVEEDOR",fun(){e.uploadCENTERPROVIDERDrawer=!0}},hasDoctorsLogo:{show:!1,text:"Agregar imagenes de m\xE9dicos",detail:"Se refiere a la foto de <b>PERFIL</b> de los m\xE9dicos presentes en la coordinaci\xF3n",color:"black"},hasVobs:{show:!1,text:"Agregar VOB (Archivo)",detail:"Tipo de Archivo <b>VOB</b> adjunto en la coordinaci\xF3n presentes en la coordinaci\xF3n",color:"black",btnText:"Subir VOB",fun(){e.uploadVOBDrawer=!0}},hasProviderInfo:{show:!1,text:"Agregar Proveedor",detail:"Se refiere al proveedor principal de la coordinaci\xF3n",color:"black"},hasMap:{show:!1,text:"Agregar Foto de Ubicaci\xF3n Mapa del proveedor",detail:"Tipo de Archivo <b>MAPA</b> adjunto en la <b>PROVEEDOR</b> presente en la coordinaci\xF3n",color:"black",btnText:"Subir FOTO MAPA PROVEEDOR",fun(){e.uploadMAPAPROVIDERrawer=!0}},hasItineraries:{text:"Agregar itinerarios",detail:"Listado de itinerarios correspondientes a la coordinaci\xF3n",color:"black"}},loading:!0,visible:!0,item:{},filename:null,pdfSrc:null,numOfPages:0,currentPage:1}),i=A(()=>Object.values(e.pendingList).some(r=>r.show===!0)),h=A(()=>Object.fromEntries(Object.entries(e.pendingList).filter(([r,o])=>o.show===!0)));function w(){e.loading=!0,e.currentPage<e.numOfPages&&e.currentPage++,e.loading=!1}function b(){e.loading=!0,e.currentPage>1&&e.currentPage--,e.loading=!1}async function u(){e.loading=!0;const{item:r,filename:o,pdfUrl:s,pending_list:R}=await x.get(`report/medical-guide2/${_.id}`);e.item=r,e.filename=o,e.fileUrl=s;const U=await q(s).promise;e.numOfPages=U.numPages,e.currentPage=1;for(const D in R)if(Object.prototype.hasOwnProperty.call(R,D)){const j=R[D];e.pendingList[D]&&(e.pendingList[D].show=!j)}e.loading=!1}L(async()=>{await u()});const m=A(()=>({width:_.width})),n=N();return I(()=>n.table.t_event,r=>{r.id===e.item.id&&u()},{deep:!0}),I(()=>n.table.t_provider,r=>{r.id===e.item.provider_id&&u()},{deep:!0}),(r,o)=>(d(),c(V,null,[t("div",{class:"card no-shadow border overflow-hidden p-4",style:K(m.value)},[t("div",de,[t("div",ne,[ce,t("span",ue,"#"+f(e.item.code),1)]),t("div",fe,[a(P,{flat:"",class:"button mr-2",label:"Descargar",icon:"sym_o_download",onClick:o[0]||(o[0]=s=>M(z)(e.fileUrl,e.item.code))}),a(P,{flat:"",class:"button",label:"cerrar",onClick:o[1]||(o[1]=s=>r.$emit("close"))})])]),i.value?(d(),c("div",pe,[me,(d(!0),c(V,null,F(h.value,(s,R)=>(d(),c("div",{key:R},[s.show?(d(),c("div",_e,[t("div",be,[t("div",ve,f(s.text),1),t("small",{class:"text-xxs uppercase pr-4",innerHTML:s.detail},null,8,ge)]),s.btnText?(d(),c("div",xe,[s.fun?(d(),v(P,{key:0,class:"button mb-1",flat:"",onClick:s.fun},{default:l(()=>[T(f(s.btnText),1)]),_:2},1032,["onClick"])):p("",!0)])):p("",!0),he])):p("",!0)]))),128))])):p("",!0),r.isEdit?(d(),v(P,{key:1,flat:"",class:"button-icon h-[40px] bg-secondary text-white",onClick:o[2]||(o[2]=s=>e.cancelDialog=!0),label:"Cancelar coordinaci\xF3n"},{default:l(()=>[a(B,{class:"bg-default text-black text-xs"},{default:l(()=>[T("Cancelar coordinaci\xF3n")]),_:1})]),_:1})):p("",!0),t("div",we,[e.loading?p("",!0):(d(),c("div",ye,[t("div",Oe,[t("div",Pe,[t("button",{onClick:b,disabled:e.currentPage===1,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25C0 ",8,$e),t("span",Re," Pag. "+f(e.currentPage)+" / "+f(e.numOfPages),1),t("button",{onClick:w,disabled:e.currentPage===e.numOfPages,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25B6 ",8,ke)])]),(d(),v(M(G),{src:e.fileUrl,page:e.currentPage,key:e.currentPage},null,8,["src","page"])),t("div",Ee,[t("div",Ve,[t("button",{onClick:b,disabled:e.currentPage===1,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25C0 ",8,De),t("span",Ce," Pag. "+f(e.currentPage)+" / "+f(e.numOfPages),1),t("button",{onClick:w,disabled:e.currentPage===e.numOfPages,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25B6 ",8,Ie)])])]))])],4),a(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadCARNEDrawer,"onUpdate:modelValue":o[4]||(o[4]=s=>e.uploadCARNEDrawer=s),position:r.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":r.$isDesktop?100:0},{default:l(()=>[a(k,{class:"p-2"},{default:l(()=>[t("div",Ae,[a(y,{class:"py-16 px-24",ref_id:e.item.id,table:"t_event",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir CARN\xC9",file_type:"CARN\xC9",onClose:o[3]||(o[3]=s=>e.uploadCARNEDrawer=!1)},null,8,["ref_id"]),a(O,{refId:e.item.id,refKey:"t_event"},null,8,["refId"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),a(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadPROVIDERLOGOrawer,"onUpdate:modelValue":o[6]||(o[6]=s=>e.uploadPROVIDERLOGOrawer=s),position:r.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":r.$isDesktop?100:0},{default:l(()=>[a(k,{class:"p-2"},{default:l(()=>[t("div",Te,[a(y,{class:"py-16 px-24",ref_id:e.item.provider_id,table:"t_provider",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir FOTO PERFIL PROVEEDOR",file_type:"FOTO PERFIL",onClose:o[5]||(o[5]=s=>e.uploadPROVIDERLOGOrawer=!1)},null,8,["ref_id"]),a(O,{refId:e.item.provider_id,refKey:"t_provider"},null,8,["refId"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),a(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadCENTERPROVIDERDrawer,"onUpdate:modelValue":o[8]||(o[8]=s=>e.uploadCENTERPROVIDERDrawer=s),position:r.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":r.$isDesktop?100:0},{default:l(()=>[a(k,{class:"p-2"},{default:l(()=>[t("div",Se,[a(y,{class:"py-16 px-24",ref_id:e.item.provider_id,table:"t_provider",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir FOTO DE CENTRO PROVEEDOR",file_type:"CENTRO",onClose:o[7]||(o[7]=s=>e.uploadCENTERPROVIDERDrawer=!1)},null,8,["ref_id"]),a(O,{refId:e.item.provider_id,refKey:"t_provider"},null,8,["refId"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),a(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadMAPAPROVIDERrawer,"onUpdate:modelValue":o[10]||(o[10]=s=>e.uploadMAPAPROVIDERrawer=s),position:r.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":r.$isDesktop?100:0},{default:l(()=>[a(k,{class:"p-2"},{default:l(()=>[t("div",Le,[a(y,{class:"py-16 px-24",ref_id:e.item.provider_id,table:"t_provider",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir FOTO MAPA PROVEEDOR",file_type:"MAPA",onClose:o[9]||(o[9]=s=>e.uploadMAPAPROVIDERrawer=!1)},null,8,["ref_id"]),a(O,{refId:e.item.provider_id,refKey:"t_provider"},null,8,["refId"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),a(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadVOBDrawer,"onUpdate:modelValue":o[12]||(o[12]=s=>e.uploadVOBDrawer=s),position:r.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":r.$isDesktop?100:0},{default:l(()=>[a(k,{class:"p-2 flex justify-center items-center"},{default:l(()=>[t("div",Ne,[a(y,{class:"py-16 px-24",ref_id:e.item.id,table:"t_event",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir VOB",file_type:"VOB",onClose:o[11]||(o[11]=s=>e.uploadVOBDrawer=!1)},null,8,["ref_id"]),a(O,{refId:e.item.id,refKey:"t_event"},null,8,["refId"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"])],64))}},Me={class:"flex md:flex-nowrap gap-2 break-all"},Be={class:"w-full md:max-w-[200px] min-w-[200px]"},Ue={key:0,class:"relative"},je={class:"card rounded-md flex flex-col py-2 px-3 mb-1 mt-1"},Qe={class:"font-semibold text-xs"},ze={class:"font-semibold text-xxs"},Ge={class:"grid gap-1 my-1"},Ke={class:"flex items-center justify-between w-full"},qe={class:"flex items-center w-full"},He={class:"ml-4 md:text-md font-bold pt-1.5"},We={class:"w-full overflow-hidden"},Je={class:"card px-3 py-2"},Xe={class:"card px-3 py-2"},Ye={class:"card"},Ze={class:"card px-3 py-2"},et={class:"card px-3 py-2"},tt={class:"flex flex-col w-full md:max-w-[250px] min-w-[250px]"},lt={__name:"event-view",props:{id:String},setup($){H();const _=C("$api"),x=C("$me"),e=$,i=S({loading:!0,timeout:null,tabsList:[{label:"Comentarios",value:"history",icon:"list"}],tabs:[{label:"Editar Coordinaci\xF3n",value:"edit",icon:"fa-duotone fa-solid fa-user-pen",visible:1},{label:"Itinerario",value:"itinerary",icon:"fa-duotone fa-solid fa-calendar-days",visible:1},{label:"Conciliaciones",value:"conciliation",icon:"fa-duotone fa-solid fa-file-lines",visible:(x.unixroles&3,1)},{label:"Gu\xEDa M\xE9dica",value:"medical_guide",icon:"fa-duotone fa-solid fa-file-lines",visible:(x.unixroles&3,1)},{label:"Archivos",value:"file",icon:"fa-duotone fa-solid fa-image",visible:1},{label:"Encuesta",value:"poll",icon:"fa-duotone fa-solid fa-poll-people",visible:1},{label:"Historial",value:"log",icon:"fa-duotone fa-solid fa-clock-rotate-left",visible:1}],tab:"edit",item:{},dialogWrite:!1,dialogPassword:!1});async function h(){i.item=await _.get(`event/${e.id}`),i.loading=!1}async function w(){try{const u=await _.delete(`file/${i.item.profile.id}`,{data:{ref_key:"t_event",ref_id:i.item.id}})}catch(u){console.log(u)}}const b=N();return I(()=>b.table.t_event,u=>{u.id===i.item.id&&h()},{deep:!0}),L(()=>{h()}),(u,m)=>(d(),v(ie,{class:"px-1.5 py-2 lg:px-5 lg:py-6"},{default:l(()=>[t("div",Me,[t("div",Be,[i.item.profile?(d(),c("div",Ue,[a(W,{class:"card w-full max-h-[128px] object-contain",src:i.item.profile.url,"spinner-color":"white"},null,8,["src"]),a(P,{flat:"",class:"absolute top-0 right-0 button-icon bg-primary text-white rounded-md",size:"sm","no-caps":"",onClick:w,icon:"fa-solid fa-xmark"},{default:l(()=>[a(B,{class:"bg-default text-black text-xs"},{default:l(()=>[T("Remover Linea")]),_:1})]),_:1})])):p("",!0),t("div",je,[t("div",Qe,f(i.item.event_state),1),t("div",ze,f(i.item.code),1)]),t("div",Ge,[(d(!0),c(V,null,F(i.tabs,n=>(d(),c(V,{key:n.value},[n.visible?(d(),v(P,{key:0,class:J(["button-tab hover:shadow-left-secondary w-full text-xs",i.tab==n.value&&"shadow-left-secondary bg-primary text-white"]),align:"left",unelevated:"",onClick:r=>i.tab=n.value},{default:l(()=>[t("div",Ke,[t("div",qe,[a(X,{name:n.icon},null,8,["name"]),t("span",He,f(n.label),1)])])]),_:2},1032,["onClick","class"])):p("",!0)],64))),128))])]),t("div",We,[i.loading?p("",!0):(d(),v(Y,{key:0,modelValue:i.tab,"onUpdate:modelValue":m[0]||(m[0]=n=>i.tab=n),class:"bg-transparent"},{default:l(()=>[a(g,{name:"edit",class:"p-0"},{default:l(()=>[t("div",Je,[a(Z,{isEdit:"",id:i.item.id,width:"100%"},null,8,["id"])])]),_:1}),a(g,{name:"medical_guide",class:"p-0"},{default:l(()=>[t("div",Xe,[a(Fe,{isEdit:"",id:i.item.id,width:"100%"},null,8,["id"])])]),_:1}),a(g,{name:"file",class:"p-0"},{default:l(()=>[a(y,{ref_id:i.item.id,table:"t_event",file_type:"GENERAL"},null,8,["ref_id"]),a(O,{refId:i.item.id,refKey:"t_event"},null,8,["refId"])]),_:1}),a(g,{name:"itinerary",class:"p-0"},{default:l(()=>[a(se,{eventId:i.item.id,width:"100%"},null,8,["eventId"])]),_:1}),a(g,{name:"invoice",class:"p-0"},{default:l(()=>[t("div",Ye,[a(ee,{eventId:i.item.id,width:"100%"},null,8,["eventId"])])]),_:1}),a(g,{name:"poll",class:"p-0"},{default:l(()=>[t("div",Ze,[a(re,{id:i.item.id,width:"100%"},null,8,["id"])])]),_:1}),a(g,{name:"log",class:"p-0"},{default:l(()=>[t("div",et,[a(te,{isEdit:"",id:i.item.id,ref_id:i.item.id,width:"100%"},null,8,["id","ref_id"])])]),_:1})]),_:1},8,["modelValue"]))]),t("div",tt,[i.loading?p("",!0):(d(),v(ae,{key:0,refKey:"t_event",refId:i.item.id,comment_state:i.item.event_state,comment_state_id:i.item.$event_state_id},null,8,["refId","comment_state","comment_state_id"]))])])]),_:1}))}};export{lt as default};
