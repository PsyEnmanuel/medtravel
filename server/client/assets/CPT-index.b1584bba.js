import{l as V,m as W,r as B,n as R,a0 as z,$ as N,t as p,G as b,y as o,H as f,v as k,F as u,E as C,z as a,x as n,Q as D,B as w,aQ as T,K as P,R as U,aV as F,D as q,ax as L,q as j,k as A,w as M,A as S,I as G,J as H,C as J,S as K,M as I,L as Q,U as O}from"./index.afe9c2e8.js";const X={class:"flex justify-between items-start gap-2 py-2"},Y={key:0,class:"mb-2"},Z=o("p",{class:"text-2xl text-info"},"Editar CPT",-1),ee={class:"font-bold text-brand"},te=o("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),se={key:1},ae=o("p",{class:"text-2xl text-info"},[q("Agregar "),o("b",{class:"font-bold text-brand"},"CPT")],-1),le=o("p",null,"Los campos requeridos tienen un (*)",-1),oe=[ae,le],ie=o("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),E={__name:"CPTWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(g){const m=V("$api");V("$cats");const r=V("$local"),s=W(),$=B(),c=g,h=()=>({}),i=R({item:h(),local:"WriteCPT"}),y=z(()=>({width:c.width,padding:c.isDrawer&&"6px 8px"}));async function _(){c.isEdit?i.item=await m.get(`CPT/${c.id}`):r.get(i.local)}function l(){i.item=h(),r.remove(i.local),$.value.resetValidation()}async function t(){c.isEdit?await m.put(`CPT/${c.id}`,{...i.item})&&s.notify({type:"success",message:"CPT Editado"}):await m.post("CPT",{...i.item})&&(s.notify({type:"success",message:"CPT Agregado"}),l())}return N(()=>{_()}),(e,d)=>{var v;return p(),b("div",{style:P(y.value)},[o("div",X,[g.isEdit?(p(),b("div",Y,[Z,o("b",ee,f(i.item.description),1),te])):(p(),b("div",se,oe)),g.isDrawer?(p(),k(u,{key:2,flat:"",class:"button",label:"cerrar",onClick:d[0]||(d[0]=x=>e.$emit("close"))})):C("",!0)]),ie,a(F,{class:U((v=g.isDrawer)!=null?v:"pb-64"),ref_key:"writeForm",ref:$,onSubmit:t,onReset:l},{default:n(()=>[a(D,{class:"my-2",dense:"",outlined:"",modelValue:i.item.code,"onUpdate:modelValue":d[1]||(d[1]=x=>i.item.code=x),label:e.$t("code")+"*",rules:[w(T)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),a(D,{class:"my-2",dense:"",outlined:"",modelValue:i.item.description,"onUpdate:modelValue":d[2]||(d[2]=x=>i.item.description=x),label:e.$t("description")+"*",rules:[w(T)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),g.isDrawer?(p(),b("div",{key:0,class:"fixed bottom-0 right-[10px] py-2 bg-white",style:P(y.value)},[c.isEdit?(p(),k(u,{key:0,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"Guardar cambios",type:"submit"})):(p(),k(u,{key:1,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"agregar",type:"submit"}))],4)):C("",!0)]),_:1},8,["class"])],4)}}},ne={class:"flex justify-between md:flex-nowrap"},re={class:"flex flex-nowrap w-full gap-2 mb-1"},de={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},ue={class:"full-width row flex-center text-primary q-gutter-sm"},pe={bordered:"",flat:"",class:"card pb-2 relative flex flex-nowrap"},ce={class:"absolute right-3 top-2"},me={class:"pl-3 pr-8 w-full pt-2 flex flex-col overflow-hidden"},fe={class:"text-uppercase line-clamp-1 font-semibold"},ge={class:"text-uppercase line-clamp-1 text-xxs"},be={class:"flex justify-end gap-2 -mr-5 mt-1"},ye={__name:"CPT-index",setup(g){const{t:m}=L(),r=B(),s=R({dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:code,description",pagination:{sortBy:"code",descending:!1,page:1,rowsPerPage:20},url:"CPT",query:{groupBy:["t_CPT.id"],where:{c_status:4}},columns:[{name:"code",required:!0,label:m("code"),align:"left",field:"code",sortable:!0},{name:"description",required:!0,label:m("name"),align:"left",field:"description",sortable:!0},{name:"description",required:!0,label:m("name"),align:"left",field:"description",sortable:!0,format:(l,t)=>`${t.code} - ${t.description}`}],rows:[]}),{onRequest:$,getSelectedString:c,onDeleteRows:h,addMore:i,itemsRange:y}=j(s,r),_=A();return M(()=>_.table.t_CPT,l=>{r.value.requestServerInteraction(),r.value.clearSelection()},{deep:!0}),(l,t)=>(p(),b(O,null,[a(K,{class:U(l.$isDesktop?l.insuredId?"px-2 py-3":"px-1.5 py-2 lg:px-5 lg:py-6":"px-1.5 py-2")},{default:n(()=>[o("div",ne,[o("div",re,[a(D,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:s.search,"onUpdate:modelValue":t[0]||(t[0]=e=>s.search=e),placeholder:l.$t("search")},{append:n(()=>[a(S,{name:"search"})]),_:1},8,["modelValue","placeholder"]),l.$me.unixroles&7?(p(),k(u,{key:0,flat:"",class:"button h-full",icon:"add",label:l.$isDesktop&&l.$t("add"),onClick:t[1]||(t[1]=e=>s.dialogCreate=!0)},null,8,["label"])):C("",!0)]),l.$isDesktop?(p(),b("div",de,[a(u,{class:"bg-transparent",flat:"","no-caps":""},{default:n(()=>[q(f(w(y).start)+" - "+f(w(y).end)+" de "+f(s.pagination.rowsNumber),1)]),_:1}),a(u,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:t[2]||(t[2]=e=>r.value.firstPage())}),a(u,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:t[3]||(t[3]=e=>r.value.prevPage())}),a(u,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:t[4]||(t[4]=e=>r.value.nextPage())}),a(u,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:t[5]||(t[5]=e=>r.value.lastPage())})])):C("",!0)]),a(G,{grid:!l.$isDesktop,"hide-pagination":"",rows:s.rows,columns:s.columns,"row-key":"id",ref_key:"tableRef",ref:r,onRequest:w($),flat:"",pagination:s.pagination,"onUpdate:pagination":t[6]||(t[6]=e=>s.pagination=e),loading:s.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},H({"no-data":n(({icon:e,message:d,filter:v})=>[o("div",ue,[o("span",null,f(d),1),a(S,{size:"2em",name:v?"filter_b_and_w":e},null,8,["name"])])]),item:n(e=>[o("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:P(e.selected?"transform: scale(0.95);":"")},[o("div",pe,[o("div",ce,[a(J,{dense:"",modelValue:e.selected,"onUpdate:modelValue":d=>e.selected=d,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),o("div",me,[o("span",fe,f(e.row.description),1),o("span",ge,f(e.row.ref),1),o("div",be,[a(u,{flat:"",class:"button-press bg-primary text-white rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:d=>{s.selectedId=e.row.id,s.dialogWrite=!0}},null,8,["onClick"])])])])],4)]),_:2},[l.$isDesktop?void 0:{name:"bottom",fn:n(()=>[a(u,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:w(i)},{default:n(()=>[q("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","rows","columns","onRequest","pagination","loading"])]),_:1},8,["class"]),a(Q,{class:"q-pa-none",modelValue:s.dialogWrite,"onUpdate:modelValue":t[8]||(t[8]=e=>s.dialogWrite=e),position:l.$isDesktop?"right":"standard","full-height":"","full-width":l.$isDesktop,maximized:"","transition-duration":100},{default:n(()=>[a(I,null,{default:n(()=>[a(E,{onClose:t[7]||(t[7]=e=>s.dialogWrite=!1),isDrawer:"",id:s.selectedId,isEdit:"",width:l.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),a(Q,{modelValue:s.dialogCreate,"onUpdate:modelValue":t[10]||(t[10]=e=>s.dialogCreate=e),position:l.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:n(()=>[a(I,null,{default:n(()=>[a(E,{onClose:t[9]||(t[9]=e=>s.dialogCreate=!1),isDrawer:"",width:l.$isDesktop?"400px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"])],64))}};export{ye as default};
