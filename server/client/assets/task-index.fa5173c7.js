import{l as w,m as E,t as f,G as _,y as s,H as i,z as t,x as o,D as b,W as k,K as h,F as c,ar as j,az as L,r as F,n as q,q as M,k as O,w as A,v as D,Q as G,A as I,B as m,E as v,aF as H,I as J,J as K,aC as g,U as X,V as Y,L as y,M as $,bj as S,aH as Z,R as ee,S as te}from"./index.e9245a9e.js";const se={class:"relative"},le={class:"line-clamp-5 font-bold"},ae={class:"line-clamp-2 font-semibold"},oe={class:"flex gap-1"},ie={class:"flex ml-auto gap-1 mt-1"},ne={class:"flex flex-col gap-0.5 bg-gray-100 p-2 rounded-lg text-xxs"},de={class:"line-clamp-1"},re=s("span",{class:"font-semibold"},"Usuario: ",-1),ue={class:"line-clamp-1"},ce=s("span",{class:"font-semibold"},"Creaci\xF3n: ",-1),pe={__name:"TaskCard",props:{item:Object,showOptions:{type:Boolean,default:!1},action:{type:Boolean,default:!1}},setup(r){return w("$cats"),w("$api"),E(),(u,d)=>(f(),_("div",se,[s("div",{class:"rounded-none px-2 py-1 relative card flex flex-col gap-1 flex-nowrap line-clamp-2 text-xs text-left h-full overflow-hidden leading-3 hover:shadow-primary cursor-pointer",onClick:d[1]||(d[1]=j(x=>u.$emit("open",r.item.id),["stop","prevent"]))},[s("div",le,i(r.item.row.user_description),1),s("div",ae,i(r.item.row.description),1),s("div",null,i(r.item.row.detail),1),s("div",oe,[t(k,{class:"bg-default text-black"},{default:o(()=>[b(i(r.item.row.task_section),1)]),_:1}),t(k,{style:h({"background-color":r.item.row.color})},{default:o(()=>[b(i(r.item.row.task_state),1)]),_:1},8,["style"])]),s("div",ie,[t(c,{flat:"",class:"button bg-default text-primary rounded-md",label:"Editar","no-caps":"",onClick:d[0]||(d[0]=x=>u.$emit("selectedId",r.item.row.id))})]),s("div",ne,[s("span",de,[re,b(i(r.item.row.created_by),1)]),s("span",ue,[ce,b(i(r.item.row.created_format),1)])])])]))}},fe={class:"flex justify-between md:flex-nowrap mb-1"},me={class:"flex flex-nowrap w-full gap-2"},ge={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},_e={class:"flex lg:flex-nowrap gap-1 mb-1"},be={class:"flex items-center lg:px-4 border border-dashed"},we={class:"full-width row flex-center text-primary q-gutter-sm"},xe={class:"flex flex-col"},ke={class:"text-xs"},ve={class:"line-clamp-2 text-xxs"},ye={class:"text-xs"},$e={class:"flex flex-nowrap gap-1"},he=s("hr",{class:"mt-1"},null,-1),Ce={class:"text-xxs"},Ve={key:0,class:"flex gap-1"},qe=s("span",null,"Si",-1),De=[qe],Ie={class:"flex gap-2"},Se={class:"flex flex-col text-xs"},Q={__name:"TaskTable",props:{created_by_id:Number,user_id:Number},setup(r){const{t:u}=L(),d=F(),x=w("$cats"),B=w("$me"),C=r,U=q({task_state:x.value.task_state.slice().reverse()}),a=q({dialogImport:!1,dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:description",pagination:{sortBy:"description",descending:!1,page:1,rowsPerPage:20},url:"task",query:{groupBy:["t_task.id"],where:{c_status:4,created_by_id:C.created_by_id,user_id:B.unixroles&4?null:C.user_id,"in:$task_state_id":[329,330]}},columns:[{name:"action",required:!0,label:"",align:"left",field:u("id"),classes:"w-[200px]"},{name:"description",required:!0,label:u("detail"),align:"left",field:"description",sortable:!0},{name:"task_state",required:!0,label:u("task_state"),align:"left",field:"task_state",classes:"w-[120px]",sortable:!0},{name:"user",required:!0,label:u("assigned"),align:"left",field:"user",classes:"w-[150px]",sortable:!0},{name:"created_by",required:!0,label:u("created_by"),align:"left",field:"created_by",classes:"w-[150px]",sortable:!0}],rows:[]}),{onRequest:R,getSelectedString:z,onDeleteRows:W,addMore:N,itemsRange:V}=M(a,d),P=O();return A(()=>P.table.t_task,n=>{d.value.requestServerInteraction(),d.value.clearSelection()},{deep:!0}),(n,l)=>(f(),D(te,{class:ee(n.insuredId?"px-2 py-3":"px-1.5 py-2 lg:px-5 lg:py-6")},{default:o(()=>[s("div",fe,[s("div",me,[t(G,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:a.search,"onUpdate:modelValue":l[0]||(l[0]=e=>a.search=e),placeholder:n.$t("search")},{append:o(()=>[t(I,{name:"search"})]),_:1},8,["modelValue","placeholder"]),t(c,{flat:"",class:"button h-full",icon:"add",label:n.$isDesktop&&n.$t("add"),onClick:l[1]||(l[1]=e=>a.dialogCreate=!0)},null,8,["label"]),a.selected.length?(f(),D(c,{key:0,flat:"",class:"button h-full bg-primary text-white","icon-right":"sym_o_remove",label:n.$isDesktop?"Remover":"","no-caps":"",onClick:m(W)},null,8,["label","onClick"])):v("",!0)]),n.$isDesktop?(f(),_("div",ge,[t(c,{class:"bg-transparent",flat:"","no-caps":""},{default:o(()=>[b(i(m(V).start)+" - "+i(m(V).end)+" de "+i(a.pagination.rowsNumber),1)]),_:1}),t(c,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:l[2]||(l[2]=e=>d.value.firstPage())}),t(c,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:l[3]||(l[3]=e=>d.value.prevPage())}),t(c,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:l[4]||(l[4]=e=>d.value.nextPage())}),t(c,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:l[5]||(l[5]=e=>d.value.lastPage())})])):v("",!0)]),s("div",_e,[s("div",be,[t(H,{class:"flex",size:"xs",options:U.task_state,type:"checkbox",modelValue:a.query.where["in:$task_state_id"],"onUpdate:modelValue":l[6]||(l[6]=e=>a.query.where["in:$task_state_id"]=e)},null,8,["options","modelValue"])])]),t(J,{grid:!n.$isDesktop,"hide-pagination":"",rows:a.rows,columns:a.columns,"row-key":"id",ref_key:"tableRef",ref:d,onRequest:m(R),flat:"",selection:"multiple",pagination:a.pagination,"onUpdate:pagination":l[8]||(l[8]=e=>a.pagination=e),selected:a.selected,"onUpdate:selected":l[9]||(l[9]=e=>a.selected=e),"selected-rows-label":m(z),loading:a.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},K({"no-data":o(({icon:e,message:p,filter:T})=>[s("div",we,[s("span",null,i(p),1),t(I,{size:"2em",name:T?"filter_b_and_w":e},null,8,["name"])])]),"body-cell-description":o(e=>[t(g,{props:e},{default:o(()=>[s("div",xe,[s("div",ke,i(e.row.description),1),s("div",ve,i(e.row.detail),1)])]),_:2},1032,["props"])]),"body-cell-user":o(e=>[t(g,{props:e},{default:o(()=>[(f(!0),_(X,null,Y(e.row.user,p=>(f(),_("div",{key:p.id,class:"flex flex-col"},[s("div",ye,i(p.description),1)]))),128)),t(k,{class:"text-font bg-default text-xxs"},{default:o(()=>[s("div",null,i(e.row.time_passed),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-task_state":o(e=>[t(g,{props:e},{default:o(()=>[s("div",$e,[t(k,{class:"text-font w-2",style:h({background:e.row.color})},null,8,["style"]),s("span",null,i(e.row.task_state),1)]),he,s("div",Ce,i(e.row.task_section),1)]),_:2},1032,["props"])]),"body-cell-sent":o(e=>[t(g,{props:e},{default:o(()=>[e.row.sent?(f(),_("div",Ve,De)):v("",!0)]),_:2},1032,["props"])]),"body-cell-action":o(e=>[t(g,{props:e},{default:o(()=>[s("div",Ie,[t(c,{flat:"",class:"button bg-default text-primary rounded-md",label:"Editar","no-caps":"",onClick:p=>{a.selectedId=e.row.id,a.dialogWrite=!0}},null,8,["onClick"]),t(c,{flat:"",class:"button bg-default text-primary rounded-md",label:"Consultar","no-caps":"",onClick:p=>n.$router.push(`${n.$path.task}/${n.$path.task_consult}/${e.row.id}`)},null,8,["onClick"])])]),_:2},1032,["props"])]),"body-cell-created_by":o(e=>[t(g,{props:e},{default:o(()=>[s("div",Se,[s("span",null,i(e.row.created_format),1),s("span",null,i(e.row.created_by),1)])]),_:2},1032,["props"])]),item:o(e=>[s("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:h(e.selected?"transform: scale(0.95);":"")},[t(pe,{item:e,onSelectedId:l[7]||(l[7]=p=>{a.selectedId=p,a.dialogWrite=!0})},null,8,["item"])],4)]),_:2},[n.$isDesktop?void 0:{name:"bottom",fn:o(()=>[t(c,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:m(N)},{default:o(()=>[b("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","rows","columns","onRequest","pagination","selected","selected-rows-label","loading"]),t(y,{class:"q-pa-none",modelValue:a.dialogWrite,"onUpdate:modelValue":l[11]||(l[11]=e=>a.dialogWrite=e),position:n.$isDesktop?"right":"standard","full-height":"","full-width":n.$isDesktop,maximized:"","transition-duration":100},{default:o(()=>[t($,null,{default:o(()=>[t(S,{onClose:l[10]||(l[10]=e=>a.dialogWrite=!1),isDrawer:"",id:a.selectedId,isEdit:"",width:n.$isDesktop?"1000px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),t(y,{modelValue:a.dialogCreate,"onUpdate:modelValue":l[13]||(l[13]=e=>a.dialogCreate=e),position:n.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:o(()=>[t($,null,{default:o(()=>[t(S,{onClose:l[12]||(l[12]=e=>a.dialogCreate=!1),isDrawer:"",width:n.$isDesktop?"1000px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"]),t(y,{modelValue:a.dialogImport,"onUpdate:modelValue":l[15]||(l[15]=e=>a.dialogImport=e),"full-height":"","full-width":"","transition-duration":100},{default:o(()=>[t($,null,{default:o(()=>[t(Z,{table:"t_task",onClose:l[14]||(l[14]=e=>a.dialogImport=!1)})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["class"]))}},Qe={class:"grid grid-cols-2 gap-2"},Be=s("div",{class:"bg-default p-1 rounded-md text-center font-bold text-xs"},"Solicitudes Asignadas ",-1),Ue=s("div",{class:"bg-default p-1 rounded-md text-center font-bold text-xs"},"Solicitudes Creadas ",-1),ze={__name:"task-index",setup(r){const u=w("$me");return(d,x)=>(f(),_("div",Qe,[s("div",null,[Be,t(Q,{user_id:m(u).id},null,8,["user_id"])]),s("div",null,[Ue,t(Q,{created_by_id:m(u).id},null,8,["created_by_id"])])]))}};export{ze as default};
