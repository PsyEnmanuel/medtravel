import{l as D,m as j,r as z,n as P,a0 as G,$ as U,t as a,G as m,y as s,H as C,v as _,F as p,E as q,z as i,x as w,Q as k,B,aR as A,K as E,aV as H,R as L,aW as M,D as S,k as W,w as K,bo as O,a4 as J,U as I,V as R,A as X,L as F,M as N,S as Y}from"./index.eccc4231.js";import{_ as Z}from"./ChartPoll.2a84ae80.js";const ee={class:"flex flex-nowrap justify-between items-start gap-2 py-2"},te={key:0,class:"mb-2"},se=s("p",{class:"text-2xl text-info"},"Editar Encuesta",-1),le={class:"font-bold text-brand line-clamp-1"},oe=s("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),ie={key:1},ae=s("p",{class:"text-2xl text-info"},[S("Agregar "),s("b",{class:"font-bold text-brand"},"Encuesta")],-1),ne=s("p",null,"Los campos requeridos tienen un (*)",-1),re=[ae,ne],de=s("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),ue={class:"pb-20 pt-2"},ce={key:1},pe={__name:"PollWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(f){const y=D("$api"),c=D("$local"),$=j(),t=z(),n=f,v=()=>({c_status:4}),e=P({loading:!0,item:v(),local:"poll",categories:[]});function x(){e.item=v(),c.remove(e.local),t.value.resetValidation()}async function h(){n.isEdit?await y.put(`poll/${n.id}`,{...e.item})&&$.notify({type:"success",message:"Encuesta Editada"}):await y.post("poll",{...e.item})&&($.notify({type:"success",message:"Encuesta Agregada"}),x())}async function d(){e.loading=!0,n.isEdit?e.item=await y.get(`poll/${n.id}`):c.get(e.local),e.loading=!1}const r=G(()=>({width:n.width,"padding-right":n.isDrawer&&"8px","padding-left":n.isDrawer&&"8px"}));return U(()=>{d()}),(l,g)=>{var V;return e.loading?q("",!0):(a(),m("div",{key:0,style:E(r.value),class:"relative"},[s("div",ee,[f.isEdit?(a(),m("div",te,[se,s("b",le,C(e.item.description),1),oe])):(a(),m("div",ie,re)),f.isDrawer?(a(),_(p,{key:2,flat:"",class:"button",label:"cerrar",onClick:g[0]||(g[0]=o=>l.$emit("close"))})):q("",!0)]),de,s("div",ue,[i(M,{class:L((V=f.isDrawer)!=null?V:"pb-64"),ref_key:"writeForm",ref:t,onSubmit:h,onReset:x},{default:w(()=>[s("div",null,[i(k,{class:"mb-2",dense:"",outlined:"",modelValue:e.item.description,"onUpdate:modelValue":g[1]||(g[1]=o=>e.item.description=o),label:l.$t("description")+"*",rules:[B(A)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),i(k,{class:"mb-2",dense:"",outlined:"",modelValue:e.item.note,"onUpdate:modelValue":g[2]||(g[2]=o=>e.item.note=o),label:l.$t("note")+"*",type:"textarea",rows:3},null,8,["modelValue","label"])]),f.isDrawer?(a(),m("div",{key:0,class:"fixed bottom-0 right-0 py-2 bg-white",style:E(r.value)},[i(H,{item:e.item,isEdit:f.isEdit},null,8,["item","isEdit"]),n.isEdit?(a(),_(p,{key:0,class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"Guardar cambios",type:"submit"})):(a(),_(p,{key:1,class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"agregar",type:"submit"}))],4)):(a(),m("div",ce,[n.isEdit?(a(),_(p,{key:0,class:"button-press w-full text-lg rounded-md",flat:"",label:"Guardar cambios",type:"submit"})):(a(),_(p,{key:1,class:"button-press w-full text-lg rounded-md",flat:"",label:"agregar",type:"submit"}))]))]),_:1},8,["class"])])],4))}}},me={class:"flex justify-between items-start flex-nowrap gap-2 py-2"},fe={class:"mb-2"},ge=s("p",{class:"text-2xl text-info"},"Editar Pregunta",-1),be={class:"font-bold text-brand"},ye={class:"mt-2"},we={class:"flex flex-nowrap gap-2 items-start mt-2"},$e={class:"flex flex-nowrap gap-2 items-start mb-2 p-1"},xe={class:"w-[20px]"},_e={class:"card px-1 w-full"},ve={class:"w-full text-xs"},he={class:"flex justify-end flex-nowrap h-auto"},ke={__name:"QuestionWrite",props:{id:Number,width:String,isDrawer:Boolean},setup(f){const y=j(),c=D("$api"),$=W(),t=z(),n=f,v=()=>({description:null}),e=P({loading:!0,items:[],item:v(),total:0,selected:{},search:""});K(()=>$.t_poll,()=>{x()});async function x(){try{e.item=await c.get(`poll-question/${n.id}`);const o=await c.get("poll-answer",{params:{order:{description:"ASC"},where:{poll_question_id:n.id,c_status:4}}});console.log(o),e.items=o.items,e.total=o.total,e.loading=!1}catch(o){console.log(o)}}function h(){e.item=v(),t.value.resetValidation()}async function d(){try{await c.post("poll-question",e.item)&&y.notify({type:"success",message:"Categor\xEDa Agregada"}),x(),h()}catch(o){console.log(o)}}async function r(o){try{const u=await c.delete(`poll-answer/${o.id}`,o);x(),u&&y.notify({type:"success",message:"Respuesta removida"})}catch(u){console.log(u)}}async function l(o){try{await c.put(`poll-answer/${o.id}`,o)&&y.notify({type:"success",message:"Respuesta editada"})}catch(u){console.log(u)}}async function g(){try{await c.delete(`poll-question/${n.id}`)}catch(o){console.log(o)}}const V=G(()=>({width:n.width,"padding-right":n.isDrawer&&"8px","padding-left":n.isDrawer&&"8px"}));return U(()=>{x()}),(o,u)=>e.loading?q("",!0):(a(),m("div",{key:0,style:E(V.value),class:"pb-32"},[s("div",me,[s("div",fe,[ge,s("b",be,C(e.item.description),1)]),f.isDrawer?(a(),_(p,{key:0,flat:"",class:"button",label:"cerrar",onClick:u[0]||(u[0]=b=>o.$emit("close"))})):q("",!0)]),i(M,{ref_key:"writeForm",ref:t,onSubmit:d,onReset:h},{default:w(()=>[s("div",ye,[i(k,{class:"mb-2",dense:"",outlined:"",modelValue:e.item.description,"onUpdate:modelValue":u[1]||(u[1]=b=>e.item.description=b),label:o.$t("question"),"hide-bottom-space":"",rules:[B(A)],type:"textarea",rows:4},null,8,["modelValue","label","rules"]),i(O,{"model-value":e.item.poll_type,refKey:"poll_type",onSetCategory:u[2]||(u[2]=b=>e.item.$poll_type_id=b),onClearCategory:u[3]||(u[3]=b=>e.item.$poll_type_id=null)},null,8,["model-value"]),s("div",we,[i(p,{flat:"",class:"button-press w-full bg-default text-primary text-sm font-bold tracking-normal mb-2",type:"submit"},{default:w(()=>[S(" GUARDAR CAMBIOS ")]),_:1}),i(p,{class:"button-icon bg-primary text-white py-0",icon:"fa-solid fa-xmark",rounded:"",onClick:g,size:"sm"},{default:w(()=>[i(J,{class:"bg-default text-black",size:"xs"},{default:w(()=>[S("Remover")]),_:1})]),_:1})])])]),_:1},512),(a(!0),m(I,null,R(e.items,(b,T)=>(a(),m("div",{key:b.id},[s("div",$e,[s("div",xe,[s("div",_e,C(T+1),1)]),s("div",ve,[i(k,{class:"w-full",dense:"",outlined:"",modelValue:b.description,"onUpdate:modelValue":Q=>b.description=Q,label:o.$t("description"),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","label"])]),s("div",he,[i(p,{class:"bg-default text-primary mr-2","text-color":"font",size:"xs",flat:"",icon:"sym_o_edit_note",onClick:Q=>l(b)},null,8,["onClick"]),i(p,{class:"bg-default text-primary","text-color":"font",size:"xs",flat:"",icon:"sym_o_remove",onClick:Q=>r(b)},null,8,["onClick"])])])]))),128))],4))}},Ve={class:"grid lg:grid-cols-2 gap-4"},De=s("div",{class:"subtitle py-1"},"Agregar Pregunta",-1),Ce={class:"card px-1 mr-1"},qe={class:"text-xs"},Se={__name:"poll-view",props:{id:Number},setup(f){const y=z(),c=f,$=D("$api"),t=P({diaglogPoll:!1,selectedPollId:null,diaglogQuestion:!1,selectedQuestionId:null,item:{},drawer:!1,question:{},stats:{},questions:[]});async function n(){t.item=await $(`poll/${c.id}`)}async function v(){t.stats=await $("poll/stats",{params:{where:{c_status:4},returnItems:!0}}),console.log(t.stats)}async function e(){t.questions=await $("poll-question",{params:{where:{c_status:4,poll_id:c.id},returnItems:!0}})}async function x(){console.log(12),await $.post("poll-question",{poll_id:c.id,...t.question})}U(()=>{n(),e(),v()});const h=W();return K(()=>h.table.t_poll,d=>{y.value.requestServerInteraction(),y.value.clearSelection()},{deep:!0}),(d,r)=>(a(),_(Y,{class:L(d.$isDesktop?d.insuredId?"px-2 py-3":"px-1.5 py-2 lg:px-5 lg:py-6":"px-1.5 py-2")},{default:w(()=>[s("div",Ve,[s("div",null,[i(p,{flat:"",class:"button-press bg-primary text-white rounded-md",size:"sm",label:t.item.description,"no-caps":"",onClick:r[0]||(r[0]=l=>t.diaglogPoll=!0)},null,8,["label"]),De,i(k,{class:"w-full border-none",dense:"",outlined:"",modelValue:t.question.description,"onUpdate:modelValue":r[1]||(r[1]=l=>t.question.description=l),label:d.$t("question"),rules:[B(A)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),i(p,{flat:"",class:"button-press bg-primary text-white rounded-md my-2 w-full",size:"sm",label:d.$t("save"),"no-caps":"",onClick:x},null,8,["label"]),(a(!0),m(I,null,R(t.questions,l=>(a(),m("div",{key:l.id,class:"flex items-start flex-nowrap gap-1 mb-2 bg-neutral-100 p-2 rounded-md"},[s("div",Ce,[i(X,{name:"fa-duotone fa-solid fa-question"})]),s("span",qe,C(l.description),1),i(p,{flat:"",class:"button-press bg-primary text-white rounded-md ml-auto",size:"sm",label:d.$t("edit"),"no-caps":"",onClick:g=>{t.selectedQuestionId=l.id,t.diaglogQuestion=!0}},null,8,["label","onClick"])]))),128))]),(a(!0),m(I,null,R(t.stats,(l,g)=>(a(),m("div",{key:g,class:"card mb-2"},[(a(),_(Z,{key:`poll-${l.description}`,data:l.answers,name:`poll-${l.description}`,title:l.description,subtitle:""},null,8,["data","name","title"]))]))),128)),i(F,{class:"q-pa-none left-0","no-refocus":"",modelValue:t.diaglogQuestion,"onUpdate:modelValue":r[3]||(r[3]=l=>t.diaglogQuestion=l),position:d.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":d.$isDesktop?100:0},{default:w(()=>[i(N,null,{default:w(()=>[i(ke,{onClose:r[2]||(r[2]=l=>t.diaglogQuestion=!1),isDrawer:"",id:t.selectedQuestionId,isEdit:"",width:d.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),i(F,{class:"q-pa-none left-0","no-refocus":"",modelValue:t.diaglogPoll,"onUpdate:modelValue":r[5]||(r[5]=l=>t.diaglogPoll=l),position:d.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":d.$isDesktop?100:0},{default:w(()=>[i(N,null,{default:w(()=>[i(pe,{onClose:r[4]||(r[4]=l=>t.diaglogPoll=!1),isDrawer:"",id:c.id,isEdit:"",width:d.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","transition-duration"])])]),_:1},8,["class"]))}};export{Se as default};
