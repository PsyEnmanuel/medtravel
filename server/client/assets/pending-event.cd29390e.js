import{l as V,az as R,r as W,n as D,q as A,k as T,w as I,t as u,v as g,x as s,y as o,z as a,Q as L,A as x,B as c,C as z,D as v,E as y,G as _,F as d,H as i,aT as j,al as F,ao as G,I as O,J as H,aC as p,T as J,U as S,aD as K,aU as X,W as Q,K as C,ah as Y,V as Z,bi as ee,L as b,M as w,ac as k,ax as te,S as le}from"./index.29778d79.js";const ae={class:"flex justify-between md:flex-nowrap mb-2"},se={class:"flex flex-nowrap w-full gap-2"},oe={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},ne={class:"grid lg:grid-cols-4 gap-1 mb-1"},ie={class:"full-width row flex-center text-primary q-gutter-sm"},re=["src"],de={class:"grid grid-cols-2 gap-1"},ue={class:"flex flex-col text-xs"},pe={class:"flex flex-col text-xs gap-1"},fe={class:"flex flex-nowrap items-center gap-2"},me={key:0},ce={class:"flex flex-col text-xs"},_e={key:0,class:"flex flex-col text-xs"},ge={class:"flex flex-nowrap border-b border-default"},ve={class:"flex flex-col text-xs"},ye={class:"flex flex-col text-xs"},be={class:"flex items-end text-xxs leading-none"},ke={__name:"pending-event",props:{insuredId:Number,doctorId:Number,providerId:Number},setup(P){const $=V("$cats"),U=V("$me"),{t:m}=R(),f=W(),B=D({event_state:$.value.event_state.filter(n=>n.id!==40),event_type:$.value.event_type}),l=D({itinerary:[],eventSelected:null,itineraryDialog:!1,dialogCopy:!1,dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:t_event.code,user_description,insured,t_event.provider_description,contact_description,t_event.created_by,MRN",pagination:{sortBy:"t_event.event_state",descending:!1,page:1,rowsPerPage:20},url:"event/alert-list",table:"t_event",query:{join:[{table:"t_itinerary",relationA:"t_itinerary.event_id",relationB:"t_event.id"}],groupBy:["t_event.id"],where:{"t_event.c_status":4,"t_itinerary.c_status":4,["in:$event_state_id"]:[30,31,32,37,38,39]}},visibleColumns:[],columns:[{name:"action",required:!0,label:"",align:"left",field:m("id"),classes:"min-w-[200px]"},{name:"user_description",required:!0,label:"Asignado a",align:"left",field:"user_description",sortable:!0},{name:"insured",required:!0,label:m("insured"),align:"left",field:"insured",sortable:!0},{name:"provider_description",required:!0,label:"Proveedor/Contacto",align:"left",field:"provider_description",sortable:!0},{name:"doctor_description",required:!0,label:"M\xE9dico",align:"left",field:"doctor_description",sortable:!0},{name:"event_state",required:!0,label:m("event_state"),align:"left",field:"event_state",sortable:!0},{name:"request_date",required:!0,label:m("request_date"),align:"left",field:"request_date_format",sortable:!0},{name:"last_attendance_datetime",required:!0,label:m("last_attendance_datetime"),align:"left",field:"last_attendance_datetime_format",sortable:!0},{name:"pending_list",label:m("pending_list"),align:"left",field:"pending_list",sortable:!0,hidden:!0}],rows:[]}),{onRequest:N,getSelectedString:we,onDeleteRows:xe,addMore:E,itemsRange:h}=A(l,f),M=T();return I(()=>M.table.t_event,n=>{f.value.requestServerInteraction(),f.value.clearSelection()},{deep:!0}),I(()=>l.query.where["t_event.c_status"],n=>{console.log(n),n===2?l.visibleColumns=l.columns.filter(t=>t.name==="reason_cancellation"&&!t.required).map(t=>t.name):l.visibleColumns=[]}),(n,t)=>(u(),g(le,{class:"px-1.5 py-2 lg:px-5 lg:py-6"},{default:s(()=>[o("div",ae,[o("div",se,[a(L,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:l.search,"onUpdate:modelValue":t[0]||(t[0]=e=>l.search=e),placeholder:n.$t("search")},{append:s(()=>[a(x,{name:"search"})]),_:1},8,["modelValue","placeholder"]),c(U).high_profile?(u(),g(z,{key:0,size:"xs",class:"border border-dashed px-4 h-[40px] text-xs",modelValue:l.query.where.high_profile,"onUpdate:modelValue":t[1]||(t[1]=e=>l.query.where.high_profile=e),"true-value":1,"false-value":null},{default:s(()=>[v("Alto perfil")]),_:1},8,["modelValue"])):y("",!0),a(z,{size:"xs",class:"border border-dashed px-4 h-[40px] text-xs",modelValue:l.query.where.pregnant,"onUpdate:modelValue":t[2]||(t[2]=e=>l.query.where.pregnant=e),"true-value":1,"false-value":null},{default:s(()=>[v("Maternidad")]),_:1},8,["modelValue"])]),n.$isDesktop?(u(),_("div",oe,[a(d,{class:"bg-transparent",flat:"","no-caps":""},{default:s(()=>[v(i(c(h).start)+" - "+i(c(h).end)+" de "+i(l.pagination.rowsNumber),1)]),_:1}),a(d,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:t[3]||(t[3]=e=>f.value.firstPage())}),a(d,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:t[4]||(t[4]=e=>f.value.prevPage())}),a(d,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:t[5]||(t[5]=e=>f.value.nextPage())}),a(d,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:t[6]||(t[6]=e=>f.value.lastPage())})])):y("",!0)]),o("div",null,[a(j,{class:"flex text-xs",size:"sm",modelValue:l.query.where["in:$event_state_id"],"onUpdate:modelValue":t[7]||(t[7]=e=>l.query.where["in:$event_state_id"]=e),"toggle-color":"secondary","toggle-text-color":"text-font",options:B.event_state,type:"checkbox"},null,8,["modelValue","options"])]),o("div",ne,[a(F,{onSetUser:t[8]||(t[8]=e=>l.query.where.user_id=e),onClearUser:t[9]||(t[9]=e=>l.query.where.user_id=null),"model-value":l.user_description,label:"Coordinador",unixroles:24},null,8,["model-value"]),a(G,{class:"w-full",onSetProvider:t[10]||(t[10]=e=>l.query.where["t_event.provider_id"]=e),onClearProvider:t[11]||(t[11]=e=>l.query.where["t_event.provider_id"]=null),"model-value":l.provider_description},null,8,["model-value"])]),a(O,{grid:!n.$isDesktop,"hide-pagination":"",rows:l.rows,columns:l.columns,"row-key":"id",ref_key:"tableRef",ref:f,onRequest:c(N),flat:"",pagination:l.pagination,"onUpdate:pagination":t[15]||(t[15]=e=>l.pagination=e),loading:l.loading,"rows-per-page-label":"Lineas","wrap-cells":!0,visibleColumns:l.visibleColumns},H({"no-data":s(({icon:e,message:r,filter:q})=>[o("div",ie,[o("span",null,i(r),1),a(x,{size:"2em",name:q?"filter_b_and_w":e},null,8,["name"])])]),"body-cell-avatar":s(e=>[a(p,{props:e},{default:s(()=>[a(J,{rounded:"",size:"42px"},{default:s(()=>[o("img",{src:n.$imageInsuredPlaceholder(e.value)},null,8,re)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-action":s(e=>[a(p,{props:e},{default:s(()=>[o("div",de,[a(d,{flat:"",class:"button text-primary rounded-md",size:"sm",label:"consultar","no-caps":"",onClick:r=>n.$router.push(`${n.$path.event}/${n.$path.event_consult}/${e.row.id}`)},null,8,["onClick"]),a(d,{flat:"",class:"button text-primary rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:r=>{l.selectedId=e.row.id,l.dialogWrite=!0}},null,8,["onClick"]),a(d,{flat:"",class:"button text-primary rounded-md",size:"sm",label:"Itinerario","no-caps":"",onClick:r=>{l.eventSelected=e.row,l.itineraryDialog=!0}},null,8,["onClick"]),e.row.book_code?(u(),g(d,{key:0,flat:"",class:"button bg-secondary text-white rounded-md",size:"sm",label:"Coinciliada","no-caps":"",to:`/conciliaciones/editar/${e.row.book_code}`},null,8,["to"])):(u(),_(S,{key:1},[e.row.policy_id?(u(),g(d,{key:0,flat:"",class:"button text-primary rounded-md",size:"sm",label:"Coinciliar","no-caps":"",to:`/conciliaciones/crear?eventId=${e.row.id}`},null,8,["to"])):(u(),g(d,{key:1,flat:"",class:"button text-primary rounded-md",size:"sm",label:"Coinciliar*","no-caps":""},{default:s(()=>[a(K,{"transition-show":"flip-up","transition-hide":"flip-down"},{default:s(()=>[a(X,null,{avatar:s(()=>[a(x,{name:"fa-duotone fa-solid fa-triangle-exclamation"})]),default:s(()=>[v(" La cita debe tener una p\xF3liza para conciliar ")]),_:1})]),_:1})]),_:1}))],64))])]),_:2},1032,["props"])]),"body-cell-user_description":s(e=>[a(p,{props:e},{default:s(()=>[o("div",ue,[o("span",null,"#"+i(e.row.code),1),o("span",null,i(e.row.event_type),1),o("span",null,i(e.row.user_description),1)])]),_:2},1032,["props"])]),"body-cell-request_date":s(e=>[a(p,{props:e},{default:s(()=>[o("span",null,i(e.row.request_date_format),1)]),_:2},1032,["props"])]),"body-cell-event_state":s(e=>[a(p,{props:e},{default:s(()=>[o("div",pe,[o("div",fe,[a(Q,{class:"text-font w-4",style:C({background:e.row.color})},null,8,["style"]),o("span",null,i(e.row.event_state),1)]),e.row.event_state_time?(u(),_("span",me,i(c(Y)(e.row.event_state_time[e.row.$event_state_id],"EEE dd MMM yyyy hh:mm:ss")),1)):y("",!0)])]),_:2},1032,["props"])]),"body-cell-provider_description":s(e=>[a(p,{props:e},{default:s(()=>[o("div",ce,[o("span",null,"P: "+i(e.row.provider_description),1),o("span",null,"C: "+i(e.row.contact_description),1)])]),_:2},1032,["props"])]),"body-cell-doctor_description":s(e=>[a(p,{props:e},{default:s(()=>[e.row.doctor_description?(u(),_("div",_e,[(u(!0),_(S,null,Z(e.row.doctor_description,(r,q)=>(u(),_("div",{key:r},[o("span",ge,i(r),1)]))),128))])):y("",!0)]),_:2},1032,["props"])]),"body-cell-created_by":s(e=>[a(p,{props:e},{default:s(()=>[o("div",ve,[o("span",null,i(e.row.created_format),1),o("span",null,i(e.row.created_by),1)])]),_:2},1032,["props"])]),"body-cell-last_attendance_datetime":s(e=>[a(p,{props:e},{default:s(()=>[o("div",ye,[o("span",null,i(e.row.last_attendance_datetime_format),1),o("div",be,[a(Q,{class:"text-font bg-default text-xxs w-4 h-2 mr-1",style:C({background:e.row.time_passed_color})},null,8,["style"]),o("span",null,i(e.row.time_passed_format),1)])])]),_:2},1032,["props"])]),item:s(e=>[o("div",{class:"q-py-xs col-xs-12",style:C(e.selected?"transform: scale(0.95);":"")},[a(ee,{item:e.row,onSelected:t[12]||(t[12]=r=>{l.selectedId=r,l.dialogWrite=!0}),onOpenItinerary:t[13]||(t[13]=r=>{l.eventSelected=r,l.itineraryDialog=!0}),onCopy:t[14]||(t[14]=r=>{l.selectedId=r,l.dialogCopy=!0})},null,8,["item"])],4)]),_:2},[n.$isDesktop?void 0:{name:"bottom",fn:s(()=>[a(d,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:c(E)},{default:s(()=>[v("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","rows","columns","onRequest","pagination","loading","visibleColumns"]),a(b,{class:"q-pa-none",modelValue:l.dialogWrite,"onUpdate:modelValue":t[17]||(t[17]=e=>l.dialogWrite=e),position:n.$isDesktop?"right":"standard","full-height":"","full-width":n.$isDesktop,maximized:"","transition-duration":100},{default:s(()=>[a(w,null,{default:s(()=>[a(k,{onClose:t[16]||(t[16]=e=>l.dialogWrite=!1),isDrawer:"",id:l.selectedId,isEdit:"",width:(n.$isDesktop,"100%")},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),a(b,{modelValue:l.dialogCreate,"onUpdate:modelValue":t[19]||(t[19]=e=>l.dialogCreate=e),position:n.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:s(()=>[a(w,null,{default:s(()=>[a(k,{onClose:t[18]||(t[18]=e=>l.dialogCreate=!1),isDrawer:"",width:(n.$isDesktop,"100%"),insuredId:P.insuredId},null,8,["width","insuredId"])]),_:1})]),_:1},8,["modelValue","position"]),a(b,{modelValue:l.dialogCopy,"onUpdate:modelValue":t[21]||(t[21]=e=>l.dialogCopy=e),position:n.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:s(()=>[a(w,null,{default:s(()=>[a(k,{onClose:t[20]||(t[20]=e=>l.dialogCopy=!1),isDrawer:"",width:(n.$isDesktop,"100%"),copyId:l.selectedId},null,8,["width","copyId"])]),_:1})]),_:1},8,["modelValue","position"]),a(b,{modelValue:l.itineraryDialog,"onUpdate:modelValue":t[23]||(t[23]=e=>l.itineraryDialog=e),"full-height":"",maximized:""},{default:s(()=>[a(w,{class:"shadow pt-4 lg:px-6 pb-4 flex-col w-[400px]"},{default:s(()=>[a(te,{isEdit:"",id:l.eventSelected.id,isDrawer:"",onClose:t[22]||(t[22]=e=>l.itineraryDialog=!1),displayAdd:""},null,8,["id"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ke as default};
