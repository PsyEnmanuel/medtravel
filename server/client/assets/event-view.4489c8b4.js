import{r as B,l as D,n as V,$ as C,k as T,w as S,t as r,G as c,U as $,V as F,v as m,a0 as M,y as t,H as f,z as l,B as N,a1 as Q,F as P,a2 as G,a3 as q,x as n,D as I,E as p,a4 as U,a5 as z,K as H,M as O,a6 as y,a7 as j,L as E,a8 as K,m as W,a9 as J,R as X,A as Y,aa as Z,ab as v,ac as ee,ad as te,ae,af as le,S as ie}from"./index.eccc4231.js";import{_ as se}from"./ChartPoll.2a84ae80.js";import oe from"./itinerary-index.201c6f1c.js";const ne={class:"grid lg:grid-cols-2 gap-4"},re={__name:"poll-event",props:{id:Number},setup(R){const _=B(),x=R,e=D("$api"),i=V({average:{},stats:{}});async function b(){const{list:g,average:u}=await e(`poll/stats/event_id/${x.id}`);console.log(i.stats),i.stats=g,i.average=u}C(()=>{b()});const h=T();return S(()=>h.table.t_poll,g=>{_.value.requestServerInteraction(),_.value.clearSelection()},{deep:!0}),(g,u)=>(r(),c("div",ne,[(r(!0),c($,null,F(i.stats,(o,a)=>(r(),c("div",{key:a,class:"card mb-2"},[(r(),m(se,{key:`poll-${o.description}`,data:o.answers,name:`poll-${o.description}`,title:o.description,subtitle:""},null,8,["data","name","title"]))]))),128))]))}},de={class:"flex justify-between items-end"},ce={class:"flex flex-col"},ue=t("span",{class:"text-lg font-bold text-primary"},"GU\xCDA M\xC9DICA",-1),fe={class:"text-xs text-font"},pe={class:"flex"},_e={class:"flex flex-col gap-1 mt-1"},me=t("div",{class:"bg-default p-1 rounded-md text-center font-bold text-xs"},"Pendientes",-1),be={key:0,class:"flex flex-nowrap gap-1 border-b border-default"},ge={class:"w-full flex flex-col"},ve={class:"text-xs uppercase pr-4 line-clamp-1"},xe=["innerHTML"],he={key:0},we=t("hr",null,null,-1),ye={class:"card border my-4 rounded-xl overflow-hidden"},Pe={key:0},Re={class:"mt-2 flex justify-center"},Oe={class:"flex items-center gap-3"},Ee=["disabled"],$e={class:"text-sm font-medium text-gray-700"},Ae=["disabled"],ke={class:"mb-2 flex justify-center"},De={class:"flex items-center gap-3"},Ie=["disabled"],Ve={class:"text-sm font-medium text-gray-700"},Ce=["disabled"],Te={class:"border border-dashed w-full"},Se={class:"border border-dashed w-full"},Fe={class:"border border-dashed w-full"},Le={class:"border border-dashed w-full"},Me={class:"border border-dashed w-full"},Ne={__name:"EventMedicalGuide",props:{id:Number,width:String},setup(R){const _=R,x=D("$api"),e=V({pendingList:{hasCarnets:{show:!1,text:"Agregar cardnet de asegurado (Foto)",detail:"Se refiere a el tipo de archivo <b>CARN\xC9</b> de los asegurados",color:"black",btnText:"Subir CARN\xC9",fun(){e.uploadCARNEDrawer=!0}},hasDoctors:{show:!1,text:"Agregar imagenes de m\xE9dicos",detail:"Se refiere a la foto de <b>PERFIL</b> de los m\xE9dicos presentes en la coordinaci\xF3n",color:"black"},hasVob:{show:!1,text:"Agregar PRECERTIFICACI\xD3N (Archivo)",detail:"Tipo de Archivo <b>PRECERTIFICACI\xD3N</b> adjunto en la coordinaci\xF3n presentes en la coordinaci\xF3n",color:"black",btnText:"Subir PRECERTIFICACI\xD3N",fun(){e.uploadVOBDrawer=!0}},hasProviderInfo:{show:!1,text:"Agregar Proveedor",detail:"Se refiere al proveedor principal de la coordinaci\xF3n",color:"black"},hasMap:{show:!1,text:"Agregar Foto de Ubicaci\xF3n Mapa del proveedor",detail:"Tipo de Archivo <b>MAPA</b> adjunto en la <b>PROVEEDOR</b> presente en la coordinaci\xF3n",color:"black",btnText:"Subir FOTO MAPA PROVEEDOR",fun(){e.uploadMAPAPROVIDERrawer=!0}},hasItineraries:{text:"Agregar itinerarios",detail:"Listado de itinerarios correspondientes a la coordinaci\xF3n",color:"black"}},loading:!0,visible:!0,item:{},filename:null,pdfSrc:null,numOfPages:0,currentPage:1});function i(){e.loading=!0,e.currentPage<e.numOfPages&&e.currentPage++,e.loading=!1}function b(){e.loading=!0,e.currentPage>1&&e.currentPage--,e.loading=!1}async function h(){e.loading=!0;const{item:o,filename:a,pdfUrl:s,pending_list:d}=await x.get(`report/medical-guide2/${_.id}`);e.item=o,e.filename=a,e.fileUrl=s;const k=await K(s).promise;e.numOfPages=k.numPages,e.currentPage=1;for(const w in d)if(Object.prototype.hasOwnProperty.call(d,w)){const L=d[w];console.log(L,w,e.pendingList[w],e.pendingList),!L&&e.pendingList[w]&&(e.pendingList[w].show=!0)}e.loading=!1}C(async()=>{await h()}),M(()=>{var a,s,d,A,k;const o=[];return e.item._files&&((a=e.item)!=null&&a._files.provider||o.push({text:"Agregar Foto de perfil de proveedor",detail:"Se refiere a la foto de <b>PERFIL</b> del proveedor presente en la coordinaci\xF3n",color:"black",btnText:"Subir FOTO PERFIL PROVEEDOR",fun(){e.uploadPROFILEPROVIDERDrawer=!0}}),(s=e.item)!=null&&s.provider.file||o.push({text:"Agregar Foto de centro de proveedor (TIPO GU\xCDA M\xC9DICA)",detail:"Se refiere a la foto de <b>CENTRO</b> del proveedor presente en la coordinaci\xF3n",color:"black",btnText:"Subir FOTO CENTRO PROVEEDOR",fun(){e.uploadcentroPROVIDERDrawer=!0}}),(d=e.item)!=null&&d.provider.mapa||o.push({text:"Agregar Foto de Ubicaci\xF3n Mapa del proveedor",detail:"Tipo de Archivo <b>MAPA</b> adjunto en la <b>PROVEEDOR</b> presente en la coordinaci\xF3n",color:"black",btnText:"Subir FOTO MAPA PROVEEDOR",fun(){e.uploadMAPAPROVIDERrawer=!0}}),(k=(A=e.item)==null?void 0:A.itineraries)!=null&&k.length||o.push({text:"Agregar itinerarios",detail:"Listado de itinerarios correspondientes a la coordinaci\xF3n",color:"black"})),o});const g=M(()=>({width:_.width})),u=T();return S(()=>u.table.t_event,o=>{o.id===e.item.id&&h()},{deep:!0}),(o,a)=>(r(),c($,null,[t("div",{class:"card no-shadow border overflow-hidden p-4",style:H(g.value)},[t("div",de,[t("div",ce,[ue,t("span",fe,"#"+f(e.item.code),1)]),t("div",pe,[l(P,{flat:"",class:"button mr-2",label:"Descargar",icon:"sym_o_download",onClick:a[0]||(a[0]=s=>N(Q)(e.fileUrl,e.item.code))}),l(P,{flat:"",class:"button",label:"cerrar",onClick:a[1]||(a[1]=s=>o.$emit("close"))})])]),G(t("div",_e,[me,(r(!0),c($,null,F(Object.entries(e.pendingList),([s,d],A)=>(r(),c("div",{key:s},[d.show?(r(),c("div",be,[t("div",ge,[t("div",ve,f(d.text),1),t("small",{class:"text-xxs uppercase pr-4",innerHTML:d.detail},null,8,xe)]),d.btnText?(r(),c("div",he,[d.fun?(r(),m(P,{key:0,class:"button mb-1",flat:"",onClick:d.fun},{default:n(()=>[I(f(d.btnText),1)]),_:2},1032,["onClick"])):p("",!0)])):p("",!0),we])):p("",!0)]))),128))],512),[[q,Object.entries(e.pendingList).some(([s,d])=>d.show)]]),o.isEdit?(r(),m(P,{key:0,flat:"",class:"button-icon h-[40px] bg-secondary text-white",onClick:a[2]||(a[2]=s=>e.cancelDialog=!0),label:"Cancelar coordinaci\xF3n"},{default:n(()=>[l(U,{class:"bg-default text-black text-xs"},{default:n(()=>[I("Cancelar coordinaci\xF3n")]),_:1})]),_:1})):p("",!0),t("div",ye,[e.loading?p("",!0):(r(),c("div",Pe,[t("div",Re,[t("div",Oe,[t("button",{onClick:b,disabled:e.currentPage===1,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25C0 ",8,Ee),t("span",$e," Pag. "+f(e.currentPage)+" / "+f(e.numOfPages),1),t("button",{onClick:i,disabled:e.currentPage===e.numOfPages,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25B6 ",8,Ae)])]),(r(),m(N(z),{src:e.fileUrl,page:e.currentPage,key:e.currentPage},null,8,["src","page"])),t("div",ke,[t("div",De,[t("button",{onClick:b,disabled:e.currentPage===1,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25C0 ",8,Ie),t("span",Ve," Pag. "+f(e.currentPage)+" / "+f(e.numOfPages),1),t("button",{onClick:i,disabled:e.currentPage===e.numOfPages,class:"p-2 rounded-full bg-gray-200 hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition"}," \u25B6 ",8,Ce)])])]))])],4),l(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadCARNEDrawer,"onUpdate:modelValue":a[4]||(a[4]=s=>e.uploadCARNEDrawer=s),position:o.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":o.$isDesktop?100:0},{default:n(()=>[l(O,{class:"p-2"},{default:n(()=>[t("div",Te,[l(y,{class:"py-16 px-24",ref_id:e.item.id,table:"t_event",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir CARN\xC9",file_type:"CARN\xC9",onClose:a[3]||(a[3]=s=>e.uploadCARNEDrawer=!1)},null,8,["ref_id"]),l(j,{refId:e.item.id,refKey:"t_event"},null,8,["refId"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),l(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadcentroPROVIDERDrawer,"onUpdate:modelValue":a[6]||(a[6]=s=>e.uploadcentroPROVIDERDrawer=s)},{default:n(()=>[l(O,{class:"p-2 flex justify-center items-center"},{default:n(()=>[t("div",Se,[l(y,{class:"py-16 px-24",ref_id:e.item.provider_id,table:"t_provider",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir FOTO DE CENTRO PROVEEDOR",file_type:"GU\xCDA M\xC9DICA",onClose:a[5]||(a[5]=s=>e.uploadcentroPROVIDERDrawer=!1)},null,8,["ref_id"])])]),_:1})]),_:1},8,["modelValue"]),l(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadPROFILEPROVIDERDrawer,"onUpdate:modelValue":a[8]||(a[8]=s=>e.uploadPROFILEPROVIDERDrawer=s),position:o.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":o.$isDesktop?100:0},{default:n(()=>[l(O,null,{default:n(()=>[t("div",Fe,[l(y,{class:"py-16 px-24",ref_id:e.item.provider_id,table:"t_provider",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir FOTO PERFIL PROVEEDOR",file_type:"FOTO PERFIL",onClose:a[7]||(a[7]=s=>e.uploadPROFILEPROVIDERDrawer=!1)},null,8,["ref_id"])])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),l(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadMAPAPROVIDERrawer,"onUpdate:modelValue":a[10]||(a[10]=s=>e.uploadMAPAPROVIDERrawer=s)},{default:n(()=>[l(O,{class:"p-2 flex justify-center items-center"},{default:n(()=>[t("div",Le,[l(y,{class:"py-16 px-24",ref_id:e.item.provider_id,table:"t_provider",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir FOTO MAPA PROVEEDOR",file_type:"MAPA",onClose:a[9]||(a[9]=s=>e.uploadMAPAPROVIDERrawer=!1)},null,8,["ref_id"])])]),_:1})]),_:1},8,["modelValue"]),l(E,{class:"q-pa-none left-0","no-refocus":"",modelValue:e.uploadVOBDrawer,"onUpdate:modelValue":a[12]||(a[12]=s=>e.uploadVOBDrawer=s)},{default:n(()=>[l(O,{class:"p-2 flex justify-center items-center"},{default:n(()=>[t("div",Me,[l(y,{class:"py-16 px-24",ref_id:e.item.id,table:"t_event",icon:"fa-duotone fa-solid fa-camera-retro",avaliable_file_text:!1,text:"Subir VOB",file_type:"VOB",onClose:a[11]||(a[11]=s=>e.uploadVOBDrawer=!1)},null,8,["ref_id"])])]),_:1})]),_:1},8,["modelValue"])],64))}},Ue={class:"flex md:flex-nowrap gap-2 break-all"},je={class:"w-full md:max-w-[200px] min-w-[200px]"},Be={key:0,class:"relative"},Qe={class:"card rounded-md flex flex-col py-2 px-3 mb-1 mt-1"},Ge={class:"font-semibold text-xs"},qe={class:"font-semibold text-xxs"},ze={class:"grid gap-1 my-1"},He={class:"flex items-center justify-between w-full"},Ke={class:"flex items-center w-full"},We={class:"ml-4 md:text-md font-bold pt-1.5"},Je={class:"w-full overflow-hidden"},Xe={class:"card px-3 py-2"},Ye={class:"card px-3 py-2"},Ze={class:"card"},et={class:"card px-3 py-2"},tt={class:"card px-3 py-2"},at={class:"flex flex-col w-full md:max-w-[250px] min-w-[250px]"},ot={__name:"event-view",props:{id:String},setup(R){W();const _=D("$api"),x=D("$me"),e=R,i=V({loading:!0,timeout:null,tabsList:[{label:"Comentarios",value:"history",icon:"list"}],tabs:[{label:"Editar Coordinaci\xF3n",value:"edit",icon:"fa-duotone fa-solid fa-user-pen",visible:1},{label:"Itinerario",value:"itinerary",icon:"fa-duotone fa-solid fa-calendar-days",visible:1},{label:"Conciliaciones",value:"conciliation",icon:"fa-duotone fa-solid fa-file-lines",visible:(x.unixroles&3,1)},{label:"Gu\xEDa M\xE9dica",value:"medical_guide",icon:"fa-duotone fa-solid fa-file-lines",visible:(x.unixroles&3,1)},{label:"Archivos",value:"file",icon:"fa-duotone fa-solid fa-image",visible:1},{label:"Encuesta",value:"poll",icon:"fa-duotone fa-solid fa-poll-people",visible:1},{label:"Historial",value:"log",icon:"fa-duotone fa-solid fa-clock-rotate-left",visible:1}],tab:"edit",item:{},dialogWrite:!1,dialogPassword:!1});async function b(){i.item=await _.get(`event/${e.id}`),i.loading=!1}async function h(){try{const u=await _.delete(`file/${i.item.profile.id}`,{data:{ref_key:"t_event",ref_id:i.item.id}})}catch(u){console.log(u)}}const g=T();return S(()=>g.table.t_event,u=>{u.id===i.item.id&&b()},{deep:!0}),C(()=>{b()}),(u,o)=>(r(),m(ie,{class:"px-1.5 py-2 lg:px-5 lg:py-6"},{default:n(()=>[t("div",Ue,[t("div",je,[i.item.profile?(r(),c("div",Be,[l(J,{class:"card w-full max-h-[128px] object-contain",src:i.item.profile.url,"spinner-color":"white"},null,8,["src"]),l(P,{flat:"",class:"absolute top-0 right-0 button-icon bg-primary text-white rounded-md",size:"sm","no-caps":"",onClick:h,icon:"fa-solid fa-xmark"},{default:n(()=>[l(U,{class:"bg-default text-black text-xs"},{default:n(()=>[I("Remover Linea")]),_:1})]),_:1})])):p("",!0),t("div",Qe,[t("div",Ge,f(i.item.event_state),1),t("div",qe,f(i.item.code),1)]),t("div",ze,[(r(!0),c($,null,F(i.tabs,a=>(r(),c($,{key:a.value},[a.visible?(r(),m(P,{key:0,class:X(["button-tab hover:shadow-left-secondary w-full text-xs",i.tab==a.value&&"shadow-left-secondary bg-primary text-white"]),align:"left",unelevated:"",onClick:s=>i.tab=a.value},{default:n(()=>[t("div",He,[t("div",Ke,[l(Y,{name:a.icon},null,8,["name"]),t("span",We,f(a.label),1)])])]),_:2},1032,["onClick","class"])):p("",!0)],64))),128))])]),t("div",Je,[i.loading?p("",!0):(r(),m(Z,{key:0,modelValue:i.tab,"onUpdate:modelValue":o[0]||(o[0]=a=>i.tab=a),class:"bg-transparent"},{default:n(()=>[l(v,{name:"edit",class:"p-0"},{default:n(()=>[t("div",Xe,[l(ee,{isEdit:"",id:i.item.id,width:"100%"},null,8,["id"])])]),_:1}),l(v,{name:"medical_guide",class:"p-0"},{default:n(()=>[t("div",Ye,[l(Ne,{isEdit:"",id:i.item.id,width:"100%"},null,8,["id"])])]),_:1}),l(v,{name:"file",class:"p-0"},{default:n(()=>[l(y,{ref_id:i.item.id,table:"t_event",file_type:"GENERAL"},null,8,["ref_id"]),l(j,{refId:i.item.id,refKey:"t_event"},null,8,["refId"])]),_:1}),l(v,{name:"itinerary",class:"p-0"},{default:n(()=>[l(oe,{eventId:i.item.id,width:"100%"},null,8,["eventId"])]),_:1}),l(v,{name:"invoice",class:"p-0"},{default:n(()=>[t("div",Ze,[l(te,{eventId:i.item.id,width:"100%"},null,8,["eventId"])])]),_:1}),l(v,{name:"poll",class:"p-0"},{default:n(()=>[t("div",et,[l(re,{id:i.item.id,width:"100%"},null,8,["id"])])]),_:1}),l(v,{name:"log",class:"p-0"},{default:n(()=>[t("div",tt,[l(ae,{isEdit:"",id:i.item.id,ref_id:i.item.id,width:"100%"},null,8,["id","ref_id"])])]),_:1})]),_:1},8,["modelValue"]))]),t("div",at,[i.loading?p("",!0):(r(),m(le,{key:0,refKey:"t_event",refId:i.item.id,comment_state:i.item.event_state,comment_state_id:i.item.$event_state_id},null,8,["refId","comment_state","comment_state_id"]))])])]),_:1}))}};export{ot as default};
