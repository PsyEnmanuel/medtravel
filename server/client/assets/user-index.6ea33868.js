import{l as U,m as B,r as P,n as z,a3 as W,$ as E,t as g,G as x,y as o,D as _,H as u,z as s,x as n,Q as S,B as p,aS as L,F as i,aW as N,K as Q,az as F,q as j,k as T,w as A,A as D,v as y,E as k,I as M,J as G,aC as q,W as H,C as J,R as K,S as O,M as C,a_ as I,L as h,U as X}from"./index.09b51acc.js";const Y={class:"mb-2"},Z={class:"text-2xl text-info"},ee={class:"font-bold text-brand"},ae=o("p",null,"Los campos requeridos tienen un (*)",-1),te=o("div",{class:"subtitle mt-2"},"Pasos a seguir para cambiar la contrase\xF1a:",-1),se=o("ul",null,[o("li",null,"Esta contrase\xF1a es temporal"),o("li",null,"Al iniciar sesi\xF3n se debe ingresar la contrase\xF1a temporal"),o("li",null,"Luego le redireccionara a una nueva vista para cambiar la contrase\xF1a por una mas segura"),o("li",null,"Le pedira que escriba la nueva contrase\xF1a seguro"),o("li",null,"Al acceder nuevamente al sistema necesitara acceder con la contrase\xF1a segura")],-1),le={class:"flex justify-end"},oe={__name:"ChangePassword",props:{id:Number,width:String,isDrawer:Boolean},setup(V){const c=U("$api"),d=B(),a=P(),f=V,b=()=>({roles:[]}),m=z({item:b()});async function $(){m.item=await c.get(`user/${f.id}`)}function w(){m.item=b(),a.value.resetValidation()}async function v(){await c.put(`user/new-password-code/${f.id}`,m.item)&&d.notify({type:"success",message:"Contrase\xF1a Editada"})}const t=W(()=>({width:f.width,padding:f.isDrawer&&"6px 8px"}));return E(()=>{$()}),(l,e)=>(g(),x("div",{style:Q(t.value)},[o("div",Y,[o("p",Z,[_("Cambiar contrase\xF1a, "),o("b",ee,u(m.item.description),1)]),ae]),s(N,{ref_key:"writeForm",ref:a,onSubmit:v,onReset:w},{default:n(()=>[s(S,{class:"mb-2",dense:"",outlined:"",modelValue:m.item.password_token,"onUpdate:modelValue":e[0]||(e[0]=r=>m.item.password_token=r),label:l.$t("password_token")+"*",rules:[p(L)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),te,se,o("div",le,[s(i,{class:"button-press",flat:"",label:"cambiar contrase\xF1a",type:"submit"})])]),_:1},512)],4))}},ne={class:"flex justify-between md:flex-nowrap"},ie={class:"flex flex-nowrap w-full gap-2 mb-1"},re={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},de={class:"full-width row flex-center text-primary q-gutter-sm"},ue={class:"flex gap-2"},ce={bordered:"",flat:"",class:"card pb-2 relative flex flex-nowrap"},me={class:"absolute right-3 top-2"},pe={class:"pl-3 pr-8 w-full pt-2 flex flex-col overflow-hidden"},fe={class:"text-uppercase line-clamp-1 font-semibold"},ge={class:"text-uppercase line-clamp-1 text-xxs"},be={class:"text-uppercase line-clamp-1 text-xxs"},we={class:"flex justify-end gap-2 -mr-5 mt-1"},_e={__name:"user-index",setup(V){const{t:c}=F(),d=P(),a=z({dialogChangePassword:!1,dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:description",pagination:{sortBy:"description",descending:!1,page:1,rowsPerPage:20},url:"user",query:{groupBy:["t_user.id"],where:{c_status:4,"ne:id":1}},columns:[{name:"action",required:!0,label:"",align:"left",field:t=>t.id,format:t=>`${t}`,classes:"w-[220px]"},{name:"description",required:!0,label:c("name"),align:"left",field:t=>t.description,sortable:!0},{name:"username",required:!0,label:c("username"),align:"left",field:t=>t.username,sortable:!0},{name:"email",required:!0,label:c("email"),align:"left",field:t=>t.email,sortable:!0},{name:"password_token",required:!0,label:c("password_token"),align:"left",field:t=>t.password_token,sortable:!0},{name:"roles",required:!0,label:c("role"),align:"left",field:"roles_format",sortable:!0}],rows:[]}),{onRequest:f,getSelectedString:b,onDeleteRows:m,addMore:$,itemsRange:w}=j(a,d),v=T();return A(()=>v.table.t_user,t=>{d.value.requestServerInteraction(),d.value.clearSelection()},{deep:!0}),(t,l)=>(g(),x(X,null,[s(O,{class:K(t.$isDesktop?t.insuredId?"px-2 py-3":"px-1.5 py-2 lg:px-5 lg:py-6":"px-1.5 py-2")},{default:n(()=>[o("div",ne,[o("div",ie,[s(S,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:a.search,"onUpdate:modelValue":l[0]||(l[0]=e=>a.search=e),placeholder:t.$t("search")},{append:n(()=>[s(D,{name:"search"})]),_:1},8,["modelValue","placeholder"]),s(i,{flat:"",class:"button h-full",icon:"add",label:t.$isDesktop&&t.$t("add"),onClick:l[1]||(l[1]=e=>a.dialogCreate=!0)},null,8,["label"]),a.selected.length?(g(),y(i,{key:0,flat:"",class:"button h-full bg-primary text-white","icon-right":"sym_o_remove",label:t.$isDesktop?"Remover":"","no-caps":"",onClick:p(m)},null,8,["label","onClick"])):k("",!0)]),t.$isDesktop?(g(),x("div",re,[s(i,{class:"bg-transparent",flat:"","no-caps":""},{default:n(()=>[_(u(p(w).start)+" - "+u(p(w).end)+" de "+u(a.pagination.rowsNumber),1)]),_:1}),s(i,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:l[2]||(l[2]=e=>d.value.firstPage())}),s(i,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:l[3]||(l[3]=e=>d.value.prevPage())}),s(i,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:l[4]||(l[4]=e=>d.value.nextPage())}),s(i,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:l[5]||(l[5]=e=>d.value.lastPage())})])):k("",!0)]),s(M,{grid:!t.$isDesktop,"hide-pagination":"",rows:a.rows,columns:a.columns,"row-key":"id",ref_key:"tableRef",ref:d,onRequest:p(f),flat:"",selection:"multiple",pagination:a.pagination,"onUpdate:pagination":l[6]||(l[6]=e=>a.pagination=e),selected:a.selected,"onUpdate:selected":l[7]||(l[7]=e=>a.selected=e),"selected-rows-label":p(b),loading:a.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},G({"no-data":n(({icon:e,message:r,filter:R})=>[o("div",de,[o("span",null,u(r),1),s(D,{size:"2em",name:R?"filter_b_and_w":e},null,8,["name"])])]),"body-cell-password_token":n(e=>[s(q,{props:e},{default:n(()=>[s(H,{class:"text-font",color:"default"},{default:n(()=>{var r;return[_(u((r=e.row.password_token)!=null?r:"Contrase\xF1a cambiada"),1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-action":n(e=>[s(q,{props:e},{default:n(()=>[o("div",ue,[s(i,{flat:"",class:"button bg-default text-primary rounded-md",label:"consultar","no-caps":"",size:"sm",to:`${t.$path.user}/${t.$path.user_consult}/${e.row.id}`},null,8,["to"]),s(i,{flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:r=>{a.selectedId=e.row.id,a.dialogWrite=!0}},null,8,["onClick"]),t.$me.unixroles&3?(g(),y(i,{key:0,flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"Cambiar contrase\xF1a","no-caps":"",onClick:r=>{a.selectedId=e.row.id,a.dialogChangePassword=!0}},null,8,["onClick"])):k("",!0)])]),_:2},1032,["props"])]),item:n(e=>[o("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:Q(e.selected?"transform: scale(0.95);":"")},[o("div",ce,[o("div",me,[s(J,{dense:"",modelValue:e.selected,"onUpdate:modelValue":r=>e.selected=r,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),o("div",pe,[o("span",fe,u(e.row.description),1),o("span",ge,u(e.row.roles_format),1),o("span",be,u(e.row.email),1),o("div",we,[s(i,{flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"consultar","no-caps":"",onClick:r=>{a.selectedId=e.row.id,a.dialogWrite=!0}},null,8,["onClick"]),s(i,{flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:r=>{a.selectedId=e.row.id,a.dialogWrite=!0}},null,8,["onClick"]),t.$me.unixroles&3?(g(),y(i,{key:0,flat:"",class:"button bg-default text-primary rounded-md",size:"sm",label:"contrase\xF1a","no-caps":"",onClick:r=>{a.selectedId=e.row.id,a.dialogChangePassword=!0}},null,8,["onClick"])):k("",!0)])])])],4)]),_:2},[t.$isDesktop?void 0:{name:"bottom",fn:n(()=>[s(i,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:p($)},{default:n(()=>[_("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","rows","columns","onRequest","pagination","selected","selected-rows-label","loading"])]),_:1},8,["class"]),s(h,{class:"q-pa-none",modelValue:a.dialogWrite,"onUpdate:modelValue":l[9]||(l[9]=e=>a.dialogWrite=e),position:t.$isDesktop?"right":"standard","full-height":"","full-width":t.$isDesktop,maximized:"","transition-duration":100},{default:n(()=>[s(C,null,{default:n(()=>[s(I,{onClose:l[8]||(l[8]=e=>a.dialogWrite=!1),isDrawer:"",id:a.selectedId,isEdit:"",width:t.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),s(h,{modelValue:a.dialogCreate,"onUpdate:modelValue":l[11]||(l[11]=e=>a.dialogCreate=e),position:t.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:n(()=>[s(C,null,{default:n(()=>[s(I,{onClose:l[10]||(l[10]=e=>a.dialogCreate=!1),isDrawer:"",width:t.$isDesktop?"400px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"]),s(h,{modelValue:a.dialogChangePassword,"onUpdate:modelValue":l[13]||(l[13]=e=>a.dialogChangePassword=e),position:t.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:n(()=>[s(C,null,{default:n(()=>[s(oe,{onClose:l[12]||(l[12]=e=>a.dialogChangePassword=!1),isDrawer:"",id:a.selectedId,isEdit:"",width:t.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position"])],64))}};export{_e as default};
