import{az as me,m as se,r as L,l as ee,n as te,a3 as C,w as _e,$ as le,t as r,G as E,z as s,x as c,aK as pe,U as K,V as oe,v as b,aC as fe,Q as x,A as be,b2 as ye,b3 as ve,ao as $e,am as Ue,b4 as D,B as d,b5 as Ie,b6 as Ee,b7 as A,y as l,F as q,b8 as S,b9 as T,D as I,H as h,ba as ge,I as xe,bb as V,bc as M,ah as De,bd as Re,be as Ce,E as Z,W as z,a7 as Ae,ac as Pe,bf as de,aS as j,_ as Se,aT as ue,ar as ie,aF as re,ap as Te,a5 as ce,bg as qe,aW as Oe,M as Qe,ab as Be,L as Me,K as Ge,bh as Ne,a4 as ze}from"./index.1c9c82ce.js";const Fe={class:"w-full"},Ye={key:3,class:"flex flex-nowrap w-auto"},Ke={class:"flex flex-col ml-1"},We={__name:"ReconciliationItems",props:{items:Array,isEdit:Boolean},emits:["setItems"],setup(W,{emit:w}){const{t:m}=me();se();const F=L(),O=ee("$api"),Y=W,$=w,U=te({timeout:null,timeoutRow:null,columns:[{name:"date",label:"FEcha",field:"date",align:"left",classes:"min-w-[150px]"},{name:"provider",label:"Proveedor",field:"provider",align:"left",classes:"min-w-[250px]"},{name:"item_description",label:"CPT",field:"item_description",align:"left",classes:"min-w-[250px]"},{name:"billed_amount",label:m("MONTO FACTURADO"),field:"billed_amount",align:"left",classes:"min-w-[100px]"},{name:"discount",label:m("DESCUENTO DE AJUSTE"),field:"discount",align:"left",classes:"min-w-[100px]"},{name:"coverage",label:m("MONTO A PROCESAR"),field:"coverage",align:"left",classes:"min-w-[100px]"},{name:"deductible",label:m("DEDUCIBLE / COPAGO"),field:"deductible",align:"left",classes:"min-w-[100px]"},{name:"covered",label:m("CUBIERTO"),field:"covered",align:"left",classes:"min-w-[100px]"},{name:"insurance_payment",label:m("PAGO DE ASEGURADA"),field:"insurance_payment",align:"left",classes:"min-w-[100px]"},{name:"insurance_responsability",label:m("RESP. ASEGURADA"),field:"insurance_responsability",align:"left",classes:"min-w-[100px]"},{name:"insurance_claim",label:m("insurance_claim"),field:"insurance_claim",align:"left",classes:"min-w-[100px]"},{name:"note",label:m("NOTA"),field:"note",align:"left",classes:"min-w-[100px]"}],rows:[]}),G=C(()=>U.rows.filter(i=>i.c_status&4));_e(()=>U.rows,i=>{clearTimeout(U.timeout),U.timeout=setTimeout(()=>{$("setItems",U.rows)},300)},{deep:!0});const e=L([]),R=i=>{e.value[i]&&e.value[i].hide()};function B(i){i.quantity?i.quantity=parseInt(i.quantity)+1:i.quantity=1}function N(i){parseInt(i.quantity)>1&&(i.quantity=parseInt(i.quantity)-1)}function y(i){const v=V(i.billed_amount||0),a=V(i.discount||0);i.coverage=M(v-a)}function Q(i){const v=V(i.coverage||0),a=V(i.deductible||0);v&&a&&(i.covered=v-a)}async function _(i,v){try{const a=await O.get(`provider/${i}`);v.provider_id=String(a.id),v.provider_description=a.description}catch(a){console.log(a)}}function k(i){try{i.provider_id=null,i.provider_description=null}catch(v){console.log(v)}}function f(i){const v=V(i.insurance_payment||0),a=V(i.deductible||0);i.insurance_responsability=v-a}async function H(i,v){try{const a=await O.get(`CPT/${i}`);v.item_description=a.description,v.item_id=a.id,v.item_code=a.code}catch(a){console.log(a)}}async function ne(i){try{if(Y.isEdit){i.c_status=1;return}i.item_id=null,i.item_description=null,i.item_code=null,i.billed_amount=null,i.discount=null,i.coverage=null,i.deductible=null,i.covered=null,i.insurance_payment=null,i.insurance_responsability=null,i.insurance_claim=null,i.note=null}catch(v){console.log(v)}}const J=()=>({c_status:4,item_description:null,quantity:1,reset:0,billed_amount:null,coverage:null,deductible:null,covered:null,insurance_payment:null,insurance_responsability:null,insurance_claim:null,note:null});function ae(){U.rows.push(J())}return le(()=>{U.rows=Y.items.concat(Array.from({length:5},()=>J()))}),(i,v)=>(r(),E("div",Fe,[s(xe,{"hide-pagination":"","rows-per-page-options":[0],rows:G.value,columns:U.columns,"row-key":"id",ref_key:"tableRef",ref:F,onRequest:i.onRequest,flat:"",loading:U.loading,"wrap-cells":!0},{body:c(a=>[s(pe,{props:a},{default:c(()=>[(r(!0),E(K,null,oe(a.cols,g=>(r(),b(fe,{class:"text-xxs",key:g.name,props:a},{default:c(()=>[g.name==="date"?(r(),b(x,{key:0,dense:"",outlined:"",modelValue:a.row.book_date,"onUpdate:modelValue":o=>a.row.book_date=o,mask:"##-##-####",label:i.$t("date"),rules:[i.requiredInput],"hide-bottom-space":""},{append:c(()=>[s(be,{name:"event",class:"cursor-pointer"},{default:c(()=>[s(ye,{ref_for:!0,ref:"popupRefs"},{default:c(()=>[s(ve,{flat:"",modelValue:a.row.book_date,"onUpdate:modelValue":[o=>a.row.book_date=o,o=>R(a.rowIndex)],"no-unset":"","years-in-month-view":"",minimal:"",mask:"DD-MM-YYYY"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):g.name==="provider"?(r(),b($e,{key:1,onSetProvider:o=>_(o,a.row),onClearProvider:o=>k(a.row),"model-value":a.row.provider_description,id:a.row.provider_id},null,8,["onSetProvider","onClearProvider","model-value","id"])):g.name==="item_description"?(r(),b(Ue,{key:2,onSetProcedure:o=>H(o,a.row),onClearInsured:o=>ne(a.row),"model-value":a.row.item_description,id:a.row.item_id},null,8,["onSetProcedure","onClearInsured","model-value","id"])):g.name==="quantity"?(r(),E("div",Ye,[D(s(x,{modelValue:a.row.quantity,"onUpdate:modelValue":o=>a.row.quantity=o,dense:"",outlined:"",class:"w-[50px]","data-maska":d(Ie),"data-maska-tokens":d(Ee)},null,8,["modelValue","onUpdate:modelValue","data-maska","data-maska-tokens"]),[[d(A)]]),l("div",Ke,[s(q,{flat:"",class:"button bg-primary-light px-2 py-0.5 h-fit mb-0.5",size:"xs",icon:"add",onClick:o=>B(a.row)},null,8,["onClick"]),s(q,{flat:"",class:"button bg-danger-light px-2 py-0.5 h-fit",size:"xs",rounded:"",icon:"remove",onClick:o=>N(a.row)},null,8,["onClick"])])])):g.name==="billed_amount"?D((r(),b(x,{key:4,readonly:!a.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:a.row.billed_amount,"onUpdate:modelValue":[o=>a.row.billed_amount=o,o=>y(a.row)],"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="discount"?D((r(),b(x,{key:5,readonly:!a.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:a.row.discount,"onUpdate:modelValue":[o=>a.row.discount=o,o=>y(a.row)],"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="coverage"?D((r(),b(x,{key:6,readonly:!a.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:a.row.coverage,"onUpdate:modelValue":[o=>a.row.coverage=o,o=>Q(a.row)],"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="deductible"?D((r(),b(x,{key:7,readonly:!a.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:a.row.deductible,"onUpdate:modelValue":[o=>a.row.deductible=o,o=>{Q(a.row),f(a.row)}],"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="covered"?D((r(),b(x,{key:8,readonly:!a.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:a.row.covered,"onUpdate:modelValue":o=>a.row.covered=o,"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="insurance_payment"?D((r(),b(x,{key:9,readonly:!a.row.item_id,"input-class":"text-right",dense:"",outlined:"",modelValue:a.row.insurance_payment,"onUpdate:modelValue":[o=>a.row.insurance_payment=o,o=>f(a.row)],"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="insurance_responsability"?D((r(),b(x,{key:10,readonly:"","input-class":"text-right",dense:"",outlined:"",modelValue:a.row.insurance_responsability,"onUpdate:modelValue":o=>a.row.insurance_responsability=o,"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):g.name==="insurance_claim"?(r(),b(x,{key:11,readonly:!a.row.item_id,dense:"",outlined:"",modelValue:a.row.insurance_claim,"onUpdate:modelValue":o=>a.row.insurance_claim=o,"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue"])):g.name==="note"?(r(),b(x,{key:12,readonly:!a.row.item_id,dense:"",outlined:"",modelValue:a.row.note,"onUpdate:modelValue":o=>a.row.note=o,"hide-bottom-space":""},null,8,["readonly","modelValue","onUpdate:modelValue"])):(r(),E(K,{key:13},[I(h(g.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":c(({icon:a,message:g,filter:o})=>[s(ge,{icon:a,message:g,filter:o},null,8,["icon","message","filter"])]),bottom:c(()=>[s(q,{flat:"",class:"button bg-primary-light w-full mt-2","no-caps":"",onClick:ae},{default:c(()=>[I("Agregar m\xE1s lineas")]),_:1})]),_:1},8,["rows","columns","onRequest","loading"])]))}},je={class:"w-full"},Le=l("div",{class:"subtitle text-xs text-center"},"Pagos",-1),He={__name:"ReconciliatioPayment",props:{items:Array,isEdit:Boolean},emits:["setItems"],setup(W,{emit:w}){const{t:m}=me();se();const F=L();ee("$api");const O=W,Y=w,$=te({timeout:null,timeoutRow:null,columns:[{name:"date",label:"Fecha",field:"date",align:"left",classes:"min-w-[150px]"},{name:"description",label:m("DESC."),field:"description",align:"left",classes:"min-w-[100px]"},{name:"note",label:m("NOTA"),field:"note",align:"left",classes:"min-w-[100px]"},{name:"insurance_payment",label:m("PAGO DE ASEGURADA"),field:"insurance_payment",align:"left",classes:"min-w-[100px]"},{name:"insurance_responsability",label:m("RESP. ASEGURADA"),field:"insurance_responsability",align:"left",classes:"min-w-[100px]"}],rows:[]}),U=C(()=>$.rows.filter(y=>y.c_status&4));_e(()=>$.rows,y=>{clearTimeout($.timeout),$.timeout=setTimeout(()=>{Y("setItems",$.rows)},300)},{deep:!0});const G=L([]),e=y=>{G.value[y]&&G.value[y].hide()};function R(y){const Q=V(y.insurance_payment||0),_=V(y.deductible||0);y.insurance_responsability=Q-_}const B=()=>({book_date:De(new Date,"dd-MM-yyyy"),c_status:4,quantity:1,reset:0,insurance_payment:null,insurance_responsability:null,note:null});function N(){$.rows.push(B())}return le(()=>{$.rows=O.items.concat(Array.from({length:2},()=>B()))}),(y,Q)=>(r(),E("div",je,[Le,s(xe,{"hide-pagination":"","rows-per-page-options":[0],rows:U.value,columns:$.columns,"row-key":"id",ref_key:"tableRef",ref:F,onRequest:y.onRequest,flat:"",loading:$.loading,"wrap-cells":!0},{body:c(_=>[s(pe,{props:_},{default:c(()=>[(r(!0),E(K,null,oe(_.cols,k=>(r(),b(fe,{class:"text-xxs",key:k.name,props:_},{default:c(()=>[k.name==="date"?(r(),b(x,{key:0,dense:"",outlined:"",modelValue:_.row.book_date,"onUpdate:modelValue":f=>_.row.book_date=f,mask:"##-##-####",label:y.$t("date"),rules:[y.requiredInput],"hide-bottom-space":""},{append:c(()=>[s(be,{name:"event",class:"cursor-pointer"},{default:c(()=>[s(ye,{ref_for:!0,ref:"popupRefs"},{default:c(()=>[s(ve,{flat:"",modelValue:_.row.book_date,"onUpdate:modelValue":[f=>_.row.book_date=f,f=>e(_.rowIndex)],"no-unset":"","years-in-month-view":"",minimal:"",mask:"DD-MM-YYYY"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):k.name==="description"?(r(),b(x,{key:1,dense:"",outlined:"",modelValue:_.row.description,"onUpdate:modelValue":f=>_.row.description=f,"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue"])):k.name==="note"?(r(),b(x,{key:2,dense:"",outlined:"",modelValue:_.row.note,"onUpdate:modelValue":f=>_.row.note=f,"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue"])):k.name==="insurance_payment"?D((r(),b(x,{key:3,"input-class":"text-right",dense:"",outlined:"",modelValue:_.row.insurance_payment,"onUpdate:modelValue":[f=>_.row.insurance_payment=f,f=>R(_.row)],"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):k.name==="insurance_responsability"?D((r(),b(x,{key:4,"input-class":"text-right",dense:"",outlined:"",modelValue:_.row.insurance_responsability,"onUpdate:modelValue":f=>_.row.insurance_responsability=f,"data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","data-maska-tokens"])),[[d(A),void 0,d(T)]]):(r(),E(K,{key:5},[I(h(k.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":c(({icon:_,message:k,filter:f})=>[s(ge,{icon:_,message:k,filter:f},null,8,["icon","message","filter"])]),bottom:c(()=>[s(q,{flat:"",class:"button bg-primary-light w-full mt-2","no-caps":"",onClick:N},{default:c(()=>[I("Agregar m\xE1s lineas")]),_:1})]),_:1},8,["rows","columns","onRequest","loading"])]))}},Je={class:"flex md:flex-nowrap justify-between mb-2"},Xe={class:"w-[300px] min-w-[300px]"},Ze={key:0,class:"flex flex-col"},et={class:"text-xs"},tt={class:"flex items-center"},nt={class:"text-xs"},at=l("span",null,"\xA0-\xA0",-1),it={class:"text-xs"},st=l("span",null,"\xA0-\xA0",-1),lt={class:"text-xs"},ot={class:"grid lg:grid-cols-4 grid-cols-2 gap-2 w-[600px]"},dt={class:"flex flex-nowrap w-full"},ut={class:"flex flex-col w-full"},rt={class:"text-font text-right text-md"},ct={class:"flex flex-col"},mt={class:"text-font text-right text-md"},_t={class:"flex flex-col"},pt={class:"text-font text-right text-md"},ft={class:"flex flex-col"},bt={class:"text-font text-right text-md"},yt={class:"flex flex-col"},vt={class:"text-font text-right text-md"},gt={class:"flex flex-col"},xt={class:"text-font text-right text-md"},wt={class:"flex flex-col"},kt={class:"text-font text-right text-md"},ht={class:"flex flex-nowrap w-full"},Vt={class:"grid grid-cols-6 gap-2"},$t={class:"col-span-5 flex md:flex-nowrap gap-2"},Ut={class:"w-full"},It={key:0,class:"mt-2"},Et={class:"flex flex-col gap-1 mb-1"},Dt=l("div",{class:"subtitle text-xs text-center"},"Moneda",-1),Rt=l("div",{class:"subtitle text-xs text-center"},"\xC1rea",-1),Ct={class:"flex flex-col gap-1"},At=l("div",{class:"subtitle text-center text-xs"},"Diagn\xF3sticos",-1),Pt={class:"w-full flex flex-col justify-between border card shadow-none px-3 py-1"},St={class:"text-xs uppercase line-clamp-1"},Tt={class:"text-xs uppercase line-clamp-1"},qt={class:"fixed bottom-0 right-0 py-2 bg-white w-full"},Ot={class:"flex flex-nowrap gap-2 px-2 mt-1"},Gt={__name:"reconciliation-write",props:{id:Number,eventId:String,width:String,isDrawer:Boolean},setup(W){const w=W,m=ee("$api"),F=ee("$cats"),O=se(),Y=Re(),$=L(),U=te({currency:F.value.currency,policy_branch:F.value.policy_branch}),G=()=>({diagnosis:[],$book_state_id:50,$currency_id:14,book_date:Ne(new Date)}),e=te({payments:[],submitting:!1,loading:!0,event:{},items:[],item:G()}),R=C(()=>Boolean(w.id)),B=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.coverage)||0),t),0);return M(n)}),N=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.discount)||0),t),0);return M(n)}),y=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.billed_amount)||0),t),0);return M(n)}),Q=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.deductible)||0),t),0);return M(n)}),_=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.covered)||0),t),0);return M(n)}),k=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.insurance_payment)||0),t),0);return M(n)}),f=C(()=>{const n=e.items.reduce((t,u)=>(u.c_status&1||(t+=V(u.insurance_responsability)||0),t),0);return M(n)});async function H(n){try{if(!n)return;const t=await m.get(`insured/${n}`);if(!w.isEdit&&t.policies){const u=t.policies[0];i(u)}e.item.insured_id=t.id,e.item.insured_description=t.fullname}catch(t){console.log(t)}}function ne(){e.item.insured_id=null,e.item.insured=null,v()}async function J(n){try{if(!n)return;const t=await m.get(`insured/${n}`);e.item.titular_id=t.id,e.item.titular_description=t.fullname}catch(t){console.log(t)}}function ae(){e.item.titular_id=null,e.item.titular=null}async function i(n){e.item.insured_id||(e.item.insured_id=n.insured_id,e.item.insured_description=n.insured_description),e.item.insurance_id=n.insurance_id,e.item.insurance_description=n.insurance,e.item.titular_id=n.titular_id,e.item.titular_description=n.titular_description,e.item.insured_code=n.insured_code,e.item.deductible=n.deductible,e.item.policy_id=n.id,e.item.policy_number=n.policy_number,e.item.policy_branch=n.policy_branch,e.item.$policy_branch_id=n.$policy_branch_id}async function v(){e.item.insurance_id=null,e.item.insurance_description=null,e.item.titular_id=null,e.item.titular_description=null,e.item.insured_code=null,e.item.policy_id=null,e.item.policy_number=null,e.item.deductible=null}async function a(n){try{const t=await m.get(`ICD10/${n}`);if(e.item.diagnosis.findIndex(P=>P.id===n)!==-1){O.notify({type:"warning",message:"Diagn\xF3stico ya esta agregado"});return}e.item.diagnosis.push({id:t.id,code:t.code,description:t.description}),e.item.diagnosis_description=null,e.item.diagnosis_id=null}catch(t){console.log(t)}}function g(){try{e.item.diagnosis_id=null,e.item.diagnosis_description=null}catch(n){console.log(n)}}function o(n){try{const t=e.item.diagnosis.findIndex(u=>u.id===n);e.item.diagnosis.splice(t,1)}catch(t){console.log(t)}}function we(){e.item=G(),setTimeout(()=>{$.value.resetValidation()}),X()}async function ke(){e.submitting=!0;const n=await m.get(`reconciliation/pdf/${w.id}`);console.log(11,n),ze(n,`${e.item.code}-${e.item.insurance_description}`.toUpperCase()),e.submitting=!1}async function he(){try{if(R.value){const n=e.items.filter(u=>u.item_id);if(!n.length){O.notify({type:"success",message:"Es requerido que la reconcilici\xF3n tenga por lo menos 1 CPT"});return}const t=await m.put(`reconciliation/${w.id}`,{book:{...e.item,billed_amount_total:y.value,coverage_total:B.value,discount_total:N.value,deductible_total:Q.value,covered_total:_.value,insurance_payment_total:k.value,insurance_responsability_total:f.value},book_items:n,book_payments:e.payments});t&&(O.notify({type:"success",message:`Reconciliaci\xF3n Editada ${t.code}`}),location.reload(),X())}else{const n=await m.post("reconciliation",{book:{...e.item,billed_amount_total:y.value,coverage_total:B.value,discount_total:N.value,deductible_total:Q.value,covered_total:_.value,insurance_payment_total:k.value,insurance_responsability_total:f.value},book_items:e.items.filter(t=>t.c_status===4&&t.item_id),book_payments:e.payments.filter(t=>t.c_status===4)});w.eventId&&m.put(`event/general/${w.eventId}`,{book_code:n.code}),n&&(O.notify({type:"success",message:`Reconciliaci\xF3n agregada ${n.code}`}),await m.get(`reconciliation/pdf/${n.code}`),we(),Y.push("/"),X())}}catch(n){console.log(n)}}async function X(){try{if(R.value){const{item:n,items:t,payments:u}=await m.get(`reconciliation/${w.id}`);e.item=n,e.items=t,e.payments=u,e.item.event_id&&(e.event=await m.get(`event/${e.item.event_id}`)),e.loading=!1;return}if(w.eventId){e.event=await m.get(`event/${w.eventId}`),e.policy=await m.get(`policy/insured/${e.event.policy_id}`),e.item.event_id=e.event.id,i(e.policy),e.item.diagnosis=e.event.diagnosis,e.itineraries=await m.get("itinerary",{params:{where:{c_status:4,event_id:w.eventId},returnItems:!0}});for(let n=0;n<e.itineraries.length;n++){const t=e.itineraries[n];for(let u=0;u<t.mprocedure.length;u++){const P=t.mprocedure[u];e.items.push({c_status:4,book_date:t.attendance_date,item_id:P.id,item_description:P.description,provider_id:t.provider_id,provider_description:t.provider_description,quantity:1,reset:0,billed_amount:null,coverage:null,deductible:null,covered:null,insurance_payment:null,insurance_responsability:null,insurance_claim:null,note:null})}}await H(e.event.insured_id),e.item.user_id=e.event.user_id,e.item.user_description=e.event.user_description}e.loading=!1}catch(n){console.log(n)}}le(()=>{X()});const Ve=C(()=>({width:w.width,"padding-right":w.isDrawer&&"8px","padding-left":w.isDrawer&&"8px"}));return(n,t)=>{const u=Ce("loading");return e.loading?Z("",!0):(r(),E("div",{key:0,style:Ge(Ve.value),class:"relative pb-32 px-4"},[s(Oe,{ref_key:"mainForm",ref:$,onSubmit:he},{default:c(()=>{var P;return[l("div",Je,[l("div",Xe,[(P=e.event)!=null&&P.id?(r(),E("div",Ze,[l("span",et,h(e.event.contact_description),1),l("div",tt,[l("span",nt,"#"+h(e.event.code),1),at,l("span",it,h(e.event.event_type),1),st,l("span",lt,h(e.event.event_state),1)]),s(q,{flat:"",class:"button bg-btn-green rounded-md w-full",label:"Abrir Coordinaci\xF3n","no-caps":"",onClick:t[0]||(t[0]=p=>{e.dialogWriteEvent=!0})})])):Z("",!0)]),l("div",ot,[l("div",dt,[l("div",ut,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("Total Reconciliaci\xF3n")]),_:1}),l("span",rt,h(n.$currency(y.value)),1)])]),l("div",ct,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("Descuento de Ajuste")]),_:1}),l("span",mt,h(n.$currency(N.value)),1)]),l("div",_t,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("Monto a Procesar")]),_:1}),l("span",pt,h(n.$currency(B.value)),1)]),l("div",ft,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("DEDUCIBLE / COPAGO")]),_:1}),l("span",bt,h(n.$currency(Q.value)),1)]),l("div",yt,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("CUBIERTO")]),_:1}),l("span",vt,h(n.$currency(_.value)),1)]),l("div",gt,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("PAGO DE ASEGURADA")]),_:1}),l("span",xt,h(n.$currency(k.value)),1)]),l("div",wt,[s(z,{class:"text-xxs text-font bg-stone-200 rounded"},{default:c(()=>[I("RESP. ASEGURADA")]),_:1}),l("span",kt,h(n.$currency(f.value)),1)]),l("div",ht,[R.value?D((r(),b(q,{key:0,flat:"",class:"button-press bg-btn-red rounded-md w-full",label:"Imprimir","no-caps":"",onClick:ke},null,512)),[[u,e.submitting]]):Z("",!0)])])]),l("div",Vt,[l("div",$t,[l("div",Ut,[s(We,{items:e.items,isEdit:R.value,onSetItems:t[1]||(t[1]=p=>e.items=p)},null,8,["items","isEdit"]),s(He,{class:"pt-2",items:e.payments,isEdit:R.value,onSetItems:t[2]||(t[2]=p=>e.payments=p)},null,8,["items","isEdit"]),R.value?(r(),E("div",It,[s(Ae,{ref_id:e.item.id,table:"t_book",file_type:"GENERAL"},null,8,["ref_id"]),s(Pe,{refId:e.item.id,refKey:"t_book"},null,8,["refId"])])):Z("",!0)])]),l("div",Et,[s(de,{ref:"mainInput",onSetInsured:H,onSetPolicy:i,onClearInsured:ne,"model-value":e.item.insured_description,id:e.item.insured_id,rules:[d(j)]},null,8,["model-value","id","rules"]),s(de,{readonly:"",ref:"mainInput",onSetInsured:J,onClearInsured:ae,"model-value":e.item.titular_description,id:e.item.titular_id,label:"Titular",rules:[d(j)]},null,8,["model-value","id","rules"]),s(Se,{onSetInsurance:t[3]||(t[3]=p=>n.setInsurance(p,n.row)),onClearInsurance:t[4]||(t[4]=p=>n.clearInsurance(n.row)),"model-value":e.item.insurance_description,rules:[d(j)],"hide-bottom-space":""},null,8,["model-value","rules"]),s(x,{readonly:"",dense:"",outlined:"",modelValue:e.item.policy_number,"onUpdate:modelValue":t[5]||(t[5]=p=>e.item.policy_number=p),label:n.$t("policy_number"),onKeydown:t[6]||(t[6]=ue(ie(()=>{},["prevent"]),["enter"])),rules:[d(j)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),s(x,{readonly:"",dense:"",outlined:"",modelValue:e.item.insured_code,"onUpdate:modelValue":[t[7]||(t[7]=p=>e.item.insured_code=p),n.findInsuredCode],label:n.$t("insured_code"),onKeydown:t[8]||(t[8]=ue(ie(()=>{},["prevent"]),["enter"])),"hide-bottom-space":""},null,8,["modelValue","label","onUpdate:modelValue"]),D(s(x,{"input-class":"text-right",dense:"",outlined:"",modelValue:e.item.deductible,"onUpdate:modelValue":t[9]||(t[9]=p=>e.item.deductible=p),label:"Deducible","data-maska":"0.99","data-maska-tokens":d(S),"hide-bottom-space":"",rules:[d(j)]},null,8,["modelValue","data-maska-tokens","rules"]),[[d(A),void 0,d(T)]]),l("div",null,[Dt,s(re,{class:"flex gap-1 text-xs",size:"sm",modelValue:e.item.$currency_id,"onUpdate:modelValue":t[10]||(t[10]=p=>e.item.$currency_id=p),"toggle-color":"secondary","toggle-text-color":"text-font",options:U.currency},null,8,["modelValue","options"])]),l("div",null,[Rt,s(re,{class:"flex gap-1 text-xs",size:"sm",modelValue:e.item.$policy_branch_id,"onUpdate:modelValue":t[11]||(t[11]=p=>e.item.$policy_branch_id=p),"toggle-color":"secondary","toggle-text-color":"text-font",options:U.policy_branch},null,8,["modelValue","options"])]),l("div",Ct,[At,s(Te,{onSetDiagnosis:a,onClearInsured:g,"model-value":e.item.diagnosis_description},null,8,["model-value"]),(r(!0),E(K,null,oe(e.item.diagnosis,(p,Qt)=>(r(),E("div",{class:"flex flex-nowrap gap-1",key:p.id},[l("div",Pt,[l("div",St,h(p.description),1),l("div",Tt,h(p.code),1)]),s(q,{diabled:"",flat:"",class:"button-icon bg-primary text-white text-[10px] h-[40px]",icon:"fa-solid fa-xmark",onClick:Bt=>o(p.id)},{default:c(()=>[s(ce,{class:"bg-default text-black text-xs"},{default:c(()=>[I("Remover diagn\xF3stico")]),_:1})]),_:2},1032,["onClick"])]))),128))])])]),l("div",qt,[s(qe,{item:e.item,isEdit:R.value},null,8,["item","isEdit"]),l("div",Ot,[w.isEdit?(r(),E(K,{key:0},[s(q,{class:"button-icon bg-primary text-white py-0",icon:"fa-solid fa-xmark",rounded:"",onClick:t[12]||(t[12]=ie(p=>n.onDelete(e.item.id),["stop"])),size:"sm"},{default:c(()=>[s(ce,{class:"bg-default text-black",size:"xs"},{default:c(()=>[I("Remover")]),_:1})]),_:1}),s(q,{class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"guardar cambios",type:"submit"})],64)):(r(),b(q,{key:1,class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"guardar cambios",type:"submit"}))])])]}),_:1},512),s(Me,{modelValue:e.dialogWriteEvent,"onUpdate:modelValue":t[14]||(t[14]=P=>e.dialogWriteEvent=P),position:n.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:c(()=>[s(Qe,null,{default:c(()=>[s(Be,{onClose:t[13]||(t[13]=P=>e.dialogWriteEvent=!1),isDrawer:"",id:e.event.id,isEdit:"",width:(n.$isDesktop,"100%")},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position"])],4))}}};export{Gt as default};
