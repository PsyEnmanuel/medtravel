import{l as V,m as U,r as Q,n as R,a3 as W,$ as z,t as c,G as b,y as l,H as f,v as k,F as u,E as C,z as a,x as d,Q as D,B as w,aS as T,K as P,R as N,aW as F,D as q,az as L,q as j,k as A,w as M,A as S,J as G,C as H,I as J,M as E,L as I,U as K}from"./index.73cc0385.js";const O={class:"flex justify-between items-start gap-2 py-2"},X={key:0,class:"mb-2"},Y=l("p",{class:"text-2xl text-info"},"Editar CPT",-1),Z={class:"font-bold text-brand"},ee=l("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),te={key:1},se=l("p",{class:"text-2xl text-info"},[q("Agregar "),l("b",{class:"font-bold text-brand"},"CPT")],-1),ae=l("p",null,"Los campos requeridos tienen un (*)",-1),le=[se,ae],oe=l("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),B={__name:"CPTWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(g){const m=V("$api");V("$cats");const n=V("$local"),s=U(),$=Q(),p=g,h=()=>({}),i=R({item:h(),local:"WriteCPT"}),y=W(()=>({width:p.width,padding:p.isDrawer&&"6px 8px"}));async function _(){p.isEdit?i.item=await m.get(`CPT/${p.id}`):n.get(i.local)}function o(){i.item=h(),n.remove(i.local),$.value.resetValidation()}async function t(){p.isEdit?await m.put(`CPT/${p.id}`,{...i.item})&&s.notify({type:"success",message:"CPT Editado"}):await m.post("CPT",{...i.item})&&(s.notify({type:"success",message:"CPT Agregado"}),o())}return z(()=>{_()}),(e,r)=>{var v;return c(),b("div",{style:P(y.value)},[l("div",O,[g.isEdit?(c(),b("div",X,[Y,l("b",Z,f(i.item.description),1),ee])):(c(),b("div",te,le)),g.isDrawer?(c(),k(u,{key:2,flat:"",class:"button",label:"cerrar",onClick:r[0]||(r[0]=x=>e.$emit("close"))})):C("",!0)]),oe,a(F,{class:N((v=g.isDrawer)!=null?v:"pb-64"),ref_key:"writeForm",ref:$,onSubmit:t,onReset:o},{default:d(()=>[a(D,{class:"my-2",dense:"",outlined:"",modelValue:i.item.code,"onUpdate:modelValue":r[1]||(r[1]=x=>i.item.code=x),label:e.$t("code")+"*",rules:[w(T)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),a(D,{class:"my-2",dense:"",outlined:"",modelValue:i.item.description,"onUpdate:modelValue":r[2]||(r[2]=x=>i.item.description=x),label:e.$t("description")+"*",rules:[w(T)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),g.isDrawer?(c(),b("div",{key:0,class:"fixed bottom-0 right-[10px] py-2 bg-white",style:P(y.value)},[p.isEdit?(c(),k(u,{key:0,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"Guardar cambios",type:"submit"})):(c(),k(u,{key:1,class:"button-press w-full text-lg bg-primary text-white",flat:"",label:"agregar",type:"submit"}))],4)):C("",!0)]),_:1},8,["class"])],4)}}},ie={class:"flex justify-between md:flex-nowrap"},ne={class:"flex flex-nowrap w-full gap-2 mb-1"},re={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},de={class:"full-width row flex-center text-primary q-gutter-sm"},ue={bordered:"",flat:"",class:"card pb-2 relative flex flex-nowrap"},ce={class:"absolute right-3 top-2"},pe={class:"pl-3 pr-8 w-full pt-2 flex flex-col overflow-hidden"},me={class:"text-uppercase line-clamp-1 font-semibold"},fe={class:"text-uppercase line-clamp-1 text-xxs"},ge={class:"flex justify-end gap-2 -mr-5 mt-1"},we={__name:"CPT-index",setup(g){const{t:m}=L(),n=Q(),s=R({dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:code,description",pagination:{sortBy:"code",descending:!1,page:1,rowsPerPage:20},url:"CPT",query:{groupBy:["t_CPT.id"],where:{c_status:4}},columns:[{name:"code",required:!0,label:m("code"),align:"left",field:"code",sortable:!0},{name:"description",required:!0,label:m("name"),align:"left",field:"description",sortable:!0},{name:"description",required:!0,label:m("name"),align:"left",field:"description",sortable:!0,format:(o,t)=>`${t.code} - ${t.description}`}],rows:[]}),{onRequest:$,getSelectedString:p,onDeleteRows:h,addMore:i,itemsRange:y}=j(s,n),_=A();return M(()=>_.table.t_CPT,o=>{n.value.requestServerInteraction(),n.value.clearSelection()},{deep:!0}),(o,t)=>(c(),b(K,null,[l("div",ie,[l("div",ne,[a(D,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:s.search,"onUpdate:modelValue":t[0]||(t[0]=e=>s.search=e),placeholder:o.$t("search")},{append:d(()=>[a(S,{name:"search"})]),_:1},8,["modelValue","placeholder"]),o.$me.unixroles&1?(c(),k(u,{key:0,flat:"",class:"button h-full",icon:"add",label:o.$isDesktop&&o.$t("add"),onClick:t[1]||(t[1]=e=>s.dialogCreate=!0)},null,8,["label"])):C("",!0)]),o.$isDesktop?(c(),b("div",re,[a(u,{class:"bg-transparent",flat:"","no-caps":""},{default:d(()=>[q(f(w(y).start)+" - "+f(w(y).end)+" de "+f(s.pagination.rowsNumber),1)]),_:1}),a(u,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:t[2]||(t[2]=e=>n.value.firstPage())}),a(u,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:t[3]||(t[3]=e=>n.value.prevPage())}),a(u,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:t[4]||(t[4]=e=>n.value.nextPage())}),a(u,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:t[5]||(t[5]=e=>n.value.lastPage())})])):C("",!0)]),a(J,{grid:!o.$isDesktop,"hide-pagination":"",rows:s.rows,columns:s.columns,"row-key":"id",ref_key:"tableRef",ref:n,onRequest:w($),flat:"",pagination:s.pagination,"onUpdate:pagination":t[6]||(t[6]=e=>s.pagination=e),loading:s.loading,"rows-per-page-label":"Lineas","wrap-cells":!0},G({"no-data":d(({icon:e,message:r,filter:v})=>[l("div",de,[l("span",null,f(r),1),a(S,{size:"2em",name:v?"filter_b_and_w":e},null,8,["name"])])]),item:d(e=>[l("div",{class:"q-py-xs col-xs-12 col-sm-6 col-md-4",style:P(e.selected?"transform: scale(0.95);":"")},[l("div",ue,[l("div",ce,[a(H,{dense:"",modelValue:e.selected,"onUpdate:modelValue":r=>e.selected=r,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),l("div",pe,[l("span",me,f(e.row.description),1),l("span",fe,f(e.row.ref),1),l("div",ge,[a(u,{flat:"",class:"button-press bg-primary text-white rounded-md",size:"sm",label:"Editar","no-caps":"",onClick:r=>{s.selectedId=e.row.id,s.dialogWrite=!0}},null,8,["onClick"])])])])],4)]),_:2},[o.$isDesktop?void 0:{name:"bottom",fn:d(()=>[a(u,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:w(i)},{default:d(()=>[q("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","rows","columns","onRequest","pagination","loading"]),a(I,{class:"q-pa-none",modelValue:s.dialogWrite,"onUpdate:modelValue":t[8]||(t[8]=e=>s.dialogWrite=e),position:o.$isDesktop?"right":"standard","full-height":"","full-width":o.$isDesktop,maximized:"","transition-duration":100},{default:d(()=>[a(E,null,{default:d(()=>[a(B,{onClose:t[7]||(t[7]=e=>s.dialogWrite=!1),isDrawer:"",id:s.selectedId,isEdit:"",width:o.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","full-width"]),a(I,{modelValue:s.dialogCreate,"onUpdate:modelValue":t[10]||(t[10]=e=>s.dialogCreate=e),position:o.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":100},{default:d(()=>[a(E,null,{default:d(()=>[a(B,{onClose:t[9]||(t[9]=e=>s.dialogCreate=!1),isDrawer:"",width:o.$isDesktop?"400px":"100%"},null,8,["width"])]),_:1})]),_:1},8,["modelValue","position"])],64))}};export{we as default};
