import{l as C,m as G,r as R,n as U,w as B,a3 as L,$ as P,t as a,G as p,y as o,H as D,v,F as m,E as q,z as i,x as _,Q as k,B as A,aS as F,K as Q,bh as T,R as H,aW as M,D as S,k as W,by as O,a5 as J,U as I,V as z,A as X,M as N,L as j}from"./index.e9245a9e.js";import{_ as Y}from"./ChartPoll.f3d675af.js";const Z={class:"flex flex-nowrap justify-between items-start gap-2 py-2"},ee={key:0,class:"mb-2"},te=o("p",{class:"text-2xl text-info"},"Editar Encuesta",-1),se={class:"font-bold text-brand line-clamp-1"},le=o("p",{class:"text-xs"},"Los campos requeridos tienen un (*)",-1),oe={key:1},ie=o("p",{class:"text-2xl text-info"},[S("Agregar "),o("b",{class:"font-bold text-brand"},"Encuesta")],-1),ae=o("p",null,"Los campos requeridos tienen un (*)",-1),ne=[ie,ae],re=o("div",{class:"subtitle mb-2 bg-primary p-0.5 rounded-none"},null,-1),de={class:"pb-20 pt-2"},ue={key:1},ce={__name:"PollWrite",props:{id:Number,isEdit:Boolean,width:String,isDrawer:Boolean},setup(f){const y=C("$api"),d=C("$local"),w=G(),s=R(),n=f,x=()=>({c_status:4}),e=U({loading:!0,item:x(),local:"poll",categories:[]});B(()=>e.item,t=>{n.isEdit||d.set(e.local,t)},{deep:!0});function $(){e.item=x(),d.remove(e.local),s.value.resetValidation()}async function h(){n.isEdit?await y.put(`poll/${n.id}`,{...e.item})&&w.notify({type:"success",message:"Encuesta Editada"}):await y.post("poll",{...e.item})&&(w.notify({type:"success",message:"Encuesta Agregada"}),$())}async function c(){e.loading=!0,n.isEdit?e.item=await y.get(`poll/${n.id}`):d.get(e.local),e.loading=!1}const r=L(()=>({width:n.width,"padding-right":n.isDrawer&&"8px","padding-left":n.isDrawer&&"8px"}));return P(()=>{c()}),(t,g)=>{var V;return e.loading?q("",!0):(a(),p("div",{key:0,style:Q(r.value),class:"relative"},[o("div",Z,[f.isEdit?(a(),p("div",ee,[te,o("b",se,D(e.item.description),1),le])):(a(),p("div",oe,ne)),f.isDrawer?(a(),v(m,{key:2,flat:"",class:"button",label:"cerrar",onClick:g[0]||(g[0]=l=>t.$emit("close"))})):q("",!0)]),re,o("div",de,[i(M,{class:H((V=f.isDrawer)!=null?V:"pb-64"),ref_key:"writeForm",ref:s,onSubmit:h,onReset:$},{default:_(()=>[o("div",null,[i(k,{class:"mb-2",dense:"",outlined:"",modelValue:e.item.description,"onUpdate:modelValue":g[1]||(g[1]=l=>e.item.description=l),label:t.$t("description")+"*",rules:[A(F)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),i(k,{class:"mb-2",dense:"",outlined:"",modelValue:e.item.note,"onUpdate:modelValue":g[2]||(g[2]=l=>e.item.note=l),label:t.$t("note")+"*",type:"textarea",rows:3},null,8,["modelValue","label"])]),f.isDrawer?(a(),p("div",{key:0,class:"fixed bottom-0 right-0 py-2 bg-white",style:Q(r.value)},[i(T,{item:e.item,isEdit:f.isEdit},null,8,["item","isEdit"]),n.isEdit?(a(),v(m,{key:0,class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"Guardar cambios",type:"submit"})):(a(),v(m,{key:1,class:"button-press w-full text-lg rounded-md bg-primary text-white",flat:"",label:"agregar",type:"submit"}))],4)):(a(),p("div",ue,[n.isEdit?(a(),v(m,{key:0,class:"button-press w-full text-lg rounded-md",flat:"",label:"Guardar cambios",type:"submit"})):(a(),v(m,{key:1,class:"button-press w-full text-lg rounded-md",flat:"",label:"agregar",type:"submit"}))]))]),_:1},8,["class"])])],4))}}},pe={class:"flex justify-between items-start flex-nowrap gap-2 py-2"},me={class:"mb-2"},fe=o("p",{class:"text-2xl text-info"},"Editar Pregunta",-1),ge={class:"font-bold text-brand"},be={class:"mt-2"},ye={class:"flex flex-nowrap gap-2 items-start mt-2"},we={class:"flex flex-nowrap gap-2 items-start mb-2 p-1"},$e={class:"w-[20px]"},_e={class:"card px-1 w-full"},xe={class:"w-full text-xs"},ve={class:"flex justify-end flex-nowrap h-auto"},he={__name:"QuestionWrite",props:{id:Number,width:String,isDrawer:Boolean},setup(f){const y=G(),d=C("$api"),w=W(),s=R(),n=f,x=()=>({description:null}),e=U({loading:!0,items:[],item:x(),total:0,selected:{},search:""});B(()=>w.t_poll,()=>{$()});async function $(){try{e.item=await d.get(`poll-question/${n.id}`);const l=await d.get("poll-answer",{params:{order:{description:"ASC"},where:{poll_question_id:n.id,c_status:4}}});console.log(l),e.items=l.items,e.total=l.total,e.loading=!1}catch(l){console.log(l)}}function h(){e.item=x(),s.value.resetValidation()}async function c(){try{await d.post("poll-question",e.item)&&y.notify({type:"success",message:"Categor\xEDa Agregada"}),$(),h()}catch(l){console.log(l)}}async function r(l){try{const u=await d.delete(`poll-answer/${l.id}`,l);$(),u&&y.notify({type:"success",message:"Respuesta removida"})}catch(u){console.log(u)}}async function t(l){try{await d.put(`poll-answer/${l.id}`,l)&&y.notify({type:"success",message:"Respuesta editada"})}catch(u){console.log(u)}}async function g(){try{await d.delete(`poll-question/${n.id}`)}catch(l){console.log(l)}}const V=L(()=>({width:n.width,"padding-right":n.isDrawer&&"8px","padding-left":n.isDrawer&&"8px"}));return P(()=>{$()}),(l,u)=>e.loading?q("",!0):(a(),p("div",{key:0,style:Q(V.value),class:"pb-32"},[o("div",pe,[o("div",me,[fe,o("b",ge,D(e.item.description),1)]),f.isDrawer?(a(),v(m,{key:0,flat:"",class:"button",label:"cerrar",onClick:u[0]||(u[0]=b=>l.$emit("close"))})):q("",!0)]),i(M,{ref_key:"writeForm",ref:s,onSubmit:c,onReset:h},{default:_(()=>[o("div",be,[i(k,{class:"mb-2",dense:"",outlined:"",modelValue:e.item.description,"onUpdate:modelValue":u[1]||(u[1]=b=>e.item.description=b),label:l.$t("question"),"hide-bottom-space":"",rules:[A(F)],type:"textarea",rows:4},null,8,["modelValue","label","rules"]),i(O,{"model-value":e.item.poll_type,refKey:"poll_type",onSetCategory:u[2]||(u[2]=b=>e.item.$poll_type_id=b),onClearCategory:u[3]||(u[3]=b=>e.item.$poll_type_id=null)},null,8,["model-value"]),o("div",ye,[i(m,{flat:"",class:"button-press w-full bg-default text-primary text-sm font-bold tracking-normal mb-2",type:"submit"},{default:_(()=>[S(" GUARDAR CAMBIOS ")]),_:1}),i(m,{class:"button-icon bg-primary text-white py-0",icon:"fa-solid fa-xmark",rounded:"",onClick:g,size:"sm"},{default:_(()=>[i(J,{class:"bg-default text-black",size:"xs"},{default:_(()=>[S("Remover")]),_:1})]),_:1})])])]),_:1},512),(a(!0),p(I,null,z(e.items,(b,K)=>(a(),p("div",{key:b.id},[o("div",we,[o("div",$e,[o("div",_e,D(K+1),1)]),o("div",xe,[i(k,{class:"w-full",dense:"",outlined:"",modelValue:b.description,"onUpdate:modelValue":E=>b.description=E,label:l.$t("description"),"hide-bottom-space":""},null,8,["modelValue","onUpdate:modelValue","label"])]),o("div",ve,[i(m,{class:"bg-default text-primary mr-2","text-color":"font",size:"xs",flat:"",icon:"sym_o_edit_note",onClick:E=>t(b)},null,8,["onClick"]),i(m,{class:"bg-default text-primary","text-color":"font",size:"xs",flat:"",icon:"sym_o_remove",onClick:E=>r(b)},null,8,["onClick"])])])]))),128))],4))}},ke={class:"grid lg:grid-cols-2 gap-4"},Ve=o("div",{class:"subtitle py-1"},"Agregar Pregunta",-1),Ce={class:"card px-1 mr-1"},De={class:"text-xs"},Qe={__name:"poll-view",props:{id:Number},setup(f){const y=R(),d=f,w=C("$api"),s=U({diaglogPoll:!1,selectedPollId:null,diaglogQuestion:!1,selectedQuestionId:null,item:{},drawer:!1,question:{},stats:{},questions:[]});async function n(){s.item=await w(`poll/${d.id}`)}async function x(){s.stats=await w("poll/stats",{params:{where:{c_status:4},returnItems:!0}}),console.log(s.stats)}async function e(){s.questions=await w("poll-question",{params:{where:{c_status:4,poll_id:d.id},returnItems:!0}})}async function $(){console.log(12),await w.post("poll-question",{poll_id:d.id,...s.question})}P(()=>{n(),e(),x()});const h=W();return B(()=>h.table.t_poll,c=>{y.value.requestServerInteraction(),y.value.clearSelection()},{deep:!0}),(c,r)=>(a(),p("div",ke,[o("div",null,[i(m,{flat:"",class:"button-press bg-primary text-white rounded-md",size:"sm",label:s.item.description,"no-caps":"",onClick:r[0]||(r[0]=t=>s.diaglogPoll=!0)},null,8,["label"]),Ve,i(k,{class:"w-full border-none",dense:"",outlined:"",modelValue:s.question.description,"onUpdate:modelValue":r[1]||(r[1]=t=>s.question.description=t),label:c.$t("question"),rules:[A(F)],"hide-bottom-space":""},null,8,["modelValue","label","rules"]),i(m,{flat:"",class:"button-press bg-primary text-white rounded-md my-2 w-full",size:"sm",label:c.$t("save"),"no-caps":"",onClick:$},null,8,["label"]),(a(!0),p(I,null,z(s.questions,t=>(a(),p("div",{key:t.id,class:"flex items-start flex-nowrap gap-1 mb-2 bg-neutral-100 p-2 rounded-md"},[o("div",Ce,[i(X,{name:"fa-duotone fa-solid fa-question"})]),o("span",De,D(t.description),1),i(m,{flat:"",class:"button-press bg-primary text-white rounded-md ml-auto",size:"sm",label:c.$t("edit"),"no-caps":"",onClick:g=>{s.selectedQuestionId=t.id,s.diaglogQuestion=!0}},null,8,["label","onClick"])]))),128))]),(a(!0),p(I,null,z(s.stats,(t,g)=>(a(),p("div",{key:g,class:"card mb-2"},[(a(),v(Y,{key:`poll-${t.description}`,data:t.answers,name:`poll-${t.description}`,title:t.description,subtitle:""},null,8,["data","name","title"]))]))),128)),i(j,{class:"q-pa-none left-0","no-refocus":"",modelValue:s.diaglogQuestion,"onUpdate:modelValue":r[3]||(r[3]=t=>s.diaglogQuestion=t),position:c.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":c.$isDesktop?100:0},{default:_(()=>[i(N,null,{default:_(()=>[i(he,{onClose:r[2]||(r[2]=t=>s.diaglogQuestion=!1),isDrawer:"",id:s.selectedQuestionId,isEdit:"",width:c.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","transition-duration"]),i(j,{class:"q-pa-none left-0","no-refocus":"",modelValue:s.diaglogPoll,"onUpdate:modelValue":r[5]||(r[5]=t=>s.diaglogPoll=t),position:c.$isDesktop?"right":"standard","full-height":"",maximized:"","transition-duration":c.$isDesktop?100:0},{default:_(()=>[i(N,null,{default:_(()=>[i(ce,{onClose:r[4]||(r[4]=t=>s.diaglogPoll=!1),isDrawer:"",id:d.id,isEdit:"",width:c.$isDesktop?"400px":"100%"},null,8,["id","width"])]),_:1})]),_:1},8,["modelValue","position","transition-duration"])]))}};export{Qe as default};
