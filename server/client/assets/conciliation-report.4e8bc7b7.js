import{l as w,az as U,r as z,n as k,q as T,k as A,w as q,t as _,G as C,y as r,z as a,x as o,A as $,Q as j,F as i,D as x,H as c,B as u,E as h,v as F,aF as M,al as E,ao as G,J as L,aC as W,T as H,I as J,U as O}from"./index.e965bcc3.js";const K={class:"flex justify-between md:flex-nowrap mb-2"},X={class:"flex flex-nowrap w-full gap-2"},Y={key:0,class:"grid grid-flow-col auto-cols-max gap-2"},Z={class:"flex lg:flex-nowrap w-full gap-2"},ee={class:"grid lg:grid-cols-4 gap-1 mb-1"},te={class:"full-width row flex-center text-primary q-gutter-sm"},le=["src"],ne={__name:"conciliation-report",props:{insuredId:Number,doctorId:Number,providerId:Number},setup(I){var g,b,y;const m=w("$cats"),p=w("$me"),v=I,{t:d}=U(),s=z(),S=k({event_state:m.value.event_state,event_type:m.value.event_type}),t=k({itinerary:[],eventSelected:null,itineraryDialog:!1,dialogCopy:!1,dialogWrite:!1,dialogList:!1,dialogCreate:!1,selectedId:0,dialogWidth:400,selected:[],search:"",search_key:"orlike:t_event.code,user_description,insured,t_event.provider_description,contact_description,t_event.created_by,MRN",pagination:{sortBy:"t_event.event_state",descending:!1,page:1,rowsPerPage:20},url:"event",table:"t_event",query:{join:[{table:"t_itinerary",relationA:"t_itinerary.event_id",relationB:"t_event.id"}],groupBy:["t_event.id"],where:{"t_event.c_status":4,high_profile:p.high_profile?null:0,insured_id:(g=v.insuredId)!=null?g:null,doctor_id:(b=v.doctorId)!=null?b:null,"t_event.provider_id":(y=v.providerId)!=null?y:null,"in:$event_type_id":p.unixroles&8?[178]:p.unixroles&16?[176]:[],attendance_datetime:{from:null,to:null},"in:$event_state_id":[]}},visibleColumns:[],columns:[{name:"action",required:!0,label:"",align:"left",field:d("id"),classes:"min-w-[200px]"},{name:"user_description",required:!0,label:"Asignado a",align:"left",field:"user_description",sortable:!0},{name:"insured",required:!0,label:d("insured"),align:"left",field:"insured",sortable:!0},{name:"provider_description",required:!0,label:"Proveedor/Contacto",align:"left",field:"provider_description",sortable:!0},{name:"doctor_description",required:!0,label:"M\xE9dico",align:"left",field:"doctor_description",sortable:!0},{name:"event_state",required:!0,label:d("event_state"),align:"left",field:"event_state",sortable:!0},{name:"request_date",required:!0,label:d("request_date"),align:"left",field:"request_date_format",sortable:!0},{name:"created_by",required:!0,label:d("created_by"),align:"left",field:"created_by",sortable:!0},{name:"reason_cancellation",label:d("reason_cancellation"),align:"left",field:"reason_cancellation",sortable:!0,hidden:!0}],rows:[]}),{onRequest:P,getSelectedString:V,onDeleteRows:B,addMore:D,itemsRange:f}=T(t,s),N=A();return q(()=>N.table.t_event,n=>{s.value.requestServerInteraction(),s.value.clearSelection()},{deep:!0}),q(()=>t.query.where["t_event.c_status"],n=>{console.log(n),n===2?t.visibleColumns=t.columns.filter(e=>e.name==="reason_cancellation"&&!e.required).map(e=>e.name):t.visibleColumns=[]}),(n,e)=>(_(),C(O,null,[r("div",K,[r("div",X,[a(j,{class:"w-full md:w-auto",dense:"",outlined:"",debounce:"300",modelValue:t.search,"onUpdate:modelValue":e[0]||(e[0]=l=>t.search=l),placeholder:n.$t("search")},{append:o(()=>[a($,{name:"search"})]),_:1},8,["modelValue","placeholder"]),a(i,{flat:"",class:"button h-full",icon:"add",label:n.$isDesktop&&n.$t("add"),onClick:e[1]||(e[1]=l=>t.dialogCreate=!0)},null,8,["label"])]),n.$isDesktop?(_(),C("div",Y,[a(i,{class:"bg-transparent",flat:"","no-caps":""},{default:o(()=>[x(c(u(f).start)+" - "+c(u(f).end)+" de "+c(t.pagination.rowsNumber),1)]),_:1}),a(i,{class:"bg-transparent",icon:"sym_o_first_page",flat:"",onClick:e[2]||(e[2]=l=>s.value.firstPage())}),a(i,{class:"bg-transparent",icon:"sym_o_navigate_before",flat:"",onClick:e[3]||(e[3]=l=>s.value.prevPage())}),a(i,{class:"bg-transparent",icon:"sym_o_navigate_next",flat:"",onClick:e[4]||(e[4]=l=>s.value.nextPage())}),a(i,{class:"bg-transparent",icon:"sym_o_last_page",flat:"",onClick:e[5]||(e[5]=l=>s.value.lastPage())})])):h("",!0)]),r("div",Z,[t.selected.length?(_(),F(i,{key:0,flat:"",class:"button h-full bg-primary text-white","icon-right":"sym_o_remove",label:n.$isDesktop?"Remover":"","no-caps":"",onClick:u(B)},null,8,["label","onClick"])):h("",!0)]),r("div",null,[a(M,{class:"flex text-xs",size:"sm",modelValue:t.query.where["in:$event_state_id"],"onUpdate:modelValue":e[6]||(e[6]=l=>t.query.where["in:$event_state_id"]=l),"toggle-color":"secondary","toggle-text-color":"text-font",options:S.event_state,type:"checkbox"},null,8,["modelValue","options"])]),r("div",ee,[a(E,{onSetUser:e[7]||(e[7]=l=>t.query.where.user_id=l),onClearUser:e[8]||(e[8]=l=>t.query.where.user_id=null),"model-value":t.user_description,label:"Coordinador",unixroles:24},null,8,["model-value"]),a(G,{class:"w-full",onSetProvider:e[9]||(e[9]=l=>t.query.where["t_event.provider_id"]=l),onClearProvider:e[10]||(e[10]=l=>t.query.where["t_event.provider_id"]=null),"model-value":t.provider_description},null,8,["model-value"])]),a(J,{grid:!n.$isDesktop,"hide-pagination":"",rows:t.rows,columns:t.columns,"row-key":"id",ref_key:"tableRef",ref:s,onRequest:u(P),flat:"",selection:"multiple",pagination:t.pagination,"onUpdate:pagination":e[11]||(e[11]=l=>t.pagination=l),selected:t.selected,"onUpdate:selected":e[12]||(e[12]=l=>t.selected=l),"selected-rows-label":u(V),loading:t.loading,"rows-per-page-label":"Lineas","wrap-cells":!0,visibleColumns:t.visibleColumns},L({"no-data":o(({icon:l,message:R,filter:Q})=>[r("div",te,[r("span",null,c(R),1),a($,{size:"2em",name:Q?"filter_b_and_w":l},null,8,["name"])])]),"body-cell-avatar":o(l=>[a(W,{props:l},{default:o(()=>[a(H,{rounded:"",size:"42px"},{default:o(()=>[r("img",{src:n.$imageInsuredPlaceholder(l.value)},null,8,le)]),_:2},1024)]),_:2},1032,["props"])]),_:2},[n.$isDesktop?void 0:{name:"bottom",fn:o(()=>[a(i,{flat:"",class:"button bg-primary-light w-full","no-caps":"",onClick:u(D)},{default:o(()=>[x("Cargar m\xE1s")]),_:1},8,["onClick"])]),key:"0"}]),1032,["grid","rows","columns","onRequest","pagination","selected","selected-rows-label","loading","visibleColumns"])],64))}};export{ne as default};
